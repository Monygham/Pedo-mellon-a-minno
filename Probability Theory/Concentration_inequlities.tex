\input ../pree.tex

\begin{document}

\title{Concentration inequalities}
\date{}
\maketitle

\section{Introduction}
\noindent
Concentration inequalities estimate deviation of random variable from its mean value or variance. In this short notes we prove Azuma-Heffding inequality. 

\section{Azuma-Hoeffding inequality}

\begin{theorem}[Azuma-Hoeffding inequality]\label{theorem:Azuma'ainequality}
Let $\{X_n\}_{n\in \NN}$ be a sequence of independent random variables on a probability space $\left(\Omega, \cF,P\right)$. Assume that for every $n\in \NN$ there exists real number $c_n$ such that 
$$|X_n|\leq c_n$$
almost surely and that $\mathbb{E}[X_n]=0$ for every $n\in \NN$. Then 
$$P\left(X_0+X_1+...+X_n\geq \lambda\right)\leq \exp\left(\frac{-\lambda^2}{2\cdot \left(c_0^2+c_1^2+...+c^2_n\right)}\right)$$
for every $\lambda \geq 0$.
\end{theorem}

\begin{lemma}\label{lemma:betterJensen}
Let $X$ be a random variable on a probability space $\left(\Omega, \cF, P\right)$. Suppose that $\cG\subseteq \cF$ is a $\sigma$-subalgebra and $c$ is a positive real number. Assume that $\EE[X\,|\,\cG]=0$ and $|X|\leq c$ almost surely. Then for every convex function $\phi:\RR\ra \RR$ we have
$$\EE [\phi(X)\,|\,\cG]\leq \frac{\phi(-c)+\phi(c)}{2}$$
\end{lemma}
\begin{proof}[Proof of the lemma]
Since $\phi$ is convex, we derive that
$$\phi(x) \leq \frac{c-x}{2c}\cdot \phi(-c)+\frac{c+x}{2c}\cdot \phi(c)$$
for every $x\in [-c,c]$. Hence the inequality
$$\phi(X)\leq \frac{c-X}{2c}\cdot \phi(-c)+\frac{c+X}{2c}\cdot \phi(c)$$
holds almost surely. Applying conditional expectation and using the fact that it is a monotone operator, we deduce that 
$$\EE [\phi(X)\,|\,\cG] \leq \frac{c-\EE[X\,|\,\cG]}{2c}\cdot \phi(-c)+\frac{c+\EE[X\,|\,\cG]}{2c}\cdot \phi(c)=\frac{\phi(-c)+\phi(c)}{2}$$
\end{proof}

\begin{lemma}\label{lemma:mainAzuma}
Let $X$ be a random variable on a probability space $\left(\Omega, \cF, P\right)$. Suppose that $\cG\subseteq \cF$ is a $\sigma$-subalgebra and $c$ is a positive real number. Assume that $\EE[X\,|\,\cG]=0$ and $|X|\leq c$ almost surely. Then for every $\theta >0$ we have
$$\EE [e^{\theta X}\,|\,\cG]\leq \exp\left(\frac{\theta^2\cdot c^2}{2}\right)$$
\end{lemma}
\begin{proof}[Proof of the lemma]
Note that 
$$\EE [e^{\theta X}\,|\,\cG]\leq \frac{e^{-\theta \cdot c}+e^{\theta\cdot c}}{2} = \cosh(\theta \cdot c)$$
by Lemma \ref{lemma:betterJensen}. Next observe that
$$\cosh(x)= \frac{e^x + e^{-x}}{2}=\frac{1}{2}\cdot \left(\sum_{n=0}^{+\infty}\frac{x^n}{n!}+\sum_{n=0}^{+\infty}\frac{(-1)^nx^n}{n!}\right)=\sum_{n=0}^{+\infty}\frac{x^{2n}}{(2n)!}\leq \sum_{n=0}^{+\infty}\frac{x^{2n}}{2^n\cdot n!}=\exp\left(\frac{x^2}{2}\right)$$
for every $x\in \RR$. Hence
$$\EE [e^{\theta X}\,|\,\cG] \leq \exp\left(\frac{\theta^2\cdot c^2}{2}\right)$$
\end{proof}

\begin{proof}[Proof of the theorem]
Suppose that $\lambda \geq 0$ and $\theta > 0$. We have
$$P\left(X_0+X_1+...+X_n\geq \lambda\right) = P\left(e^{\theta \cdot \left(X_0+X_1+...+X_n\right)}\geq e^{\theta \cdot \lambda}\right)$$
Applying Markov inequality, we derive that
$$P\left(e^{\theta \cdot \left(X_0+X_1+...+X_n\right)}\geq e^{\theta \cdot \lambda}\right)\leq e^{-\theta\cdot \lambda}\cdot \EE \left[e^{\theta \cdot \left(X_0+X_1+...+X_n\right)}\right] = e^{-\theta\cdot \lambda}\cdot \EE\left[e^{\theta \cdot X_0+\theta \cdot X_1+...+\theta \cdot X_n}\right]$$
Now let $\cF_{n-1}$ be a $\sigma$-algebra generated by random variables $X_0$,...,$X_{n-1}$. According to the standard properties of conditional expectation we have
$$e^{-\theta\cdot \lambda}\cdot \EE\left[e^{\theta \cdot X_0+\theta \cdot X_1+...+\theta \cdot X_n}\right] = e^{-\theta\cdot \lambda}\cdot \EE\left[\EE\left[e^{\theta \cdot X_0+\theta \cdot X_1+...+\theta \cdot X_{n-1}}\cdot e^{\theta \cdot X_n}\,|\,\cF_{n-1}\right]\right]=$$
$$=e^{-\theta\cdot \lambda}\cdot \EE\left[\EE\left[e^{\theta \cdot X_0+\theta \cdot X_1+...+\theta \cdot X_{n-1}}|\,\cF_{n-1}\right] \cdot \EE\left[ e^{\theta \cdot X_n}\,|\,\cF_{n-1}\right]\right]$$
Since $\EE\left[X_n\,|\,\cF_{n-1}\right] = 0$ and $|X_n|\leq c_n$ almost surely, by Lemma \ref{lemma:mainAzuma} we have
$$\EE\left[ e^{\theta \cdot X_n}\,|\,\cF_{n-1}\right] \leq  \exp\left(\frac{\theta^2\cdot c_n^2}{2}\right)$$
and thus we deduce that
$$e^{-\theta\cdot \lambda}\cdot \EE\left[e^{\theta \cdot X_0+\theta \cdot X_1+...+\theta \cdot X_n}\right] = e^{-\theta\cdot \lambda}\cdot \EE\left[\EE\left[e^{\theta \cdot X_0+\theta \cdot X_1+...+\theta \cdot X_{n-1}}|\,\cF_{n-1}\right] \cdot \EE\left[ e^{\theta \cdot X_n}\,|\,\cF_{n-1}\right]\right] \leq$$
$$\leq  e^{-\theta\cdot \lambda}\cdot \EE\left[\EE\left[e^{\theta \cdot X_0+\theta \cdot X_1+...+\theta \cdot X_{n-1}}|\,\cF_{n-1}\right] \cdot \exp\left(\frac{\theta^2\cdot c_n^2}{2}\right)\right]=e^{-\theta\cdot \lambda}\cdot \EE \left[e^{\theta \cdot X_0+\theta \cdot X_1+...+\theta \cdot X_{n-1}}\right] \cdot \exp\left(\frac{\theta^2\cdot c_n^2}{2}\right)$$
for every $n\in \NN$. Hence by easy induction
$$e^{-\theta\cdot \lambda}\cdot \EE\left[e^{\theta \cdot X_0+\theta \cdot X_1+...+\theta \cdot X_n}\right]\leq \exp\left(-\theta \cdot \lambda\right)\cdot \exp\left(\frac{\theta^2\cdot (c_0^2+c_1^2+...+c_n^2)}{2}\right)$$
Therefore, we deduce that inequality
$$P\left(X_0+X_1+...+X_n\geq \lambda\right)\leq \exp\left(\frac{c_0^2+c_1^2+...+c_n^2}{2}\cdot \theta \cdot \left(\theta - \frac{2\cdot \lambda}{c_0^2+c_1^2+...+c_n^2} \right)\right)$$
holds for every $\theta>0$. The right hand side of the inequality is continuous for every $\theta \in [0,+\infty)$ and attains global minimum for 
$$\theta = \frac{\lambda}{c_0^2+c_1^2+...+c_n^2}\in [0,+\infty)$$
Hence finally 
$$P\left(X_0+X_1+...+X_n\geq \lambda\right)\leq  \exp\left(\frac{-\lambda^2}{2\cdot \left(c_0^2+c_1^2+...+c^2_n\right)}\right)$$
\end{proof}

\begin{corollary}\label{corollary:absolutevalueestimation}
Let $\{X_n\}_{n\in \NN}$ be a sequence of independent random variables in probability space $\left(\Omega, \cF,P\right)$. Assume that for every $n\in \NN$ there exists real number $c_n$ such that 
$$|X_n|\leq c_n$$
almost surely. Then 
$$P\left(|X_0+X_1+...+X_n|\geq \lambda\right)\leq 2\cdot \exp\left(\frac{-\lambda^2}{2\cdot \left(c_0^2+c_1^2+...+c^2_n\right)}\right)$$
for every $\lambda \geq 0$.
\end{corollary}
\begin{proof}
Fix $\lambda \geq 0$. According to Theorem \ref{theorem:Azuma'ainequality} we have
$$P\left(X_0+X_1+...+X_n\geq \lambda\right)\leq \exp\left(\frac{-\lambda^2}{2\cdot \left(c_0^2+c_1^2+...+c^2_n\right)}\right)$$
Applying Theorem \ref{theorem:Azuma'ainequality} to a sequence $\{-X_n\}_{n\in \NN}$ we derive
$$P\left(X_0+X_1+...+X_n\leq -\lambda\right)\leq \exp\left(\frac{-\lambda^2}{2\cdot \left(c_0^2+c_1^2+...+c^2_n\right)}\right)$$
Merging these two inequalities we obtain the assertion.
\end{proof}

\begin{corollary}[Hoeffding inequality]\label{corollary:Hoeffdinginequality}
Let $\{X_n\}_{n\geq 1}$ be a sequence of independent and identically distributed random variables in probability space $\left(\Omega, \cF,P\right)$. Assume that there exists a positive real number $c$ such that 
$$|X_1|\leq c$$
almost surely and let $m$ be the expected value of $X_1$. Then 
$$P\left(\bigg|\frac{X_1+...+X_n}{n}-m\bigg|\geq \lambda\right)\leq 2\cdot \exp\left(\frac{-\lambda^2\cdot n}{2\cdot (c+|m|)^2}\right)$$
for every $\lambda \geq 0$.
\end{corollary}
\begin{proof}
Write $Z_n = X_n - \EE [X_n]= X_n -m$. Then $\{Z_n\}_{n\geq 1}$ are independent and $|Z_n|\leq c+|m|$. Fix $\lambda \geq 0$. Then applying Corollary \ref{corollary:absolutevalueestimation} we derive that
$$P\left(\bigg|\frac{X_1+...+X_n}{n}-m\bigg|\geq \lambda\right)= P\left(|Z_1+...+Z_n|\geq n\cdot \lambda\right)\leq 2\cdot \exp\left(\frac{-\lambda^2\cdot n^2}{2\cdot n\cdot (c+|m|)^2}\right)=2\cdot \exp\left(\frac{-\lambda^2\cdot n}{2\cdot (c+|m|)^2}\right)$$
\end{proof}


\end{document}
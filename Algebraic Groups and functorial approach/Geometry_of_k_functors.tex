\input ../pree.tex

\begin{document}

\title{Geometry of $k$-functors}
\date{}
\maketitle

\section{Introduction}
\noindent
In these notes we introduce functorial approach to algebraic geometry. Our aim is to show that functorial and geometrical techniques are interrelated in a very efficient way.\\
Throughout these notes $k$ is a fixed commutative ring and $\Alg_k$ denote the category of commutative $k$-algebras. If $A, B$ are $k$-algebras, then we denote by $\Mor_k(A, B)$ the set of all morphisms $A\ra B$ of $k$-algebras. Similarly if $X, Y$ are $k$-schemes (i.e. schemes together with morphism to $\Spec k$), then we denote by $\Mor_k(X,Y)$ the set of all morphisms $X\ra Y$ of $k$-schemes (morphisms of schemes that preserve structure morphisms to $\Spec k$).

\section{\textit{k}-functors}

\begin{definition}
The category $\Fun(\Alg_k,\Set)$ of copresheaves on $\Alg_k$ is called \textit{the category of $k$-functors}.
\end{definition}
\noindent
If $\fX$ and $\fY$ are $k$-functors, then we denote by $\Mor_k(\fX,\fY)$ the class of morphisms $\fX\ra \fY$ of $k$-functors. If $\sigma:\fX\ra \fY$ is a morphism of $k$-functors, then for every $k$-algebra $A$ we denote by $\sigma^A$ the corresponding component of $\sigma$.\\
Let $\fX$ and $\fY$ be $A$-functors for some $k$-algebra $A$. Then we denote by $\Mor_A\left(\fX,\fY\right)$ the class of morphisms of $A$-functors $\fX\ra \fY$. For every $A$-algebra $B$ and a morphism $\sigma:\fX\ra \fY$ of $A$-functors we denote by $\fX_{B}$, $\fY_{B}$, $\sigma_{B}$ the restrictions $\fX_{\mid \Alg_B}$, $\fY_{\mid \Alg_B}$, $\sigma_{\mid \Alg_B}$ of these entities to the category of $B$-algebras. 

\begin{fact}\label{fact:restrictionsworkasexpected}
Let $\fX$ and $\fY$ be $k$-functors. Assume that $A$ is a $k$-algebra, $B$ is an $A$-algebra, $C$ is an $B$-algebra. Then the composition of maps of classes
\begin{center}
\begin{tikzpicture}
[description/.style={fill=white,inner sep=2pt}]
\matrix (m) [matrix of math nodes, row sep=3em, column sep=3em,text height=1.5ex, text depth=0.25ex] 
{ \Mor_A\left(\fX_A,\fY_A\right) &  \Mor_B\left(\fX_B,\fY_B\right) & \Mor_C\left(\fX_C,\fY_C\right)\\} ;
\path[->,line width=1.0pt,font=\scriptsize]  
(m-1-1) edge node[above] {$\sigma\mapsto \sigma_{B} $} (m-1-2)
(m-1-2) edge node[above] {$\sigma\mapsto \sigma_{C} $} (m-1-3);
\end{tikzpicture}
\end{center}
equals
\begin{center}
\begin{tikzpicture}
v[description/.style={fill=white,inner sep=2pt}]
\matrix (m) [matrix of math nodes, row sep=3em, column sep=3em,text height=1.5ex, text depth=0.25ex] 
{ \Mor_A\left(\fX_A,\fY_A\right) &  \Mor_C\left(\fX_C,\fY_C\right)\\} ;
\path[->,line width=1.0pt,font=\scriptsize]  
(m-1-1) edge node[above] {$\sigma\mapsto \sigma_C $} (m-1-2);
\end{tikzpicture}
\end{center}
\end{fact}
\begin{proof}
Left to the reader.
\end{proof}
\noindent
We denote by $\bd{1}$ a $k$-functor that assigns to every $k$-algebra a set with one element. Then for every $k$-algebra $A$ the restriction $\bd{1}_A$ is a terminal object in the category of $A$-functors.

\begin{fact}\label{fact:points}
Let $\fX$ be a $k$-functor. Suppose $A$ is a $k$-algebra and $x\in \fX(A)$. Then $x$ determines a morphism $\bd{1}_{A}\ra \fX_A$ that for every $A$-algebra $B$ with structural morphism $f:A\ra B$ sends a unique element of $\bd{1}_{A}(B)$ to $\fX(f)(x)\in \fX_A(B)$. This gives rise to a bijection
$$\fX(A)\cong \Mor_{A}\left(\bd{1}_{A},\fX_A\right)$$
\end{fact}
\begin{proof}
Left to the reader as an exercise.
\end{proof}

\begin{definition}
Let $\fX$ be a $k$-functor and $A$ be a $k$-algebra. The set $\fX(A)$ is called \textit{the set of $A$-points of $\fX$}.
\end{definition}
\noindent
The discussion below is partially an application of the main result in {\cite[section 6]{Presheaves}}. For reader's convenience we make our presentation self-contained.

\begin{definition}
Let $\fX, \fY$ be $k$-functors. Let $\fJ$ be a $k$-functor such that $\fJ(A)$ is a subset of a class $\Mor_A\left(\fX_A,\fY_A\right)$ for every $k$-algebra $A$. Assume that for every morphism $f:A\ra B$ of $k$-algebras and every $\sigma\in \fJ(A)$ we have
$$\fJ(f)(\sigma) = \sigma_B$$
where $\sigma_B\in \Mor_B\left(\fX_B,\fY_B\right)$ is the restriction of $\sigma$ along $f$. Then we call $\fJ$ \textit{a $k$-subfunctor of internal hom of $\fX$ and $\fY$}.
\end{definition}
\noindent
Let $\fX$, $\fY$ be $k$-functors. Suppose next that $\fU$ is a $k$-functor and $\sigma:\fU\times \fX\ra \fY$ is a morphism of $k$-functors. We denote by $i_z:\bd{1}_A\ra \fU_A$ the morphism of $A$-functors corresponding to $z$ by means of Fact \ref{fact:points}. Since $\bd{1}_A$ is terminal $A$-functor, a morphism $\sigma_A\cdot \left(i_z\times 1_{\fX_A}\right)$ is isomorphic to a morphism $\sigma_z:\fX_A\ra \fY_A$ of $A$-functors.

\begin{definition}
Let $\fX, \fY,\fU$ be $k$-functors and let $\sigma:\fU\times \fX \ra \fY$ be a morphism of $k$-functors. Suppose that $\fJ$ is a $k$-subfunctor of internal hom of $\fX$ and $\fY$. Assume that $\sigma_z:\fX_A\ra \fY_A$ is contained in $\fJ(A)$ for every $k$-algebra $A$ and $z\in \fU(A)$. Then we call $\sigma$ \textit{a family of $\fJ$-morphisms parametrized by $\fU$}.
\end{definition}
\noindent
We continue the previous discussion. Let $\fJ$ be a $k$-subfunctor of internal hom of $\fX$ and $\fY$. Assume that $\sigma:\fU\times \fX\ra \fY$ is a $\fJ$-family of morphism parametrized by $\fU$. Then $z\mapsto \sigma_z$ gives rise to a morphism $\tau:\fU\ra \fJ$ of $k$-functors. Indeed, for a morphism $f:A\ra B$ of $k$-algebras and $z\in \fU(A)$ we have
$$\sigma_B\cdot \left(i_{\fU(f)(z)}\times 1_{\fX_B}\right) = \left(\sigma_A\cdot \left(i_{z}\times 1_{\fX_A}\right)\right)_B $$
and hence $\sigma_{\fU(f)(z)} = \left(\sigma_z\right)_B$. This gives rise to a map $\Phi$ of classes
$$\bigg\{\mbox{families }\fU\times \fX\ra \fY\mbox{ of }\fJ\mbox{-morphisms parametrized by }\fU\bigg\}\ni \sigma\mapsto \tau\in \Mor_k\left(\fU,\fJ\right)$$
Consider next a morphism $\tau:\fU\ra \fJ$ of $k$-functors and define $\sigma:\fU\times \fX\ra \fY$ by formula $\sigma^A(z,x) = \left(\tau^A(z)\right)^A(x)$ for every $k$-algebra $A$ and points $z\in \fU(A),\,x\in \fX(A)$. Let $f:A\ra B$ be a morphism of $k$-algebras. Then
$$\sigma^B\left(\fU(f)(z),\fX(f)(x)\right) = \left(\tau^B\left(\fU(f)(z)\right)\right)^B\left(\fX(f)(x)\right) = \left(\left(\tau^A(z)\right)_B\right)^B\left(\fX(f)(x)\right) =$$
$$ = \left(\tau^A(z)\right)^B\left(\fX(f)(x)\right) = \fY(f)\left(\left(\tau^A(z)\right)^A(x)\right) = \fY(f)\left(\sigma^A(z,x)\right)$$
Thus $\sigma:\fU\times \fX\ra \fY$ is a morphism of $k$-functors. For every $k$-algebra $A$ and $z\in\fU(A)$ we have $\sigma_z = \tau^A(z)$. Indeed, let $f:A\ra B$ be a morphism of $k$-algebras and $x$ be an element in $\fX(B)$ then we have
$$\left(\sigma_z\right)^B(x) = \sigma^B\left(\fU(f)(z),x\right) = \left(\tau^B\left(\fU(f)(z)\right)\right)^B(x) = \left(\left(\tau^A(z)\right)_B\right)^B(x) = \left(\tau^A(z)\right)^B(x)$$
Hence $\sigma$ is a family of $\fJ$-morphisms parametrized by $\fU$. This gives rise to a map $\Psi$ of classes
$$\Mor_k\left(\fU,\fJ\right) \ni \tau \mapsto \sigma\in \bigg\{\mbox{families }\fU\times \fX\ra \fY\mbox{ of }\fJ\mbox{-morphisms parametrized by }\fU\bigg\}$$
Now we have the following result, which is an instance {\cite[Theorem 6.3]{Presheaves}}. To make presentation self-contained we give a complete proof.  

\begin{theorem}\label{theorem:k_subfunctors_of_hom}
Let $\fX$, $\fY$ be $k$-functors and let $\fJ$ be a $k$-subfunctor of internal hom of $\fX$ and $\fY$. Then maps 
$$\Phi:\bigg\{\mbox{families }\fU\times \fX\ra \fY\mbox{ of }\fJ\mbox{-morphisms parametrized by }\fU\bigg\} \ra  \Mor_{k}\left(\fU,\fJ\right)$$
and
$$\Psi:\Mor_{k}\left(\fU,\fJ\right) \ra \bigg\{\mbox{families }\fU\times \fX\ra \fY\mbox{ of }\fJ\mbox{-morphisms parametrized by }\fU\bigg\}$$
are mutually inverse bijections.
\end{theorem}
\begin{proof}
Pick a morphism $\tau:\fU\ra \fJ$ of $k$-functors. Let $A$ be a $k$-algebra and $z\in \fU(A)$. In the discussion preceding the statement we showed that $\Psi(\tau)_z = \tau^A(z)$. Thus
$$\left(\Phi(\Psi(\tau))\right)^A(z) = \Psi(\tau)_z = \tau^A(z)$$
and hence $\Phi\cdot \Psi$ is the identity.\\
Pick a family of $\fJ$-morphism $\sigma:\fU\times \fX\ra \fY$ parametrized by $\fU$. Let $A$ be a $k$-algebra and $z\in \fU(A)$, $x\in \fX(A)$ be points. Then
$$\left(\Psi\left(\Phi(\sigma)\right)\right)^A(z,x) = \left(\Phi(\sigma)^A(z)\right)^A(x) = \sigma_z^A(x) = \sigma^A(z,x)$$
Thus $\Psi\cdot \Phi$ is the identity map.
\end{proof}
\noindent
Now we formulate direct consequences of Theorem \ref{theorem:k_subfunctors_of_hom}.

\begin{definition}
Let $\fX$ and $\fY$ be $k$-functors and suppose that for every $k$-algebra $A$ the class $\Mor_A\left(\fX_A,\fY_A\right)$ is a set. We define
$$\iMor_k(\fX,\fY)(A)=\Mor_A\left(\fX_A,\fY_A\right)$$
for every $k$-algebra $A$. This is a $k$-functor. Indeed, for every $k$-algebra $A$ and $A$-algebra $B$ we can compose a morphism $\sigma:\fX_A\ra \fY_A$ of $k$-functors with the forgetful functor $\Alg_B \ra \Alg_A$. This induces a map 
$$\iMor_{k}(\fX,\fY)(A)\ni \sigma \mapsto \sigma_{B}\in \iMor_{k}(\fX,\fY)(B)$$
and according to Fact \ref{fact:restrictionsworkasexpected} these maps make $\iMor_{k}(\fX,\fY)$ a $k$-functor. The $k$-functor $\iMor_{\cC}(\fX,\fY)$ is called \textit{a hom $k$-functor of $\fX$ and $\fY$}.
\end{definition}

\begin{corollary}\label{corollary:hom_k_functors}
Let $\fX$, $\fY$ be $k$-functors. Assume that for every $k$-algebra $A$ the class $\Mor_{A}\left(\fX_A,\fY_A\right)$ is a set. Then there is a bijection 
$$\Mor_{k}\left(\fU\times \fX,\fY\right)\ra  \Mor_{k}\left(\fU,\iMor_{k}\left(\fX,\fY\right)\right)$$
of classes.
\end{corollary}

\begin{definition}
Let $\fX,\fY$ be $k$-functors. If $\Iso_{A}\left(\fX_A,\fY_A\right)$ is a set for every $k$-algebra $A$, then we define a $k$-subfunctor $\iIso_k\left(\fX,\fY\right)$ of $\iMor_k\left(\fX,\fY\right)$ by
$$\iIso_k\left(\fX,\fY\right)(A) = \Iso_A\left(\fX_A,\fY_A\right)$$
for every $k$-algebra $A$. We call $\iIso_k\left(\fX,\fY\right)$ \textit{the $k$-functor of isomorphism}.
\end{definition}

\begin{definition}
Let $\fX, \fY,\fU$ be $k$-functors and let $\sigma:\fU\times \fX \ra \fY$ be a morphism of $k$-functors. Assume that $\sigma_z:\fX_A\ra \fY_A$ is an isomorphism of $A$-functors for every $k$-algebra $A$. Then we call $\sigma$ \textit{a family of isomorphisms parametrized by $\fU$}.
\end{definition}

\begin{corollary}\label{corollary:hom_isomorphism_bijection}
Let $\fU,\fX,\fY$ be $k$-functors and suppose that for every $k$-algebra $A$ the class $\Iso_A\left(\fX_A,\fY_A\right)$ is a set. The the following map
$$\bigg\{\mbox{families }\fU\times \fX\ra \fY\mbox{ of isomorphism parametrized by }\fU\bigg\}\ra \Mor_k\left(\fU,\iIso_k\left(\fX,\fY\right)\right)$$
is a bijection of classes.
\end{corollary}


\section{Zariski local $k$-functors and Zariski sheaves}
\noindent
In this part we use the notion of a Grothendieck topology on a category. For this notion we refer the reader to \cite{Sheaves}.

\begin{definition}
Let $\big\{f_i:X_i\ra X\big\}_{i\in I}$ be a family of morphisms of $k$-schemes. We say that $\{f_i\}_{i\in I}$ is \textit{a Zariski covering of $X$} if the following conditions are satisfied.
\begin{enumerate}[label=\textbf{(\arabic*)}, leftmargin=3.0em]
\item For every $i\in I$ morphism $f_i$ is an open immersion of schemes.
\item Morphism $\coprod_{i\in I}X_i\ra X$ induced by $\big\{f_i\big\}_{i\in I}$ is surjective.
\end{enumerate}
\end{definition}
\noindent
The collection of all Zariski coverings on $\Sch_k$ is a Grothendieck pretopology.

\begin{definition}
We call the Grothendieck topology generated by the pretopology consisting of Zariski coverings on $\Sch_k$ \textit{the Zariski topology on $\Sch_k$}. A presheaf on $\Sch_k$ that is a sheaf with respect to Zariski topology on $\Sch_k$ is called \textit{a Zariski sheaf}.
\end{definition}
\noindent
Let $\fX$ be a presheaf on the category of $k$-schemes. Recall that by {\cite[Theorem 3.5]{Sheaves}} $\fX$ is a Zariski sheaf if and only if for every $k$-scheme $X$ and for every Zariski covering $\big\{f_i:X_i\ra X\big\}$ of $X$ the diagram
\begin{center}
\begin{tikzpicture}
[description/.style={fill=white,inner sep=2pt}]
\matrix (m) [matrix of math nodes, row sep=3em, column sep=6em,text height=1.5ex, text depth=0.25ex] 
{\fX(X) &   \prod_{i\in I}\fX(X_i)&  \prod_{(i,j)\in I\times I} \fX(X_i\times_XX_j)  \\} ;
\path[->,line width=0.8pt,font=\scriptsize]
(m-1-1) edge node[above] {$ \langle \fX(f_i) \rangle_{i\in I} $} (m-1-2)
(m-1-2) edge[transform canvas={yshift=0.5ex}] node[above] {$ \langle \fX(f'_{ij}) \cdot pr_i\rangle_{(i,j)}$} (m-1-3)
(m-1-2) edge[transform canvas={yshift=-0.5ex}] node[below] {$ \langle \fX(f''_{ij}) \cdot pr_j\rangle_{(i,j)}$} (m-1-3);
\end{tikzpicture}
\end{center}
is a kernel of a pair of arrows, where for every $(i,j)\in I\times I$ morphisms $f'_{ij}$ and $f''_{ij}$ form a cartesian square
\begin{center}
\begin{tikzpicture}
[description/.style={fill=white,inner sep=2pt}]
\matrix (m) [matrix of math nodes, row sep=3em, column sep=3em,text height=1.5ex, text depth=0.25ex] 
{X_i\times_XX_j   &   X_j   \\
 X_i  & X   \\} ;
\path[->,line width=0.8pt,font=\scriptsize]
(m-1-1) edge node[above] {$ f''_{ij}$} (m-1-2)
(m-2-1) edge node[below] {$ f_i $} (m-2-2)
(m-1-1) edge node[left] {$ f'_{ij} $} (m-2-1)
(m-1-2) edge node[right] {$ f_j  $} (m-2-2);
\end{tikzpicture}
\end{center}
\noindent
Now we repeat this definitions for $k$-algebras and $k$-functors.

\begin{definition}
Let $\big\{f_i:A\ra A_i\big\}_{i\in I}$ be a family of morphisms of $k$-algebras. We say that $\{f_i\}_{i\in I}$ is \textit{a Zariski covering of $A$} if the following conditions are satisfied.
\begin{enumerate}[label=\textbf{(\arabic*)}, leftmargin=3.0em]
\item For every $i\in I$ morphism $\Spec f_i$ is an open immersion of schemes.
\item Morphism $\coprod_{i\in I}\Spec A_i\ra \Spec A$ induced by $\big\{\Spec f_i\big\}_{i\in I}$ is surjective.
\end{enumerate}
\end{definition}
\noindent
The collection of all Zariski coverings on $\Alg_k$ induces on its opposite category $\Aff_k$ of affine $k$-schemes a Grothendieck pretopology.

\begin{definition}
We call the Grothendieck topology generated by the pretopology consisting of Zariski coverings on $\Aff_k$ \textit{the Zariski topology on $\Aff_k$}. A $k$-functor that is a sheaf with respect to Zariski topology on $\Aff_k$ is called \textit{a Zariski local $k$-functor}.
\end{definition}
\noindent
Let $\fX$ be a $k$-functor. Again by {\cite[Theorem 3.5]{Sheaves}} $\fX$ is a Zariski local $k$-functor if and only if for every $k$-algebra $A$ and for every Zariski covering $\big\{f_i:A\ra A_i\big\}$ of $A$ the diagram
\begin{center}
\begin{tikzpicture}
[description/.style={fill=white,inner sep=2pt}]
\matrix (m) [matrix of math nodes, row sep=3em, column sep=6em,text height=1.5ex, text depth=0.25ex] 
{\fX(A) &   \prod_{i\in I}\fX(A_i)&  \prod_{(i,j)\in I\times I} \fX(A_i\otimes_AA_j)  \\} ;
\path[->,line width=0.8pt,font=\scriptsize]
(m-1-1) edge node[above] {$ \langle \fX(f_i) \rangle_{i\in I} $} (m-1-2)
(m-1-2) edge[transform canvas={yshift=0.5ex}] node[above] {$ \langle \fX(f'_{ij}) \cdot pr_i\rangle_{(i,j)}$} (m-1-3)
(m-1-2) edge[transform canvas={yshift=-0.5ex}] node[below] {$ \langle \fX(f''_{ij}) \cdot pr_j\rangle_{(i,j)}$} (m-1-3);
\end{tikzpicture}
\end{center}
is a kernel of a pair of arrows, where for every $(i,j)\in I\times I$ morphisms $f'_{ij}$ and $f''_{ij}$ form a cocartesian square
\begin{center}
\begin{tikzpicture}
[description/.style={fill=white,inner sep=2pt}]
\matrix (m) [matrix of math nodes, row sep=3em, column sep=3em,text height=1.5ex, text depth=0.25ex] 
{A &  A_j   \\
 A_i&  A_i\otimes_AA_j   \\} ;
\path[->,line width=0.8pt,font=\scriptsize]
(m-1-1) edge node[above] {$ f_j $} (m-1-2)
(m-2-1) edge node[below] {$ f'_{ij} $} (m-2-2)
(m-1-1) edge node[left] {$ f_i $} (m-2-1)
(m-1-2) edge node[right] {$ f'_{ji}  $} (m-2-2);
\end{tikzpicture}
\end{center}
\noindent
Now we state the main result of this section.

\begin{theorem}\label{theorem:sheavesonschemesarelocalkfunctors}
Let
\begin{center}
\begin{tikzpicture}
[description/.style={fill=white,inner sep=2pt}]
\matrix (m) [matrix of math nodes, row sep=3em, column sep=3em,text height=1.5ex, text depth=0.25ex] 
{ \widehat{\Sch_k}  & \mbox{\emph{the category of $k$-functors}} \\};
\path[->,line width=1.0pt,font=\scriptsize]  
(m-1-1) edge node[auto] {$ $} (m-1-2);
\end{tikzpicture}
\end{center}
be the restriction of presheaves on $\Sch_k$ to copresheaves on $\Alg_k$ ($k$-functors) induced by the contravariant functor $\Spec:\Alg_k\ra \Sch_k$. Then it induces an equivalence of categories between Zariski sheaves on $\Sch_k$ and Zariski local $k$-functors.
\end{theorem}
\begin{proof}
Note that $\Aff_k$ with Zariski topology is a dense subsite ({\cite[definition 4.4]{Sheaves}}) of $\Sch_k$ with Zariski topology. Hence the result is a special case of a more general theorem {\cite[Theorem 4.6]{Sheaves}}. 
\end{proof}

\begin{proposition}\label{proposition:representablemonomorphismsaresheaves}
Let $\sigma:\fX \ra \fY$ be a monomorphism of $k$-functors and $\fY$ be a Zariski local $k$-functor. Assume that for every $k$-algebra $A$ and every morphism $\tau:\fP_{\Spec A}\ra \fY$ of $k$-functors there exist a Zariski local $k$-functor $\fZ$ that fits into a cartesian square
\begin{center}
\begin{tikzpicture}
[description/.style={fill=white,inner sep=2pt}]
\matrix (m) [matrix of math nodes, row sep=3em, column sep=3em,text height=1.5ex, text depth=0.25ex] 
{  \fZ                       & \fX           \\
   \fP_{\Spec A}             & \fY           \\};
\path[->,line width=1.0pt,font=\scriptsize]
(m-1-1) edge node[above] {$  $} (m-1-2)
(m-2-1) edge node[below] {$ \tau $} (m-2-2)
(m-1-2) edge node[right] {$ \sigma $} (m-2-2)
(m-1-1) edge node[left] {$   $} (m-2-1);
\end{tikzpicture}
\end{center}
Then $\fX$ is a Zariski local $k$-functor.
\end{proposition}
\begin{proof}
Suppose that $A$ is a $k$-algebra and $S$ is a covering sieve on $A$ with respect to Zariski topology. Recall that by {\cite[page 2]{Sheaves}} we may consider $S$ as a subcopresheaf of $\fP_{\Spec A}$. Suppose that $\tau:\fP_{\Spec A}\ra \fY$ and $m:S\ra \fX$ are morphisms of $k$-functors such that $\sigma \cdot m$ is equal to the composition of $S\hookrightarrow \fP_{\Spec A}$ with $\tau$. Next there exists a Zariski local $k$-functor $\fZ$ that fits into a cartesian square
\begin{center}
\begin{tikzpicture}
[description/.style={fill=white,inner sep=2pt}]
\matrix (m) [matrix of math nodes, row sep=3em, column sep=3em,text height=1.5ex, text depth=0.25ex] 
{  \fZ               & \fX           \\
   \fP_{\Spec A}    & \fY           \\} ;
\path[->,line width=1.0pt,font=\scriptsize]
(m-1-1) edge node[above] {$\tau'  $} (m-1-2)
(m-2-1) edge node[below] {$\tau  $} (m-2-2)
(m-1-2) edge node[right] {$ \sigma $} (m-2-2)
(m-1-1) edge node[left] {$ \sigma'  $} (m-2-1);
\end{tikzpicture}
\end{center}
of $k$-functors. By universal property of cartesian squares there exists a unique morphism $n:S\ra \fZ$ of $k$-functors such that the diagram
\begin{center}
\begin{tikzpicture}
[description/.style={fill=white,inner sep=2pt}]
\matrix (m) [matrix of math nodes, row sep=3em, column sep=3em,text height=1.5ex, text depth=0.25ex] 
{ S & {}            &  {}               \\
 {} &  \fZ        & \fX     \\
 {} & \fP_{\Spec A} &  \fY       \\} ;
\path[->,line width=1.0pt,font=\scriptsize]
(m-1-1) edge node [right= 2pt, below= 2pt] {$ n $} (m-2-2)
(m-2-2) edge node [above = 2pt] {$\tau' $} (m-2-3)
(m-2-2) edge node [left= 2pt] {$\sigma' $} (m-3-2)
(m-2-3) edge node [right] {$\sigma $} (m-3-3)
(m-3-2) edge node [below] {$\tau $} (m-3-3);
\path[->, bend left, line width=1.0pt, font=\scriptsize]
(m-1-1) edge node [left= 2pt, above= 2pt] {$m $} (m-2-3);
\path[right hook->, bend right, line width=1.0pt, font=\scriptsize]
(m-1-1) edge node [left= 2pt, below= 2pt] {$ $} (m-3-2);
\end{tikzpicture} 
\end{center}
is commutative. Since $\fZ$ is Zariski local, there exists a morphism $\rho:\fP_{\Spec A}\ra \fZ$ such that $\rho_{\mid S} = n$. Then $\left(\tau'\cdot \rho\right)_{\mid S} = \tau'\cdot n = m$ and hence matching family $m$ admits an amalgamation. Since $\sigma$ is a monomorphism, this suffices to prove that $\fX$ is a Zariski local $k$-functor.
\end{proof}

\section{Schemes and their functors of points}
\noindent
Let $X$ be a $k$-scheme. We define a $k$-functor $\fP_X$ by formula
$$\fP_X(A) = \Mor_k\left(\Spec A,X\right)$$
That is $\fP_X$ is the restriction of the presheaf on $\Sch_k$ represented by $X$ to the category $\Alg_k$ along the functor $\Spec:\Alg_k\ra \Sch_k$. Next if $f:X\ra Y$ is a morphism of $k$-schemes, then $\fP_f$ is the restriction of a morphism of presheaves on $\Sch_k$ represented by $f$ to the category of $k$-algebras along $\Spec:\Alg_k\ra \Sch_k$. Thus we have a functor
\begin{center}
\begin{tikzpicture}
[description/.style={fill=white,inner sep=2pt}]
\matrix (m) [matrix of math nodes, row sep=3em, column sep=3em,text height=1.5ex, text depth=0.25ex] 
{ \Sch_k  & \mbox{the category of $k$-functors} \\};
\path[->,line width=1.0pt,font=\scriptsize]  
(m-1-1) edge node[auto] {$ \fP $} (m-1-2);
\end{tikzpicture}
\end{center}

\begin{fact}\label{fact:functorsofpoints}
Functor
\begin{center}
\begin{tikzpicture}
[description/.style={fill=white,inner sep=2pt}]
\matrix (m) [matrix of math nodes, row sep=3em, column sep=3em,text height=1.5ex, text depth=0.25ex] 
{ \Sch_k  & \mbox{\emph{the category of $k$-functors}} \\};
\path[->,line width=1.0pt,font=\scriptsize]  
(m-1-1) edge node[auto] {$ \fP $} (m-1-2);
\end{tikzpicture}
\end{center}
is full, faithful and its image consists of Zariski local $k$-functors. Moreover, $\fP$ preserves limits.
\end{fact}
\begin{proof}
Note that the presheaf $h_X$ on $\Sch_k$ represented by $X$ is a Zariski sheaf. Indeed, this just rephrases standard fact that morphism of schemes can be glued in Zariski topology. Next according to Theorem \ref{theorem:sheavesonschemesarelocalkfunctors} the functor $\Spec:\Alg_k\ra \Sch_k$ induces an equivalence between the category of Zariski sheaves and the category of local Zariski $k$-functors. Thus $\fP_X$ is a local Zariski $k$-functor and $\fP$ it is full and faithful. Note that Yoneda embedding $h:\Sch_k\ra \widehat{\Sch_k}$ and the functor
\begin{center}
\begin{tikzpicture}
[description/.style={fill=white,inner sep=2pt}]
\matrix (m) [matrix of math nodes, row sep=3em, column sep=7em,text height=1.5ex, text depth=0.25ex] 
{ \widehat{\Sch_k}  & \mbox{the category of $k$-functors} \\};
\path[->,line width=1.0pt,font=\scriptsize]  
(m-1-1) edge node[auto] {$ \textbf{induced by $\Spec$} $} (m-1-2);
\end{tikzpicture}
\end{center}
preserve limits. Thus their composition $\fP$ also preserves limits.
\end{proof}

\begin{definition}
Let $X$ be a $k$-scheme. Then $\fP_X$ is called \textit{the $k$-functor of points of $X$}.
\end{definition}
\noindent
Finally note that for every $k$-algebra $A$ we have an identification $\fP_{\Spec A} = \Hom_k\left(A,-\right)$ and this identification is natural with respect to $A$. In other words $\fP\cdot \Spec$ is the (co)Yoneda embedding of $\Alg_k$ into the category of $k$-functors.\\
Suppose now that $A$ is a $k$-algebra and $\ideal{a}\subseteq A$ is an ideal. Then we define $V(\ideal{a}) = \Spec A/\ideal{a}$ as a closed subscheme $\Spec A$ induced by the quotient morphism $A\ra A/\ideal{a}$. We define an open subscheme $D(\ideal{a}) = \Spec A\setminus V(\ideal{a})$ of $\Spec A$.

\begin{definition}
Let $\sigma:\fX\ra \fY$ be a morphism of $k$-functors. Assume that for every $k$-algebra $A$ and every morphism $\tau:\fP_{\Spec A}\ra \fY$ of $k$-functors there exist an ideal $\ideal{a}$ in $A$ and a morphism $\tau':\fP_{D(\ideal{a})}\ra \fX$ of $k$-functors such that the square
\begin{center}
\begin{tikzpicture}
[description/.style={fill=white,inner sep=2pt}]
\matrix (m) [matrix of math nodes, row sep=3em, column sep=3em,text height=1.5ex, text depth=0.25ex] 
{  \fP_{D(\ideal{a})}        & \fX           \\
   \fP_{\Spec A}             & \fY           \\} ;
\path[->,line width=1.0pt,font=\scriptsize]
(m-1-1) edge node[above] {$ \tau' $} (m-1-2)
(m-2-1) edge node[below] {$ \tau $} (m-2-2)
(m-1-2) edge node[right] {$ \sigma $} (m-2-2);
\path[right hook->,line width=1.0pt,font=\scriptsize]
(m-1-1) edge node[left] {$   $} (m-2-1);
\end{tikzpicture}
\end{center}
is cartesian. Then $\sigma$ is \textit{an open immersion of $k$-functors}.
\end{definition}

\begin{fact}\label{fact:openimmersionsclosedunderbasechangeandcomposition}
The class of open immersions of $k$-functors is closed under base change and composition.
\end{fact}
\begin{proof}
Left to the reader.
\end{proof}

\begin{definition}
Let $\fX$ be a $k$-functor and $\big\{\sigma_i:\fX_i\ra \fX\big\}_{i\in I}$ be a family of open immersions. Then for every $k$-algebra $A$ and $x\in \fX(A)$ we have a family of ideals $\{\ideal{a}_i\}_{i\in I}$ defined by cartesian squares
\begin{center}
\begin{tikzpicture}
[description/.style={fill=white,inner sep=2pt}]
\matrix (m) [matrix of math nodes, row sep=3em, column sep=3em,text height=1.5ex, text depth=0.25ex] 
{\fP_{D(\ideal{a}_i)}   &    \fX_i   \\
 \fP_{\Spec A}          &    \fX  \\} ;
\path[->,line width=1.0pt,font=\scriptsize]  
(m-1-1) edge node[above] {$ \tau'  $} (m-1-2)
(m-2-1) edge node[below] {$ \tau $} (m-2-2)
(m-1-2) edge node[right] {$\sigma_i$} (m-2-2);
\path[right hook->,line width=1.0pt,font=\scriptsize]
(m-1-1) edge node[left] {$ $} (m-2-1);
\end{tikzpicture}
\end{center}
in which bottom vertical morphism $\tau:\fP_{\Spec A}\ra \fX$ corresponds to $x$. We say that $\{\sigma_i\}_{i\in I}$ is \textit{an open cover of $\fX$} if for every $k$-algebra $A$ and $x\in \fX(A)$ we have
$$\Spec A = \bigcup_{i\in I}D(\ideal{a}_i)$$
or in other words $A = \sum_{i\in I}\ideal{a}_i$.
\end{definition}

\begin{theorem}\label{theorem:representabilitybasicresult}
Let $\fX$ be a $k$-functor. Then the following are equivalent.
\begin{enumerate}[label=\emph{\textbf{(\roman*)}}, leftmargin=3.0em]
\item $\fX$ is isomorphic with functor of points of some $k$-scheme.
\item $\fX$ is a Zariski local $k$-functor and there exists an open cover $\big\{\sigma_i:\fP_{X_i}\ra \fX\big\}_{i\in I}$ of $k$-functors for some family $\{X_i\}_{i\in I}$ of $k$-schemes.
\item $\fX$ is a Zariski local $k$-functor and there exists an open cover $\big\{\sigma_i:\fP_{\Spec A_i}\ra \fX\big\}_{i\in I}$ of $k$-functors for some family $\{A_i\}_{i\in I}$ of $k$-algebras.
\end{enumerate}
\end{theorem}
\noindent
The proof depends on two lemmas. Check {\cite[Definition 7.1]{Sheaves}} for the notion of a locally surjective morphism.

\begin{lemma}\label{lemma:openimmersionslocallyondomainarezariskilocalkfunctors}
Let $f:X\ra Y$ be a morphism of $k$-schemes. Suppose that $f$ is surjective morphism and an open immersion locally on $X$. Then $\fP_f$ is a locally surjective morphism of Zariski local $k$-functors. 
\end{lemma}
\begin{proof}[Proof of the lemma]
Let $A$ be a $k$-algebra and $g:\Spec A\ra Y$ be a morphism of $k$-schemes. Since $f$ is surjective and an open immersion locally on $X$, there exist a Zariski cover $\big\{f_i:A\ra A_i\big\}_{i\in I}$ and a family $\big\{g_i:\Spec A_i\ra X\big\}_{i\in I}$ of morphisms of $k$-schemes such that $f\cdot g_i = g\cdot \Spec f_i$ for every $i\in I$. This implies that $\fP_f(g_i) = \fP_Y(f_i)(g)$ for every $i\in I$. Thus $\fP_f$ is a locally surjective morphism of Zariski local $k$-functors.
\end{proof}

\begin{lemma}\label{lemma:recollement}
Let $X = \coprod_{i\in I}X_i, R = \coprod_{i,j\in I}R_{ij}$ be disjoint sums of $k$-schemes and let $p,q:R\ra X$ be morphisms of $k$-schemes such that the following conditions are satisfied.
\begin{enumerate}[label=\emph{\textbf{(\arabic*)}}, leftmargin=3.0em]
\item For any $i,j\in I$ morphism $p_{\mid R_{ij}}$ induces an open immersion $R_{ij}\hookrightarrow X_i$ and morphism $q_{\mid R_{ij}}$ induces an open immersion $R_{ij}\hookrightarrow X_j$.
\item For every $i\in I$ morphisms $p_{\mid R_{ii}}$ and $q_{\mid R_{ii}}$ are equal and induce an isomorphisms $R_{ii}\ra X_i$.  
\item Triple $\left(R,p,q\right)$ is an equivalence relation on $X$ in the category of $k$-schemes.
\end{enumerate}
Then there exist a $k$-scheme $Y$ and a morphism $f:X\ra Y$ of $k$-schemes such that
\begin{center}
\begin{tikzpicture}
[description/.style={fill=white,inner sep=2pt}]
\matrix (m) [matrix of math nodes, row sep=3em, column sep=3em,text height=1.5ex, text depth=0.25ex] 
{\fP_{R} &  \fP_X & \fP_Y  \\} ;
\path[->,line width=0.8pt,font=\scriptsize]
(m-1-1) edge[transform canvas={yshift=0.5ex}] node[above] {$ \fP_{p}  $} (m-1-2)
(m-1-1) edge[transform canvas={yshift=-0.5ex}] node[below] {$ \fP_{q} $} (m-1-2)
(m-1-2) edge node[above] {$ \fP_f  $} (m-1-3);
\end{tikzpicture}
\end{center}
is a cokernel of a pair $(\fP_{p},\fP_{q})$ in the category of Zariski local $k$-functors.
\end{lemma}
\begin{proof}[Proof of the lemma]
Let
\begin{center}
\begin{tikzpicture}
[description/.style={fill=white,inner sep=2pt}]
\matrix (m) [matrix of math nodes, row sep=3em, column sep=3em,text height=1.5ex, text depth=0.25ex] 
{ R &  X & Y  \\} ;
\path[->,line width=0.8pt,font=\scriptsize]
(m-1-1) edge[transform canvas={yshift=0.5ex}] node[above] {$ p  $} (m-1-2)
(m-1-1) edge[transform canvas={yshift=-0.5ex}] node[below] {$ q $} (m-1-2)
(m-1-2) edge node[above] {$ f  $} (m-1-3);
\end{tikzpicture}
\end{center}
be a cokernel in the category of ringed spaces. It exists according to {\cite[Remark 2.3]{LocallyRingedSpaces}}. Moreover, {\cite[Theorem 3.2]{LocallyRingedSpaces}} states that for every $i\in I$ subset $f(X_i)$ is open in $Y$ and we have an isomorphism of ringed spaces $X_i\cong f(X_i)$ induced by $f$. Therefore, $Y$ is a $k$-scheme and $f:X\ra Y$ is a morphism of $k$-schemes.\\
Now we verify that $\fP_f$ is the quotient in the category of Zariski local $k$-functors. For this note that we proved above that $f$ is open immersion of $k$-schemes locally on $X$ and it is surjective. Thus by Lemma \ref{lemma:openimmersionslocallyondomainarezariskilocalkfunctors} we derive that $\fP_f$ is a locally surjective morphism of Zariski local $k$-functors. Therefore ({\cite[Theorem 7.3]{Sheaves}}), it suffices to show that the square
\begin{center}
\begin{tikzpicture}
[description/.style={fill=white,inner sep=2pt}]
\matrix (m) [matrix of math nodes, row sep=3em, column sep=3em,text height=1.5ex, text depth=0.25ex] 
{ \fP_R  &   \fP_X   \\
  \fP_X             &   \fP_Y   \\};
\path[->,line width=1.0pt,font=\scriptsize]  
(m-1-1) edge node[above] {$ \fP_q $} (m-1-2)
(m-2-1) edge node[below] {$ \fP_f $} (m-2-2)
(m-1-1) edge node[left] {$ \fP_p $} (m-2-1)
(m-1-2) edge node[right] {$ \fP_f $} (m-2-2);
\end{tikzpicture}
\end{center}
is cartesian. Since $\fP$ preserves limits (Fact \ref{fact:functorsofpoints}), we derive that it suffices to check that
\begin{center}
\begin{tikzpicture}
[description/.style={fill=white,inner sep=2pt}]
\matrix (m) [matrix of math nodes, row sep=3em, column sep=3em,text height=1.5ex, text depth=0.25ex] 
{ R  &   X   \\
  X  &   Y   \\};
\path[->,line width=1.0pt,font=\scriptsize]  
(m-1-1) edge node[above] {$ q $} (m-1-2)
(m-2-1) edge node[below] {$ f $} (m-2-2)
(m-1-1) edge node[left] {$ p $} (m-2-1)
(m-1-2) edge node[right] {$ f $} (m-2-2);
\end{tikzpicture}
\end{center}
is cartesian square of $k$-schemes. By {\cite[Remark 2.3]{LocallyRingedSpaces}} we have $R_{ij} = X_i\times_YX_j$ for every $i, j\in I$ and hence
$$X\times_YX = \left(\coprod_{i\in I}X_i\right)\times_Y \left(\coprod_{i\in I}X_i\right) = \coprod_{i,j\in I}\left(X_i\times_YX_j\right) = \coprod_{i,j\in I}R_{ij} = R$$
Thus the result follows.
\end{proof}

\begin{proof}[Proof of the theorem]
If \textbf{(i)} holds, then we may assume that $\fX=\fP_Y$ for some $k$-scheme $Y$. Fact \ref{fact:functorsofpoints} states that $\fP_Y$ is a Zariski local $k$-functor and clearly $1_{\fP_Y}:\fP_Y\ra \fP_Y$ is an open cover. Thus $\textbf{(i)}\Rightarrow \textbf{(ii)}$.\\
Every functor of points of a $k$-scheme admits open cover by functors of points of affine $k$-schemes. Indeed, it suffices to take open affine subschemes that cover given $k$-scheme and apply $\fP$. This implies that every open cover of a $k$-functor $\fX$ by functors of points of $k$-schemes admits refinement by open cover of functors of points of affine $k$-schemes. Therefore, implication $\textbf{(ii)}\Rightarrow \textbf{(iii)}$ holds.\\
Suppose that a $k$-functor $\fX$ is Zariski local and $\big\{\sigma_i:\fP_{\Spec A_i}\ra \fX\big\}_{i\in I}$ is an open cover of $\fX$. Note that for every $i,j\in I$ there exist a $k$-scheme $R_{ij}$ and open immersions $p_{ij}:R_{ij}\hookrightarrow \Spec A_i$, $q_{ij}:R_{ij}\hookrightarrow \Spec A_j$ such that the square
\begin{center}
\begin{tikzpicture}
[description/.style={fill=white,inner sep=2pt}]
\matrix (m) [matrix of math nodes, row sep=3em, column sep=3em,text height=1.5ex, text depth=0.25ex] 
{  \fP_{R_{ij}}                &   \fP_{\Spec A_j}   \\
  \fP_{\Spec A_i}  &   \fX   \\};
\path[->,line width=1.0pt,font=\scriptsize]  
(m-1-1) edge node[above] {$\fP_{q_{ij}} $} (m-1-2)
(m-2-1) edge node[below] {$ \sigma_i $} (m-2-2)
(m-1-1) edge node[left] {$ \fP_{p_{ij}} $} (m-2-1)
(m-1-2) edge node[right] {$ \sigma_j $} (m-2-2);
\end{tikzpicture}
\end{center}
is cartesian. Consider $k$-scheme $X = \coprod_{i\in I}\Spec A_i$ and morphism $\sigma:\fP_X\ra \fX$ induced by $\{\sigma_i\}_{i\in I}$. Moreover, consider $k$-scheme $R = \coprod_{i,j\in I}R_{ij}$ and morphisms $p,q:R\ra X$ induced by $\{p_{ij}\}_{i,j\in I}$ and $\{q_{ij}\}_{i,j\in I}$, respectively. Note that the square
\begin{center}
\begin{tikzpicture}
[description/.style={fill=white,inner sep=2pt}]
\matrix (m) [matrix of math nodes, row sep=3em, column sep=3em,text height=1.5ex, text depth=0.25ex] 
{ \fP_R  &   \fP_X   \\
  \fP_X             &   \fX   \\};
\path[->,line width=1.0pt,font=\scriptsize]  
(m-1-1) edge node[above] {$ \fP_q $} (m-1-2)
(m-2-1) edge node[below] {$ \sigma $} (m-2-2)
(m-1-1) edge node[left] {$ \fP_p $} (m-2-1)
(m-1-2) edge node[right] {$ \sigma $} (m-2-2);
\end{tikzpicture}
\end{center}
is cartesian and hence $\left(\fP_R,\fP_p,\fP_q\right)$ is an equivalence relation. By Lemma \ref{lemma:recollement} there exist a $k$-scheme $Y$ and a morphism $f:X\ra Y$ such that
\begin{center}
\begin{tikzpicture}
[description/.style={fill=white,inner sep=2pt}]
\matrix (m) [matrix of math nodes, row sep=3em, column sep=3em,text height=1.5ex, text depth=0.25ex] 
{\fP_{R} &  \fP_X & \fP_Y  \\} ;
\path[->,line width=0.8pt,font=\scriptsize]
(m-1-1) edge[transform canvas={yshift=0.5ex}] node[above] {$ \fP_{p}  $} (m-1-2)
(m-1-1) edge[transform canvas={yshift=-0.5ex}] node[below] {$ \fP_{q} $} (m-1-2)
(m-1-2) edge node[above] {$ \fP_f  $} (m-1-3);
\end{tikzpicture}
\end{center}
is a cokernel of $\left(\fP_p,\fP_q\right)$. Moreover, $\sigma$ is locally surjective morphism of Zariski local $k$-functors and hence also
\begin{center}
\begin{tikzpicture}
[description/.style={fill=white,inner sep=2pt}]
\matrix (m) [matrix of math nodes, row sep=3em, column sep=3em,text height=1.5ex, text depth=0.25ex] 
{\fP_{R} &  \fP_X & \fX  \\} ;
\path[->,line width=0.8pt,font=\scriptsize]
(m-1-1) edge[transform canvas={yshift=0.5ex}] node[above] {$ \fP_{p}  $} (m-1-2)
(m-1-1) edge[transform canvas={yshift=-0.5ex}] node[below] {$ \fP_{q} $} (m-1-2)
(m-1-2) edge node[above] {$ \sigma  $} (m-1-3);
\end{tikzpicture}
\end{center}
is a cokernel of $\left(\fP_p,\fP_q\right)$. Thus $\fP_Y$ is isomorphic with $\fX$. This proves $\textbf{(iii)}\Rightarrow \textbf{(i)}$.
\end{proof}

\section{Representable morphisms of $k$-functors}

\begin{definition}
Let $\sigma:\fX\ra \fY$ be a morphism of $k$-functors. Assume that for every $k$-algebra $A$ and every morphism $\tau:\fP_{\Spec A}\ra \fY$ of $k$-functors there exist a $k$-scheme $X$, a morphism $f:X\ra \Spec A$ and a morphism $\tau':\fP_{X}\ra \fX$ of $k$-functors such that the square
\begin{center}
\begin{tikzpicture}
[description/.style={fill=white,inner sep=2pt}]
\matrix (m) [matrix of math nodes, row sep=3em, column sep=3em,text height=1.5ex, text depth=0.25ex] 
{  \fP_{X}        & \fX           \\
   \fP_{\Spec A}             & \fY           \\} ;
\path[->,line width=1.0pt,font=\scriptsize]
(m-1-1) edge node[above] {$ \tau' $} (m-1-2)
(m-2-1) edge node[below] {$ \tau $} (m-2-2)
(m-1-2) edge node[right] {$ \sigma $} (m-2-2)
(m-1-1) edge node[left] {$ \fP_f  $} (m-2-1);
\end{tikzpicture}
\end{center}
is cartesian. Then $\sigma$ is \textit{a representable morphism of $k$-functors}.
\end{definition}

\begin{fact}\label{fact:representablemorphismsunderbasechangeandcomposition}
The class of representable morphisms of $k$-functors is closed under base change and composition.
\end{fact}
\begin{proof}
Left to the reader.
\end{proof}

\begin{proposition}\label{proposition:representablearerepresentableafterarbitrarybasechange}
Let $\sigma:\fX\ra \fY$ be a representable morphism of Zariski local $k$-functors. Fix a $k$-scheme $Y$ and a morphism $\tau:\fP_Y\ra \fY$. Then there exist a $k$-scheme $X$, a morphism $f:X\ra Y$ and a morphism $\tau':\fP_X\ra \fX$ such that the square
\begin{center}
\begin{tikzpicture}
[description/.style={fill=white,inner sep=2pt}]
\matrix (m) [matrix of math nodes, row sep=3em, column sep=3em,text height=1.5ex, text depth=0.25ex] 
{  \fP_{X}        & \fX           \\
   \fP_{Y}             & \fY           \\} ;
\path[->,line width=1.0pt,font=\scriptsize]
(m-1-1) edge node[above] {$ \tau' $} (m-1-2)
(m-2-1) edge node[below] {$ \tau $} (m-2-2)
(m-1-2) edge node[right] {$ \sigma $} (m-2-2)
(m-1-1) edge node[left] {$ \fP_f  $} (m-2-1);
\end{tikzpicture}
\end{center}
is cartesian.
\end{proposition}
\begin{proof}
Let
\begin{center}
\begin{tikzpicture}
[description/.style={fill=white,inner sep=2pt}]
\matrix (m) [matrix of math nodes, row sep=3em, column sep=3em,text height=1.5ex, text depth=0.25ex] 
{  \fZ        & \fX           \\
   \fP_{Y}    & \fY           \\} ;
\path[->,line width=1.0pt,font=\scriptsize]
(m-1-1) edge node[above] {$ \tau' $} (m-1-2)
(m-2-1) edge node[below] {$ \tau $} (m-2-2)
(m-1-2) edge node[right] {$ \sigma $} (m-2-2)
(m-1-1) edge node[left] {$ \sigma'  $} (m-2-1);
\end{tikzpicture}
\end{center}
be a cartesian square. According to {\cite[Theorem 2.12]{Sheaves}} $k$-functor $\fZ$ is Zariski local. Suppose that $\big\{f_i:\Spec A_i\ra Y\big\}_{i\in I}$ is an open cover of $Y$. Then $\big\{\fP_{f_i}:\fP_{\Spec A_i}\ra \fP_Y\big\}_{i\in I}$ is an open cover of $\fP_Y$ and hence its base change $\big\{\tau_i:\fZ_i\ra \fZ\big\}_{i\in I}$ is an open cover of $\fZ$. Since $\sigma$ is representable, we deduce that $\fZ_i$ is a functor of points of some $k$-scheme for $i\in I$. Now by Theorem \ref{theorem:representabilitybasicresult} we derive that there exists a $k$-scheme $X$ such that $\fZ$ is isomorphic with $\fP_X$. This proves the result.
\end{proof}

\begin{definition}
Let $\sigma:\fX\ra \fY$ be a morphism of $k$-functors. Assume that for every $k$-algebra $A$ and every morphism $\tau:\fP_{\Spec_A}\ra \fY$ of $k$-functors there exist an ideal $\ideal{a}$ in $A$ and morphism $\tau':\fP_{V(\ideal{a})}\ra \fX$ such that the square
\begin{center}
\begin{tikzpicture}
[description/.style={fill=white,inner sep=2pt}]
\matrix (m) [matrix of math nodes, row sep=3em, column sep=3em,text height=1.5ex, text depth=0.25ex]
{  \fP_{V(\ideal{a})} = \fP_{\Spec A/\ideal{a}}  & \fX      \\
   \fP_{\Spec A}  & \fY           \\};
\path[->,line width=1.0pt,font=\scriptsize]
(m-1-1) edge node[above] {$\tau' $} (m-1-2)
(m-2-1) edge node[below] {$ \tau $} (m-2-2)
(m-1-1) edge node[left] {$ \fP_{\Spec q} $} (m-2-1)
(m-1-2) edge node[right] {$ \sigma $} (m-2-2);
\end{tikzpicture}
\end{center}
is cartesian, where $q:A\ra A/\ideal{a}$ is the quotient map. Then $\sigma$ is \textit{a closed immersion of $k$-functors}.
\end{definition}

\begin{fact}\label{fact:closedimmersionsclosedunderbasechangeandcomposition}
The class of closed immersions of $k$-functors is closed under base change and composition.
\end{fact}
\begin{proof}
Left to the reader.
\end{proof}

\begin{proposition}\label{proposition:openclosedimmersions}
Let $\sigma:\fX\ra \fY$ be a closed (open) immersion of $k$-functors. Fix a $k$-scheme $Y$ and a morphism $\tau:\fP_Y\ra \fY$. Then there exist a $k$-scheme $X$, a closed (open) immersion $f:X\ra Y$ of schemes and a morphism $\tau':\fP_X\ra \fX$ of $k$-functors such that the square
\begin{center}
\begin{tikzpicture}
[description/.style={fill=white,inner sep=2pt}]
\matrix (m) [matrix of math nodes, row sep=3em, column sep=3em,text height=1.5ex, text depth=0.25ex] 
{  \fP_{X}        & \fX           \\
   \fP_{Y}             & \fY           \\} ;
\path[->,line width=1.0pt,font=\scriptsize]
(m-1-1) edge node[above] {$ \tau' $} (m-1-2)
(m-2-1) edge node[below] {$ \tau $} (m-2-2)
(m-1-2) edge node[right] {$ \sigma $} (m-2-2)
(m-1-1) edge node[left] {$ \fP_f  $} (m-2-1);
\end{tikzpicture}
\end{center}
is cartesian.
\end{proposition}
\begin{proof}
According to Fact \ref{fact:closedimmersionsclosedunderbasechangeandcomposition} (Fact \ref{fact:openimmersionsclosedunderbasechangeandcomposition}) pullback $\fX\times_{\fY}\fP_Y\ra \fP_Y$ of $\sigma$ along $\tau$ is a closed (open) immersion of $k$-functors. Since $\fP_Y$ is a Zariski local $k$-functor by Fact \ref{fact:functorsofpoints} and closed (open) immersions are monomorphisms, we derive by Proposition \ref{proposition:representablemonomorphismsaresheaves} that a fiber-product $\fX\times_{\fY}\fP_Y$ of $\sigma$ and $\tau$ is a Zariski local $k$-functor. Since closed (open) immersions of $k$-functors are representable, we deduce by Proposition \ref{proposition:representablearerepresentableafterarbitrarybasechange} that there exists a $k$-scheme $X$, a morphism $f:X\ra Y$ of $k$-schemes and a morphism $\tau':\fP_X\ra \fX$ of $k$-functors such that the square
\begin{center}
\begin{tikzpicture}
[description/.style={fill=white,inner sep=2pt}]
\matrix (m) [matrix of math nodes, row sep=3em, column sep=3em,text height=1.5ex, text depth=0.25ex] 
{  \fX\times_{\fY}\fP_Y\cong \fP_{X}        & \fX           \\
   \fP_{Y}        & \fY           \\} ;
\path[->,line width=1.0pt,font=\scriptsize]
(m-1-1) edge node[above] {$ \tau' $} (m-1-2)
(m-2-1) edge node[below] {$ \tau $} (m-2-2)
(m-1-2) edge node[right] {$ \sigma $} (m-2-2)
(m-1-1) edge node[left] {$ \fP_f  $} (m-2-1);
\end{tikzpicture}
\end{center}
is cartesian and $\fP_f$ is a closed (open) immersion of $k$-functors. Since the functor
\begin{center}
\begin{tikzpicture}
[description/.style={fill=white,inner sep=2pt}]
\matrix (m) [matrix of math nodes, row sep=3em, column sep=3em,text height=1.5ex, text depth=0.25ex] 
{ \widehat{\Sch_k}  & \mbox{the category of $k$-functors} \\};
\path[->,line width=1.0pt,font=\scriptsize]  
(m-1-1) edge node[auto] {$\fP $} (m-1-2);
\end{tikzpicture}
\end{center}
preserves finite limits, it follows that for every open affine subset $V$ of $Y$ we have a cartesian square
\begin{center}
\begin{tikzpicture}
[description/.style={fill=white,inner sep=2pt}]
\matrix (m) [matrix of math nodes, row sep=3em, column sep=3em,text height=1.5ex, text depth=0.25ex] 
{  \fP_{f^{-1}(V)}        & \fP_X           \\
   \fP_{V}                & \fP_Y           \\} ;
\path[right hook->,line width=1.0pt,font=\scriptsize]
(m-1-1) edge node[above] {$  $} (m-1-2)
(m-2-1) edge node[below] {$  $} (m-2-2);
\path[->,line width=1.0pt,font=\scriptsize]
(m-1-2) edge node[right] {$ \fP_f $} (m-2-2)
(m-1-1) edge node[left] {$ \fP_{f_V}  $} (m-2-1);
\end{tikzpicture}
\end{center}
where $f_V:f^{-1}(V)\ra V$ is the restriction of $f$. Next as $\fP_f$ is a closed (open) immersion and $V$ is affine, we derive that $f_V$ is a closed (open) immersion of schemes. Since this holds for every affine open subset $V$ of $Y$, we deduce that $f$ is a closed (open) immersion.
\end{proof}
\noindent
The next result is frequently used in the theory of \textit{algebraic spaces}.

\begin{proposition}\label{proposition:diagonalrepresentabilityofmorphisms}
Let $\fY$ be a $k$-functor such that the diagonal $\fY\ra \fY\times \fY$ is representable. Then every morphism $\sigma:\fX\ra \fY$ of $k$-functors is representable.
\end{proposition}
\begin{proof}
Fix a morphism of $k$-functors $\sigma:\fX\ra \fY$. Let $Y$ be a $k$-scheme and let $\tau:\fP_Y\ra \fY$ be a morphism of $k$-functors. Consider the cartesian square
\begin{center}
\begin{tikzpicture}
[description/.style={fill=white,inner sep=2pt}]
\matrix (m) [matrix of math nodes, row sep=3em, column sep=3em,text height=1.5ex, text depth=0.25ex] 
{  \fZ        & \fX           \\
   \fP_{Y}    & \fY           \\} ;
\path[->,line width=1.0pt,font=\scriptsize]
(m-1-1) edge node[above] {$ \tau' $} (m-1-2)
(m-2-1) edge node[below] {$ \tau $} (m-2-2)
(m-1-2) edge node[right] {$ \sigma $} (m-2-2)
(m-1-1) edge node[left] {$ \sigma'  $} (m-2-1);
\end{tikzpicture}
\end{center}
Then there exists a cartesian square
\begin{center}
\begin{tikzpicture}
[description/.style={fill=white,inner sep=2pt}]
\matrix (m) [matrix of math nodes, row sep=3em, column sep=3em,text height=1.5ex, text depth=0.25ex] 
{  \fZ                  & \fY           \\
   \fP_{Y}\times \fY    & \fY\times \fY           \\} ;
\path[->,line width=1.0pt,font=\scriptsize]
(m-1-1) edge node[above] {$  $} (m-1-2)
(m-2-1) edge node[below] {$ \tau\times \sigma $} (m-2-2)
(m-1-2) edge node[right] {$ \textbf{diagonal} $} (m-2-2)
(m-1-1) edge node[left] {$   $} (m-2-1);
\end{tikzpicture}
\end{center}
Since the diagonal of $\fY$ is representable, we derive that $\fZ$ is isomorphic with functor of points of some $k$-scheme. This finishes the proof.
\end{proof}

\section{Closed immersions and hom $k$-functors}

\begin{definition}
Let $X$ be a $k$-scheme. Suppose that there exists an open affine cover $X = \bigcup_{i\in I}X_i$ such that $k$-algebra $\Gamma(X_i,\cO_{X_i})$ is free as a $k$-module. Then we say that $X$ is \textit{a locally free $k$-scheme}.
\end{definition}
\noindent
Next theorem is the main result of this section.

\begin{theorem}\label{theorem:closedimmersionsandinternalhom}
Let $j:\fY'\ra \fY$ be a closed immersion of $k$-functors and $X$ be a locally free $k$-scheme. Suppose that classes $\Mor_A\left((\fP_X)_A,\fY_A\right)$ are sets for every $k$-algebra $A$. Then classes $\Mor_A\left((\fP_X)_A,\fY'_A\right)$ are sets for every $k$-algebra $A$ and the morphism
$$\iMor_k\left(1_{\fP_X},j\right):\iMor_k\left(\fP_X,\fY'\right)\ra \iMor_k\left(\fP_X,\fY\right)$$
is a closed immersion of $k$-functors.
\end{theorem}
\noindent
It is useful to isolate crucial steps in the argument. For this we proceed by proving some lemmas.

\begin{lemma}\label{lemma:foraffinelocalfactorization}
Suppose that $A$ is a commutative ring. Let $j:\fY'\ra \fY$ be a closed immersion of $A$-functors and $X$ be an affine $A$-scheme such that $\Gamma(X,\cO_X)$ is a free $A$-module. Assume that $\tau:\fP_X\ra \fY$ is a morphism of $A$-functors. Then there exists an ideal $\ideal{a}\subseteq A$ such that for every $A$-algebra $B$ the restriction $\tau_B$ factors through $j_B$ if and only if the structure morphism $f:A\ra B$ of $B$ satisfies $\ideal{a}\subseteq \ker(f)$.
\end{lemma}
\begin{proof}[Proof of the lemma]
Since $j$ is a closed immersion of $A$-functors and $X$ is affine $k$-scheme there exists an affine $A$-scheme $X'$, a closed immersion $j':X'\ra X$ of schemes and a cartesian square
\begin{center}
\begin{tikzpicture}
[description/.style={fill=white,inner sep=2pt}]
\matrix (m) [matrix of math nodes, row sep=3em, column sep=3em,text height=1.5ex, text depth=0.25ex] 
{  \fP_{X'} & \fY' \\
   \fP_X  & \fY           \\} ;
\path[->,line width=1.0pt,font=\scriptsize]  
(m-1-1) edge node[above] {$ $} (m-1-2)
(m-2-1) edge node[below] {$\tau  $} (m-2-2)
(m-1-1) edge node[left] {$ \fP_{j'} $} (m-2-1)
(m-1-2) edge node[right] {$j $} (m-2-2);
\end{tikzpicture}
\end{center}
of $A$-functors. Next let $B$ be an $A$-algebra with the structure morphism $f:A\ra B$. Then $\tau_B$ factors through $j_B$ if and only if the projection $\Spec B\times_{\Spec A}X\ra X$ induced by $f$ factors through $X'$. Let $A[X]$ be the $A$-algebra of global regular functions on $X$ and let $\ideal{J}$ be an ideal in $A[X]$ such that $A[X]/\ideal{J} = A[X']$ is the $A$-algebra of global regular functions of $X'$. With this notation we derive that the projection $\Spec B\times_{\Spec A}X\ra X$ induced by $f$ factors through $X'$ if and only if the morphism $A[X]\ra B\otimes_AA[X]$ induced by $f$ sends every element of $\ideal{J}$ to zero. Since $A[X]$ is a free $A$-module, we write $A[X] = A^{\oplus I}$ for some index set $I$. Then the morphism $A[X]\ra B\otimes_AA[X]$ induced by $f$ is just $f^{\oplus I}:A^{\oplus I}\ra B^{\oplus I}$. We have $f^{\oplus I}\left(\ideal{J}\right)=0$ if and only if $\left(pr^B_i\cdot f^{\oplus I}\right)\left(\ideal{J}\right)=$ for every $i\in I$, where $pr^B_i:B^{\oplus I}\ra B$ is the projection on $i$-th component. Pick $i\in I$ and consider the commutative diagram
\begin{center}
\begin{tikzpicture}
[description/.style={fill=white,inner sep=2pt}]
\matrix (m) [matrix of math nodes, row sep=3em, column sep=3em,text height=1.5ex, text depth=0.25ex] 
{  A^{\oplus I} & B^{\oplus I}  \\
   A  & B           \\} ;
\path[->,line width=1.0pt,font=\scriptsize]  
(m-1-1) edge node[above] {$ f^{\oplus I} $} (m-1-2)
(m-2-1) edge node[below] {$ f  $} (m-2-2)
(m-1-1) edge node[left] {$ pr^A_i $} (m-2-1)
(m-1-2) edge node[right] {$ pr^B_i $} (m-2-2);
\end{tikzpicture}
\end{center}
In the diagram $pr^A_i$ is the projection on $i$-th component. Diagram implies that $\left(pr^B_i\cdot f^{\oplus I}\right)\left(\ideal{J}\right)=$ for every $i\in I$ if and only if $\left(f\cdot pr_i^A\right)(\ideal{J}) = 0$ for every $i\in I$. This is equivalent with the condition that $f(\ideal{a})=0$ for ideal $\ideal{a}$ in $A$ generated by $\sum_{i\in I}pr_i^A(\ideal{J})$. Thus the lemma is proved.
\end{proof}

\begin{lemma}\label{lemma:coveringsandfactorizations}
Suppose that $A$ is a commutative ring. Let $j:\fY'\ra \fY$ be a closed immersion of $A$-functors and $X$ be an $A$-scheme with open cover
$$X=\bigcup_{i\in I}X_i$$
Assume that $\tau:\fP_X\ra \fY$ is a morphism of $A$-functors. Fix an $A$-algebra $B$. Then $\tau_B$ factors through $j_B$ if and only if $\left(\tau_{\mid \fP_{X_i}}\right)_B$ factors through $j_B$ for every $i\in I$.
\end{lemma}
\begin{proof}[Proof of the lemma]
If $\tau_B$ factors through $j_B$, then also $\left(\tau_{\mid \fP_{X_i}}\right)_B$ factors through $j_B$ for every $i\in I$. It suffices to prove the converse. So suppose that $\left(\tau_{\mid \fP_{X_i}}\right)_B$ factors through $j_B$ for every $i\in I$. Since $j$ is a closed immersion of $A$-functors and $X$ is an $A$-scheme, Proposition \ref{proposition:openclosedimmersions} implies that there exists a cartesian square
\begin{center}
\begin{tikzpicture}
[description/.style={fill=white,inner sep=2pt}]
\matrix (m) [matrix of math nodes, row sep=3em, column sep=3em,text height=1.5ex, text depth=0.25ex] 
{  \fP_{X'} & \fY' \\
   \fP_{X}  & \fY           \\} ;
\path[->,line width=1.0pt,font=\scriptsize]  
(m-1-1) edge node[above] {$ $} (m-1-2)
(m-2-1) edge node[below] {$\tau  $} (m-2-2)
(m-1-1) edge node[left] {$ \fP_{j'} $} (m-2-1)
(m-1-2) edge node[right] {$ j $} (m-2-2);
\end{tikzpicture}
\end{center}
where $j':X'\ra X$ is a closed immersion of $A$-schemes. For each $i\in I$ let $j'_i:j'^{-1}(X_i)\ra X_i$ be the restriction of $j'$. We have the induced cartesian square
\begin{center}
\begin{tikzpicture}
[description/.style={fill=white,inner sep=2pt}]
\matrix (m) [matrix of math nodes, row sep=3em, column sep=3em,text height=1.5ex, text depth=0.25ex] 
{  \fP{j'^{-1}(X_i)} & \fY' \\
   \fP_{X_i}  & \fY           \\} ;
\path[->,line width=1.0pt,font=\scriptsize]  
(m-1-1) edge node[above] {$ $} (m-1-2)
(m-2-1) edge node[below] {$\tau_{\mid \fP_{X_i}}  $} (m-2-2)
(m-1-1) edge node[left] {$ \fP_{j'_i}  $} (m-2-1)
(m-1-2) edge node[right] {$ j $} (m-2-2);
\end{tikzpicture}
\end{center}
Now $\left(\tau_{\mid \fP_{X_i}}\right)_B$ factors through $j_B$. This implies that $(\fP_{j'_i})_B$ admits a section for every $i\in I$. Then $(\fP_{j'_i})_B$ is an isomorphism for every $i\in I$. Thus $j'_i\times_{\Spec A}1_{\Spec B}$ is an isomorphism for every $i\in I$ and hence $j'\times_{\Spec A}1_{\Spec B}$ is an isomorphism of $B$-schemes. This means that $\tau_B$ factors through $j_B$.
\end{proof}

\begin{proof}[Proof of the theorem]
Let $A$ be a $k$-algebra. The restriction functor $(-)_{\mid \Alg_A} = (-)_A$ preserves all closed immersions. Thus $j_A$ is a closed immersion of $A$-functors and hence we derive that $j_A:\fY'_A\ra \fY_A$ is a monomorphism of $A$-functors. Thus we have an injective  map of classes
$$\Mor_A\left(1_{(\fP_X)_A},j_A\right):\Mor_A\left((\fP_X)_A,\fY'_A\right)\hookrightarrow \Mor_A\left((\fP_X)_A,\fY_A\right)$$
Hence if $\Mor_A\left((\fP_X)_A,\fY_A\right)$ is a set, then $\Mor_A\left((\fP_X)_A,\fY'_A\right)$ is a set. All these facts imply that both internal homs
$$\iMor_k\left(\fP_X,\fY'\right),\,\iMor_k\left(\fP_X,\fY\right)$$
exist and morphism $\iMor_k(1_{\fP_X},j)$ of $k$-functors is a monomorphism. Our task is to prove that it is a closed immersion. For this consider a $k$-algebra $A$ and a morphism $\sigma:\fP_{\Spec A}\ra \iMor_k\left(\fP_X,\fY\right)$ of $k$-functors that sends $1_A$ to some morphism $\tau:(\fP_X)_A\ra \fY_A$ of $A$-functors. Consider a cartesian square
\begin{center}
\begin{tikzpicture}
[description/.style={fill=white,inner sep=2pt}]
\matrix (m) [matrix of math nodes, row sep=3em, column sep=3em,text height=1.5ex, text depth=0.25ex] 
{  \fU  & \iMor_k\left(\fP_X,\fY'\right) \\
   \fP_{\Spec A}  & \iMor_k\left(\fP_X,\fY\right)           \\} ;
\path[->,line width=1.0pt,font=\scriptsize]  
(m-1-1) edge node[above] {$ $} (m-1-2)
(m-2-1) edge node[below] {$ \sigma $} (m-2-2)
(m-1-1) edge node[left] {$  $} (m-2-1)
(m-1-2) edge node[right] {$ \iMor_k\left(1_{\fP_X},j\right) $} (m-2-2);
\end{tikzpicture}
\end{center}
Since $\iMor_k\left(1_{\fP_X},j\right)$ is a monomorphism, we may consider $\fU$ as a $k$-subfunctor of $\fP_{\Spec A}$. For every $k$-algebra $B$ subset $\fU(B)\subseteq \Mor_k(A,B)= \Mor_k\left(\Spec B,\Spec A\right)$ consists of $A$-algebras $B$ with structure morphisms $f:A\ra B$ such that $\tau_B$ factors through $j_B:\fY'_B\ra \fY_B$. Since $X$ is a locally free $k$-scheme, we deduce that $(\fP_{X})_A$ is a functor of points of a locally free $A$-scheme
$$\Spec A\times_{\Spec k}X$$
Pick an open affine cover $\bigcup_{i\in I}X_i$ of this $A$-scheme such that $\Gamma(X_i,\cO_X)$ is a free $A$-module. Now Lemma \ref{lemma:coveringsandfactorizations} implies that $\tau_B$ factors through $j_B$ if and only if $\left(\tau_{\mid X_i}\right)_B$ factors through $j_B$ for every $i\in I$. Next by Lemma \ref{lemma:foraffinelocalfactorization} we deduce that $\left(\tau_{\mid X_i}\right)_B$  factors through $j_B$ for given $i\in I$ if and only if $f(\ideal{a}_i)=0$ for some ideal $\ideal{a}_i\subseteq A$ independent of $f$. Thus $\fU$ consists of all morphisms $f:A\ra B$ of $k$-algebras such that $f(\ideal{a})=0$ where $\ideal{a} = \sum_{i\in I}\ideal{a}_i$. Therefore, $\fU\hookrightarrow \fP_{\Spec A}$ is isomorphic with $\fP_{V(\ideal{a})} = \fP_{\Spec A/\ideal{a}}\hookrightarrow \fP_{\Spec A}$ induced by the quotient map $A\ra A/\ideal{a}$ and hence $\iMor_k(1_{\fP_X},j)$ is a closed immersion of $k$-functors.
\end{proof}











\small
\bibliographystyle{alpha}
\bibliography{../zzz}


\end{document}
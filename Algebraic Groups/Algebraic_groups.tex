\input ../pree.tex

\begin{document}

\title{Algebraic groups}
\date{}
\maketitle

\section{Introduction}
\noindent
In these notes we group schemes over fields. For background we refer to \cite{kfunctors} and \cite{Monoid_k_functors}. Let $k$ be a field.

\section{Functions on products of quasi-compact and semi-separated schemes}

\begin{definition}
Let $Y$ be a scheme and let $X$ be a $Y$-scheme. If the diagonal $X\ra X\times_Y X$ is affine, then we say that $X$ is \textit{semi-separated} over $Y$.
\end{definition}

\begin{remark}\label{remark:separated_is_semi-separated}
Let $Y$ be a scheme. Every separated $Y$-scheme is semi-separated.
\end{remark}

\begin{example}[Semi-separated scheme that is not separated]
Let $o$ be the origin of the affine line $\mathbb{A}^1_k$. Consider the following pushout diagram in the category of $k$-schemes.
\begin{center}
\begin{tikzpicture}
[description/.style={fill=white,inner sep=2pt}]
\matrix (m) [matrix of math nodes, row sep=3em, column sep=3em,text height=1.5ex, text depth=0.25ex] 
{   \mathbb{A}^1_k\setminus \{o\} & \mathbb{A}^1_k \\
    \mathbb{A}^1_k                & X              \\} ;
\path[right hook->,line width=1.0pt,font=\scriptsize]
(m-1-1) edge node[above] {$ $} (m-1-2)
(m-1-1) edge node[left] {$ $} (m-2-1);
\path[->,line width=1.0pt,font=\scriptsize]
(m-2-1) edge node[below] {$ $} (m-2-2)
(m-1-2) edge node[right] {$ $} (m-2-2);
\end{tikzpicture}
\end{center}
Then $X$ is an affine line with double origin. The diagonal $X\ra X\times_k X$ is affine but not a closed immersion. Hence $X$ is semi-separated but not separated.
\end{example}

\begin{theorem}\label{theorem:sections_of_qc_sheaves_on_products}
Let $X,Y$ be quasi-compact and semi-separated $k$-schemes. Denote by $\pi_X$ and $\pi_Y$ projections from $X\times_kY$ to $X$ and $Y$, respectively. Let $\cF$ and $\cG$ be quasi-coherent sheaves on $X$ and $Y$, respectively. Then the canonical morphism
$$\Gamma(X,\cF)\otimes_k\Gamma(Y,\cG)\ni s\otimes t \mapsto \pi_X^*s \otimes \pi_Y^{*}t \in \Gamma\left(X\times_kY,\pi_X^*\cF\otimes_{\cO_{X\times_kY}}\pi^*_Y\cG\right)$$
is an isomorphism.
\end{theorem}
\noindent
The theorem follows from the following result.

\begin{lemma}\label{lemma:sections_and_open_covers_of_a_factor}
Let $X,Y$ be $k$-schemes and let $\{V_i\}_{i=1}^n$ be a finite open cover of $Y$. Suppose that the canonical morphism
$$\Gamma(X,\cF)\otimes_k\Gamma\left(V_i\cap V_j,\cG \right) \ra \Gamma\left( X \times_k \left(V_i\cap V_j\right),\pi_X^*\cF\otimes_{\cO_{X\times_kY}}\pi^*_Y\cG\right)$$
is an isomorphism for any two (not necessarily distinct) $i,j\in \{1,...,n\}$. Then the canonical morphism
$$\Gamma(X,\cF)\otimes_k\Gamma(Y,\cG)\ra \Gamma\left(X\times_kY,\pi_X^*\cF\otimes_{\cO_{X\times_kY}}\pi^*_Y\cG\right)$$
is an isomorphism.
\end{lemma}
\begin{proof}[Proof of the lemma]
For each $i\in \{1,...,n\}$ we have the restriction
$$r_i:\Gamma\left(X \times_kY, \pi^*_X\cF\otimes_{\cO_{X \times_kY}} \pi^*_Y\cG \right) \ra \Gamma\left(X\times_kV_i, \pi^*_X\cF\otimes_{\cO_{X \times_kY}} \pi^*_Y\cG \right)$$
and we denote by $p_i$ the restriction $\Gamma\left( Y,\cG \right) \ra \Gamma\left(V_i,\cG \right)$ tensored with $\Gamma(X,\cO_X)$ over $k$. For $i, j \in \{1,...,n\}$ we have the restriction
$$r_{i,j}:\Gamma\left(X \times_kV_i,\pi^*_X\cF\otimes_{\cO_{X \times_kY}} \pi^*_Y\cG\right)\ra \Gamma\left(X\times_k\left(V_i\cap V_j\right),\pi^*_X\cF\otimes_{\cO_{X \times_kY}} \pi^*_Y\cG\right)$$
and we denote by $p_{i,j}$ the restriction $\Gamma\left(V_i,\cG\right)\ra \Gamma\left(V_i\cap V_j ,\cG\right)$ tensored with $\Gamma(X,\cF)$ over $k$. Consider the commutative diagram
\vspace{1cm}
\begin{center}
\begin{tikzpicture}
[description/.style={fill=white,inner sep=2pt},transform canvas={scale=0.7}]
\matrix (m) [matrix of math nodes, row sep=3em, column sep=4em,text height=1.5ex, text depth=0.25ex] 
{ \Gamma\left(X\times_k Y,\pi^*_X\cF\otimes_{\cO_{X \times_kY}} \pi^*_Y\cG \right) & \Oplus_{i=1}^n\Gamma\left(X\times_k V_i,\pi^*_X\cF\otimes_{\cO_{X \times_kY}} \pi^*_Y\cG\right)   &  \Oplus_{1\leq i < j\leq n}\Gamma\left(X\times_k \left(V_i\cap V_j\right),\pi^*_X\cF\otimes_{\cO_{X \times_kY}} \pi^*_Y\cG\right) \\
 \Gamma\left(X,\cF\right)\otimes_k\Gamma\left(Y,\cG\right) &  \Oplus_{i=1}^n\Gamma\left(X,\cF\right) \otimes_k \Gamma\left(V_i,\cG\right)   & \Oplus_{1\leq i <j \leq n} \Gamma\left(X,\cF\right)\otimes_k \Gamma\left(V_i\cap V_j,\cG\right)  \\} ;
\path[->,line width=0.8pt,font=\scriptsize]
(m-1-1) edge node[above] {$\langle r_i\rangle_{i=1}^n  $} (m-1-2)
(m-1-2) edge[transform canvas={yshift=0.6ex}] node[above]  {$\langle r_{i,j}\cdot \mathrm{pr}_i\rangle_{1\leq i<j\leq n}  $} (m-1-3)
(m-1-2) edge[transform canvas={yshift=-0.6ex}] node[below] {$\langle r_{j,i}\cdot \mathrm{pr}_j\rangle_{1\leq i<j\leq n}  $} (m-1-3)
(m-2-1) edge node[above] {$\langle p_i \rangle_{i=1}^n  $} (m-2-2)
(m-2-2) edge[transform canvas={yshift=0.6ex}] node[above] {$ \langle p_{i,j}\cdot \mathrm{pr}_i\rangle_{1\leq i<j\leq n}  $} (m-2-3)
(m-2-2) edge[transform canvas={yshift=-0.6ex}] node[below] {$\langle p_{j,i}\cdot \mathrm{pr}_j\rangle_{1\leq i<j\leq n}  $} (m-2-3)
(m-2-1) edge node[left] {$   $} (m-1-1)
(m-2-2) edge node[left] {$ \simeq $} (m-1-2)
(m-2-3) edge node[right] {$ \simeq $} (m-1-3);
\end{tikzpicture}
\end{center}
\vspace{1cm}
in which vertical arrows are canonically defined. Moreover, by assumptions right and middle vertical arrows are isomorphisms. Note also that both rows are kernel diagrams. Indeed, for the top row this follows from the sheaf property of $\pi^*_X\cF\otimes_{\cO_{X \times_kY}} \pi^*_Y\cG$ and for the bottom row this follows from the fact that $\Gamma(X,\cF)$ is flat over $k$ ($k$ is a field) together with the sheaf property of $\cG$. These imply that the left vertical arrow is an isomorphism and this completes the proof.
\end{proof}

\begin{proof}[Proof of the theorem]
The statement holds, if $X,Y$ are affine. Note that semi-separatedness of a scheme over a field (commutative ring) is equivalent to the fact that intersection of every pair of its open affine subschemes is affine. Now Lemma \ref{lemma:sections_and_open_covers_of_a_factor} implies that the result holds if $X$ is affine and $Y$ is quasi-compact and semi-separated over $k$. Next by symmetry in Lemma \ref{lemma:sections_and_open_covers_of_a_factor}, we derive that the result holds if $X,Y$ are quasi-compact and semi-separated over $k$.
\end{proof}

\begin{corollary}\label{corollary:regular_functions_on_products_of_semi_separated_and_qc_schemes}
Let $X,Y$ be quasi-compact and semi-separated $k$-schemes. Denote by $\pi_X$ and $\pi_Y$ projections from $X\times_kY$ to $X$ and $Y$, respectively. Then the canonical morphism
$$\Gamma(X,\cO_X)\otimes_k\Gamma(Y,\cO_Y)\ni f\otimes_k g\mapsto \pi_X^{\#}(f)\cdot \pi_Y^{\#}(g)\in \Gamma\left(X\times_kY,\cO_{X\times_kY}\right)$$
is an isomorphism.
\end{corollary}

\begin{corollary}\label{corollary:functorial_reformulation_of_regular_functions_on_products_of_semi_separated_and_qc_schemes}
Let $\Sch_k^{\mathrm{qc,ss}}$ be the category of quasi-compact and semi-separated schemes over $k$. Then the contravariant functor
$$\Sch_k^{\mathrm{qc},\mathrm{ss}}\ni X \mapsto \Gamma(X,\cO_X)\in \left(\Alg_k\right)^{\mathrm{op}}$$
preserves products.
\end{corollary}
\begin{proof}
This is a reformulation of Corollary \ref{corollary:regular_functions_on_products_of_semi_separated_and_qc_schemes}.
\end{proof}

\section{General properties of groups schemes over a field}
\noindent
In this section we prove some elementary properties of group schemes over a field.

\begin{proposition}\label{proposition:group_schemes_over_a_field_are_separated}
Let $\bd{G}$ be a group scheme over $k$. Then $\bd{G}$ is a separated $k$-scheme.
\end{proposition}
\begin{proof}
Consider a morphism $f:\bd{G}\times_k\bd{G}\ra \bd{G}$ given on $A$-points $g_1,g_2$ of $\bd{G}$ by formula
$$(g_1,g_2) \mapsto  g_1\cdot g_2^{-1}$$
where $A$ is a $k$-algebra. Note that we have a cartesian square
\begin{center}
\begin{tikzpicture}
[description/.style={fill=white,inner sep=2pt}]
\matrix (m) [matrix of math nodes, row sep=3em, column sep=3em,text height=1.5ex, text depth=0.25ex] 
{   \bd{G}                & \Spec k \\
    \bd{G}\times_k\bd{G}  & \bd{G}  \\} ;
\path[->,line width=1.0pt,font=\scriptsize]
(m-1-1) edge node[above] {$ $} (m-1-2)
(m-2-1) edge node[below] {$f $} (m-2-2)
(m-1-1) edge node[left] {$\delta_{\bd{G}} $} (m-2-1)
(m-1-2) edge node[right] {$e  $} (m-2-2);
\end{tikzpicture}
\end{center}
where $\delta_{\bd{G}}$ is the diagonal of $\bd{G}$, the top horizontal arrow $\bd{G}\ra \Spec k$ is the structure morphism and $e:\Spec k\ra \bd{G}$ is the identity of $\bd{G}$. Since base change of a closed immersion is a closed immersion, we derive that $\delta_{\bd{G}}$ is a closed immersion if $e$ is a closed immersion. Since $\bd{G}$ is a $k$-scheme and $k$ is a field, it follows that every morphism $\Spec k\ra \bd{G}$ of $k$-schemes is a closed immersion (every $k$-point in a scheme over $k$ is closed). In particular, $e$ is a closed immersion and hence $\bd{G}$ is separated.
\end{proof}

\begin{remark}\label{remark:action_of_group_k_functor_is_isomorphic_with_projection}
Let $\fG$ be a group $k$-functor and let $\alpha:\fG \times \fX \ra \fX$ be an action of $\fG$ on $\fX$. Consider an isomorphism $\phi:\fG\times \fX\ra \fG\times \fX$ of $k$-functors given by
$$\fG(A)\times \fX(A)\ni (g,x)\mapsto (g,g^{-1}x)\in \fG(A)\times \fX(A)$$
for every $k$-algebra $A$. Then the triangle
\begin{center}
\begin{tikzpicture}
[description/.style={fill=white,inner sep=2pt}]
\matrix (m) [matrix of math nodes, row sep=3em, column sep=2em,text height=1.5ex, text depth=0.25ex] 
{ \fG\times \fX  &     & \fG\times \fX   \\
                 &\fX  &  \\} ;
\path[->,line width=1.0pt,font=\scriptsize]
(m-1-1) edge node[above] {$ \phi $} (m-1-3)
(m-1-1) edge node[left = 3pt] {$ \pi_{\fX}  $} (m-2-2)
(m-1-3) edge node[right = 3pt] {$ a $} (m-2-2);
\end{tikzpicture}
\end{center}
is commutative.
\end{remark}

\begin{corollary}\label{corollary:action_of_group_k_functor_is_isomorphic_with_projection}
Let $\bd{G}$ be a group scheme over $k$ and let $a:\bd{G}\times_k X\ra X$ be an action of $\bd{G}$ on a $k$-scheme $X$. Then $a$ is isomorphic with the projection $\pi_X:\bd{G}\times_k X\ra X$.
\end{corollary}
\begin{proof}
This is a consequence of Remark \ref{remark:action_of_group_k_functor_is_isomorphic_with_projection}.
\end{proof}

\begin{corollary}\label{corollary:action_of_group_k_scheme_is_flat}
Let $\bd{G}$ be a group scheme over $k$ and let $a:\bd{G}\times_k X\ra X$ be an action of $\bd{G}$ on $k$-scheme $X$. Then $a$ is faithfully flat.
\end{corollary}
\begin{proof}
This is a direct consequence of Corollary \ref{corollary:action_of_group_k_functor_is_isomorphic_with_projection} and the fact that each group scheme $\bd{G}$ over a field $k$ is faithfully flat.
\end{proof}

\section{Algebraic groups and their actions}
\noindent
There is some ambiguity in literature concerning the notion of algebraic group. Some discussion related to this topic can be found in {\cite[Notes on page 12]{milne2017algebraic}}. In this work we decided to define this notion as in \cite{milne2017algebraic} and \cite{demazure1970groupes}.

\begin{definition}
Let $\bd{G}$ be a group scheme over $k$. If $\bd{G}$ is locally of finite type over $k$, then we say that $\bd{G}$ is \textit{a locally algebraic group over $k$}. We say that $\bd{G}$ is \textit{an algebraic group over $k$} if it is of finite type over $k$.
\end{definition}

\begin{corollary}\label{corollary:action_of_locally_algebraic_group_k_scheme_is_universally_open}
Let $\bd{G}$ be a locally algebraic group over $k$ and let $a:\bd{G}\times_k X\ra X$ be an action of $\bd{G}$ on $k$-scheme $X$. Then $a$ is universally open.
\end{corollary}
\begin{proof}
By Corollary \ref{corollary:action_of_group_k_functor_is_isomorphic_with_projection} the action $a$ is isomorphic with the projection $\pi_X:\bd{G}\times_kX\ra X$. Since $\bd{G}$ is locally algebraic group over $k$ the projection $\pi_X$ is locally of finite type and flat. Thus by {\cite[Theorem 14.33]{gortz2010algebraic}} $\pi_X$ is universally open. Hence also $a$ is universally open.
\end{proof}

\begin{remark}\label{remark:projections_over_field_are_universally_open}
According to {\cite[Corollary 5.45]{gortz2010algebraic}} the projection $\pi_X:Y\times_kX\ra X$ is universally open regardless of finiteness assumptions on $Y$.
\end{remark}

\begin{corollary}\label{corollary:for_actions_of_locally_algebraic_groups_there_is_the_smallest_open_stable_subscheme_containing_given_open_subscheme}
Let $\bd{G}$ be a locally algebraic group over $k$ and let $a:\bd{G}\times_k X\ra X$ be an action of $\bd{G}$ on $k$-scheme $X$. If $U$ is an open subscheme of $X$, then $a\left(\bd{G}\times_kU\right)$ is the smallest open $\bd{G}$-stable subscheme of $X$ containing $U$.
\end{corollary}
\begin{proof}
First note that by Corollary \ref{corollary:action_of_locally_algebraic_group_k_scheme_is_universally_open} $a(\bd{G}\times_kU)$ is indeed an open subscheme of $X$. Denote it by $\bd{G}\cdot U$. Observe that
$$a\left(\bd{G}\times_k \bd{G}\cdot U\right) = a\bigg(\big(1_{\bd{G}}\times_ka\big)\big(\bd{G}\times_k\bd{G}\times_kU\big)\bigg)=$$
$$= a\bigg(\big(\mu \times_k 1_X\big)\big(\bd{G}\times_k\bd{G}\times_kU\big)\bigg) = a\big(\bd{G}\times_kU\big) = \bd{G}\cdot U$$
This implies that $a_{\mid \bd{G}\times_k \bd{G}\cdot U}$ factors through $\bd{G}\cdot U$ and hence this open subscheme is $\bd{G}$-stable. It remains to prove that $\bd{G}\cdot U$ is contained in every open $\bd{G}$-stable subscheme $W$ of $X$ which contains $U$. Note that for such $W$ we have
$$\bd{G}\cdot U = a(\bd{G}\times_kU) \subseteq a(\bd{G}\times_kW) \subseteq W$$
Thus the proof is complete.
\end{proof}

\begin{definition}
Let $\bd{G}$ be a locally algebraic group over $k$ and let $a:\bd{G}\times_k X\ra X$ be an action of $\bd{G}$ on $k$-scheme $X$. Fix an open subset $U$ of $X$. Then we denote by $\bd{G}\cdot U$ the smallest open $\bd{G}$-stable subscheme of $X$. We call it \textit{the $\bd{G}$-stable hull of $U$}.
\end{definition}

\begin{definition}
A morphism of schemes $f:X\ra Y$ is \textit{an fpqc-morphism} if $f$ is faithfully flat and for every open affine subscheme $V$ of $Y$ there exists a quasi-compact open subscheme $U$ of $X$ such that $f(U) = V$.
\end{definition}
\noindent
The notion of fpqc-morphism is introduced in {\cite[Definition 2.34]{fantechi2005fundamental}}. Its importance lies in the fact that most interesting classes of morphisms of schemes descend along fpqc-morphism ({\cite[Proposition 2.36]{fantechi2005fundamental}}).

\begin{corollary}\label{corollary:restriction_of_actions_of_algebraic_groups_are_fpqc}
Let $\bd{G}$ be a locally algebraic group over $k$ and let $a:\bd{G}\times_k X\ra X$ be an action of $\bd{G}$ on $k$-scheme $X$. If $U$ is an open subscheme of $X$, then the restriction $\bd{G}\times_k U \ra \bd{G}\cdot U$ of $a$ is an fpqc-morphism.
\end{corollary}
\begin{proof}
Corollaries \ref{corollary:action_of_group_k_scheme_is_flat} and \ref{remark:projections_over_field_are_universally_open} show that $\bd{G}\times_k U \ra \bd{G}\cdot U$ is faithfully flat and open. Hence according to {\cite[\textit(iii) of Proposition 2.35]{fantechi2005fundamental}} the morphism in question is fpqc.
\end{proof}

\section{Orbits and stablizers}

\begin{definition}
Let $\bd{G}$ be a group scheme over $k$ and let $a:\bd{G}\times_k X\ra X$ be an action of $\bd{G}$ on $k$-scheme $X$. Consider a $Y$-point $f:Y\ra X$ for a $k$-scheme $Y$. Then the morphism
\begin{center}
\begin{tikzpicture}
[description/.style={fill=white,inner sep=2pt}]
\matrix (m) [matrix of math nodes, row sep=3em, column sep=7em,text height=1.5ex, text depth=0.25ex] 
{ \bd{G}\times_kY &  X\times_kY                         \\} ;
\path[->,line width=1.0pt,font=\scriptsize]  
(m-1-1) edge node[auto] {$\langle a\cdot \left(1_{\bd{G}}\times_k f \right), \mathrm{pr}_2\rangle  $} (m-1-2);
\end{tikzpicture}
\end{center}
is called \textit{the orbit morphism of $f$}.
\end{definition}
\noindent
One can also introduce stablizers for scheme-theoretic points.

\begin{definition}
Let $\bd{G}$ be a group scheme over $k$ and let $a:\bd{G}\times_k X\ra X$ be an action of $\bd{G}$ on $k$-scheme $X$. Consider a $Y$-point $f:Y\ra X$ for a $k$-scheme $Y$. Fix a cartesian square
\begin{center}
\begin{tikzpicture}
[description/.style={fill=white,inner sep=2pt}]
\matrix (m) [matrix of math nodes, row sep=3em, column sep=2.5em,text height=1.5ex, text depth=0.25ex] 
{ \bd{G}_f &   Y                           \\
  \bd{G}\times_kY  &  X\times_kY                 \\} ;
\path[->,line width=1.0pt,font=\scriptsize]  
(m-1-1) edge node[auto] {$  $} (m-1-2)
(m-2-1) edge node[below] {$ o_f $} (m-2-2);
\path[right hook->,line width=1.0pt,font=\scriptsize]  
(m-1-2) edge node[auto] {$ \langle f, 1_Y\rangle  $} (m-2-2)
(m-1-1) edge node[left] {$  $} (m-2-1);
\end{tikzpicture}
\end{center}
where $o_f$ is the orbit morphism for $f$. Then $\bd{G}_f$ is a subgroup $Y$-scheme of $\bd{G}\times_kY$. It is called \textit{the stablizer of $f$}.
\end{definition}
\noindent
Now we prove useful result which concerns upper semicontinuity of dimension of stablizers.

\begin{theorem}\label{theorem:semicontinuity_of_stablizers_dimension}
Let $\bd{G}$ be a locally algebraic group over $k$ and let $a:\bd{G}\times_k X\ra X$ be an action of $\bd{G}$ on a locally noetherian $k$-scheme $X$. For every point $x$ in $X$ consider the stabilizer $\bd{G}_x$ of the canonical morphism $\Spec k(x)\ra X$ and let $e_x$ be its identity element. Then
$$X_n = \big\{x\in X\,\big|\,\mathrm{dim}_{e_x}(\bd{G}_x) < n\}$$
is an open subscheme of $X$ for every $n\in \NN$.
\end{theorem}
\begin{proof}
Consider the stabilizer $\bd{G}_X$ of $1_X:X\ra X$. Let $\pi_X:\bd{G}_X\ra X$ be the structural morphism. Clearly it is the composition of the morphism of group schemes $\bd{G}_X\hookrightarrow \bd{G}\times_kX$ over $X$ with the projection $\mathrm{pr}_X:\bd{G}\times_kX\ra X$ on the first factor. Note that $\bd{G}_X\hookrightarrow \bd{G}\times_kX$ is a base change of the diagonal $X\hookrightarrow X\times_kX$. Hence $\bd{G}_X\hookrightarrow \bd{G}\times_kX$ is locally of finite type. Since $\mathrm{pr}_X$ is locally of finite type ($\bd{G}$ is locally algebraic group over $k$), we derive that $\pi_X$ is locally of finite type. Note that for every $k$-scheme $Y$ and a $Y$-point $f:Y\ra X$ we have a cartesian square
\begin{center}
\begin{tikzpicture}
[description/.style={fill=white,inner sep=2pt}]
\matrix (m) [matrix of math nodes, row sep=3em, column sep=2.5em,text height=1.5ex, text depth=0.25ex] 
{ \bd{G}_f &   \bd{G}_X                           \\
    Y  &  X                 \\} ;
\path[->,line width=1.0pt,font=\scriptsize]  
(m-1-1) edge node[auto] {$  $} (m-1-2)
(m-2-1) edge node[below] {$ f $} (m-2-2)
(m-1-2) edge node[auto] {$ \pi_X  $} (m-2-2)
(m-1-1) edge node[left] {$ \pi_f $} (m-2-1);
\end{tikzpicture}
\end{center}
where $\pi_f$ is the structural morphism. In particular, we have an identification $\pi_X^{-1}(x) = \bd{G}_x$ of schemes over $k(x)$. Thus we can apply the result on upper semicontinuity of dimensions of fibers {\cite[Theorem 14.110]{gortz2010algebraic}} and we derive that the function
$$\bd{G}_X\ni g\mapsto \mathrm{dim}_g\left(\bd{G}_{\pi_X(g)}\right)\in \NN$$
is upper semicontinuous. Consider now the section $e_X:X\ra \bd{G}_X$ of $\pi_X$ which gives the identity element of the group scheme $\bd{G}_X$ over $X$. Clearly $e_X(x) = e_x$ is the identity element of $\bd{G}_x$ for every $x$ in $X$ and $e_X$ is a locally closed immersion. Thus the function
$$X\ni x\mapsto \mathrm{dim}_{e_x}\left(\bd{G}_{x}\right)\in \NN$$
is the restriction of the upper semicontinuous function
$$\bd{G}_X\ni g\mapsto \mathrm{dim}_g\left(\bd{G}_{\pi_X(g)}\right)\in \NN$$
to a subspace $e_X:X\ra \bd{G}_X$. Since the restriction to a subspace of an upper semicontinuous function is upper semicontinuous, this completes the proof.
\end{proof}

\section{$\bd{G}$-equivariant morphisms}

\begin{theorem}\label{theorem:base_locus_of_certain_classes_of_morphisms_are_stable_under_locally_algebraic_group_action}
Let $\bd{G}$ be a locally algebraic group over $k$, let $X,Y$ be $k$-schemes with $\bd{G}$-actions and let $f:X\ra Y$ be a $\bd{G}$-equivariant morphism. Suppose that $\bd{P}$ is a property of morphisms of $k$-schemes such that the following conditions hold.
\begin{enumerate}[label=\emph{\textbf{(\arabic*)}}, leftmargin=3.0em]
\item $\bd{P}$ is local on the base.
\item $\bd{P}$ is closed under base change.
\item $\bd{P}$ descends along fpqc base change.
\end{enumerate}
Then there exists the largest open subset of $Y$ such that the restriction $f^{-1}(V)\ra V$ of $f$ is in $\bd{P}$ and it is $\bd{G}$-stable.
\end{theorem}
\begin{proof}
Note that the existence of $V$ follows from \textbf{(1)}. We denote by $\tilde{f}$ the restriction of $f$ to $f^{-1}(V)\ra V$. We also denote by $\hat{f}:\bd{G}\cdot f^{-1}(V)\ra \bd{G}\cdot V$ the restriction of $f$.  Since the square
\begin{center}
\begin{tikzpicture}
[description/.style={fill=white,inner sep=2pt}]
\matrix (m) [matrix of math nodes, row sep=3em, column sep=4em,text height=1.5ex, text depth=0.25ex] 
{   \bd{G}\times_k f^{-1}(V) & X \\
    \bd{G}\times_k V         & Y  \\} ;
\path[->,line width=1.0pt,font=\scriptsize]
(m-1-1) edge node[above] {$ \mathrm{action\,of\,}\bd{G} $} (m-1-2)
(m-2-1) edge node[below] {$ \mathrm{action\,of\,}\bd{G} $} (m-2-2)
(m-1-1) edge node[left] {$1_{\bd{G}}\times_k\tilde{f}  $} (m-2-1)
(m-1-2) edge node[right] {$ f $} (m-2-2);
\end{tikzpicture}
\end{center}
is cartesian (this can be checked on $k$-functors of points), we derive by Corollary \ref{corollary:for_actions_of_locally_algebraic_groups_there_is_the_smallest_open_stable_subscheme_containing_given_open_subscheme} that the square
\begin{center}
\begin{tikzpicture}
[description/.style={fill=white,inner sep=2pt}]
\matrix (m) [matrix of math nodes, row sep=3em, column sep=4em,text height=1.5ex, text depth=0.25ex] 
{   \bd{G}\times_k f^{-1}(V) & \bd{G}\cdot f^{-1}(V) \\
    \bd{G}\times_k V         & \bd{G}\cdot V  \\} ;
\path[->,line width=1.0pt,font=\scriptsize]
(m-1-1) edge node[above] {$ \mathrm{action\,of\,}\bd{G} $} (m-1-2)
(m-2-1) edge node[below] {$ \mathrm{action\,of\,}\bd{G} $} (m-2-2)
(m-1-1) edge node[left] {$1_{\bd{G}}\times_k\tilde{f}  $} (m-2-1)
(m-1-2) edge node[right] {$ \hat{f} $} (m-2-2);
\end{tikzpicture}
\end{center}
is cartesian. The assumption \textbf{(2)} implies that $1_{\bd{G}}\times_k\tilde{f}$ is in $\bd{P}$. Since the bottom horizontal morphism is fpqc by Corollary \ref{corollary:restriction_of_actions_of_algebraic_groups_are_fpqc}, we deduce by \textbf{(3)} that $\hat{f}$ is in $\bd{P}$. Since $V$ is the largest open subset of $Y$ such that the restriction $f^{-1}(V)\ra V$ of $f$ is in $\bd{P}$ and
$$f^{-1}\left(\bd{G}\cdot V\right) = \bd{G}\cdot f^{-1}(V)$$
we derive that $\bd{G}\cdot V \subseteq V$. Hence $V = \bd{G}\cdot V$, which means that $V$ is $\bd{G}$-stable.
\end{proof}
\noindent
Now we discuss scheme-theoretic images of $\bd{G}$-equivariant morphisms.

\begin{theorem}\label{theorem:scheme_theoretic_images_of_equivariant_morphisms}
Let $\bd{G}$ be a group scheme over $k$ and let $f:X\ra Y$ be a $\bd{G}$-equivariant morphism of $k$-schemes equipped with $\bd{G}$-actions. Suppose that $f$ is quasi-compact. Let $i:Z\hookrightarrow Y$ be the scheme-theoretic image of $f$ and let $g:X\ra Z$ be the unique morphism of schemes such that $f = i\cdot g$. Then the following assertions hold.
\begin{enumerate}[label=\emph{\textbf{(\arabic*)}}, leftmargin=3.0em]
\item There exists a unique action of $\bd{G}$ on $Z$ such that $i$ is $\bd{G}$-equivariant.
\item $g$ is $\bd{G}$-equivariant with respect to this unique action of $\bd{G}$. 
\item If $\bd{G},X,Y$ schemes locally of finite type over $k$, then the image of $g$ is a dense, open $\bd{G}$-stable subscheme of $Z$.
\end{enumerate}
\end{theorem}
\begin{proof}
Since $f$ is quasi-compact, we deduce that $i:Z \hookrightarrow Y$ is a closed immersion determined by the kernel of $f^{\#}:\cO_{Y}\ra f_*\cO_{X}$ ({\cite[Proposition 10.30]{gortz2010algebraic}}) and $g^{\#}:\cO_{Z}\ra g_*\cO_{X}$ is an injective morphism of sheaves. Moreover, the fact that $f$ is quasi-compact implies that $g$ is quasi-compact. Fix an open affine subscheme $V$ of $Z$ and an open affine subscheme $W$ of $\bd{G}$. Then we have a commutative square
\begin{center}
\begin{tikzpicture}
[description/.style={fill=white,inner sep=2pt}]
\matrix (m) [matrix of math nodes, row sep=3em, column sep=4em,text height=1.5ex, text depth=0.25ex] 
{ \cO_{\bd{G}\times_kZ}\left(W\times_k V\right)  & \cO_{\bd{G}\times_k X}\left(W\times_k g^{-1}(V)\right) \\
\cO_{\bd{G}}(W)\otimes_k \cO_{Z}(V) & \cO_{\bd{G}}\left(W\right)\otimes_k \cO_{X}\left(g^{-1}(V)\right)  \\} ;
\path[->,line width=1.0pt,font=\scriptsize]
(m-1-1) edge node[above] {$ \left(1_{\bd{G}}\times_k g\right)^{\#}_{W\times_k V} $} (m-1-2)
(m-2-1) edge node[below] {$ \left(1_{\bd{G}}^{\#}\right)_W\otimes_k g^{\#}_V $} (m-2-2)
(m-2-1) edge node[left]  {$ \simeq $} (m-1-1)
(m-2-2) edge node[right] {$ \simeq $} (m-1-2);
\end{tikzpicture}
\end{center}
where vertical morphisms are canonical and are isomorphism by Corollary \ref{corollary:regular_functions_on_products_of_semi_separated_and_qc_schemes}. This implies that $\left(1_{\bd{G}}\times_kg\right)^{\#}$ is an injective morphism of sheaves. Consider a commutative diagram
\begin{center}
\begin{tikzpicture}
[description/.style={fill=white,inner sep=2pt}]
\matrix (m) [matrix of math nodes, row sep=3em, column sep=4em,text height=1.5ex, text depth=0.25ex] 
{   \bd{G}\times_k X & \bd{G}\times_k Z & \bd{G}\times_kY \\
X                & Z                & Y\\} ;
\path[->,line width=1.0pt,font=\scriptsize]
(m-1-1) edge node[above] {$1_{\bd{G}}\times_k g  $} (m-1-2)
(m-2-1) edge node[below] {$g  $} (m-2-2)
(m-1-1) edge node[left] {$ a_X $} (m-2-1)
(m-1-3) edge node[right] {$ a_Y $} (m-2-3);
\path[right hook->,line width=1.0pt,font=\scriptsize]
(m-1-2) edge node[above] {$ 1_{\bd{G}}\times_k i $} (m-1-3)
(m-2-2) edge node[below] {$ i  $} (m-2-3);
\end{tikzpicture}
\end{center}
where $a_X$ and $a_Y$ are actions of $\bd{G}$ on $X$ and $Y$, respectively. From the commutativity of the diagram, we derive that
$$\left(\left(1_{\bd{G}}\times_ki\right)_*\left(a_Y\right)_*\left(1_{\bd{G}}\times_kg\right)^{\#}\right)\cdot \left(\left(a_Y\right)_*\left(1_{\bd{G}}\times_ki\right)^{\#} \right)\cdot a_Y^{\#} = \left(i_*g_*a_X^{\#}\right)\cdot \left(i_*g^{\#} \right) \cdot i^{\#}$$
Since $\left(1_{\bd{G}}\times_ki\right)_*\left(a_Y\right)_*\left(1_{\bd{G}}\times_kg\right)^{\#}$ is injective, we derive that $\Ker(i^{\#})$ is contained in the kernel of $\left(\left(a_Y\right)_*\left(1_{\bd{G}}\times_ki\right)^{\#} \right)\cdot a_Y^{\#}$. This implies that $a_Y\cdot \left(1_{\bd{G}}\times_ki\right)$ factors through $i$. Hence there exists a unique morphism $b$ such that the square
\begin{center}
\begin{tikzpicture}
[description/.style={fill=white,inner sep=2pt}]
v\matrix (m) [matrix of math nodes, row sep=3em, column sep=4em,text height=1.5ex, text depth=0.25ex] 
{   \bd{G}\times_k Z & \bd{G}\times_kY \\
    Z                & Y\\} ;
\path[->,line width=1.0pt,font=\scriptsize]
(m-1-1) edge node[left] {$ b $} (m-2-1)
(m-1-2) edge node[right] {$ a_Y $} (m-2-2);
\path[right hook->,line width=1.0pt,font=\scriptsize]
(m-1-1) edge node[above] {$ 1_{\bd{G}} \times_k i $} (m-1-2)
(m-2-1) edge node[below] {$ i  $} (m-2-2);
\end{tikzpicture}
\end{center}
is commutative. We claim that $b$ is an action of $\bd{G}$ on $Z$. Indeed, one can easily verify that
$$i\cdot b\cdot \left(1_{\bd{G}}\times_k b\right) = i\cdot b \cdot \left(\mu \times_k 1_Z\right)$$
and
$$i \cdot b \cdot \langle e, 1_Z \rangle = i$$
where $\mu:\bd{G}\times_k\bd{G}\ra \bd{G}$ is the multiplication and $e:\Spec k\ra \bd{G}$ is the unit. Since $i$ is a closed immersion, we derive that $i$ can be cancelled from the left in equalities above. This proves that the claim. Note that by the commutativity of the square above $i$ is $\bd{G}$-equivariant. If $b':\bd{G}\times_kZ\ra Z$ is another action of $\bd{G}$ which makes $i$ a $\bd{G}$-equivariant morphism, then we have $i\cdot b' = i\cdot b$. By virtue of the fact that $i$ is a closed immersion, we derive that $b = b'$. Hence $b$ is unique and this completes the proof of \textbf{(1)}.\\
For the proof of \textbf{(2)} note that 
$$i\cdot g\cdot a_X = a_Y\cdot \left(1_{\bd{G}}\times_k i\right)\cdot \left(1_{\bd{G}}\times_k g\right) = i\cdot b\cdot \left(1_{\bd{G}}\times_k g\right)$$
and since $i$ is a closed immersion, we deduce that $g\cdot a_X = b\cdot \left(1_{\bd{G}}\times_k g\right)$. Thus $g$ is $\bd{G}$-equivariant.\\
It remains to prove \textbf{(3)} under additional assumption that $\bd{G},X,Y$ are locally of finite type over $k$. Note that that $g^{\#}$ is injective and $g$ is of finite type (indeed, it is quasi-compact and $X,Z$ are locally of finite type over $k$). Moreover, the surjectivity of morphisms descends along faithfully flat and quasi-compact base change. Thus we may assume that $k$ is algebraically closed. By {\cite[Theorem 10.20]{gortz2010algebraic}} and the fact that $g$ is of finite type, we deduce that $g\left(X\right)$ is a constructible subset locally on $Z$. Since $g^{\#}$ is injective, we derive that set-theoretic image $g\left(X\right)\subseteq Z$ is dense. Thus $g\left(X\right)$ is dense and locally constructible. Hence there exists an open and dense subset $V$ of $Z$ such that $V\subseteq g\left(X\right)$. Since $k$ is algebraically closed and $Z$ is locally of finite type over $k$, we may pick a $k$-point $v$ in $V$. Thus $V$ is an open neighborhood of $v$ in $Z$, which is dense in $Z$ and contained in $g\left(X\right)$. Next
$$g(X) \subseteq \bd{G}\cdot V \subseteq \bd{G} \cdot g\left(X\right)\subseteq g\left(X\right)$$
Thus $g(X)$ is open in $Z$. This completes the proof of \textbf{(3)}.
\end{proof}
\noindent
So far we discussed only closed $\bd{G}$-stable subschemes. Now we introduce more related notion.

\begin{definition}
Let $\bd{G}$ be a group scheme over $k$ and let $a:\bd{G}\times_k X\ra X$ be an action of $\bd{G}$ on $k$-scheme $X$. Suppose that $Z$ is a closed subset of $X$ such that 
$$\mathrm{pr}_X^{-1}(Z) \subseteq a^{-1}(Z)$$
where $\mathrm{pr}_X:\bd{G}\times_kX\ra X$ is the canonical projection. Then $Z$ is \textit{a $\bd{G}$-stable closed subset of $X$}. 
\end{definition}
\noindent
The corollary below shows that under mild assumptions every closed $\bd{G}$-stable closed subset supports a closed $\bd{G}$-stable subscheme.

\begin{corollary}\label{corollary:every_closed_stable_subset_supports_closed_stable_subscheme}
Let $\bd{G}$ be a quasi-compact group scheme over $k$ and let $X$ be a $k$-scheme equipped with an action of $\bd{G}$. Then for every closed $\bd{G}$-stable subset $Z$ supports a closed $\bd{G}$-stable subscheme of $X$.
\end{corollary}
\begin{proof}
Denote by $a$ the action of $\bd{G}$ on $X$. Let $W$ be a closed subscheme of $X$ supported on $Z$ and with the reduced structure. Consider a morphism $f = a_{\mid \bd{G}\times_k W}:\bd{G}\times_k W\ra X$ of $k$-schemes. Note that it is quasi-compact by Remark \ref{remark:action_of_group_k_functor_is_isomorphic_with_projection} and according to the fact that $\bd{G}$ is quasi-compact. We consider $\bd{G}\times_k W$ as a $k$-scheme equipped with an action of $\bd{G}$ given by multiplication on the left factor of the product. Then $f$ is a $\bd{G}$-equivariant morphism. By Theorem \ref{theorem:scheme_theoretic_images_of_equivariant_morphisms} scheme-theoretic image of $f$ is a closed $\bd{G}$-stable subscheme of $X$. Since $f$ is quasi-compact, its scheme-theoretic image is supported on its set-theoretic image. Moreover, we have $f(W) = Z$ set-theoretically. Indeed, this is a consequence of the fact that $Z$ is $\bd{G}$-stable closed subset of $X$. Thus the scheme-theoretic image of $f$ is supported on $Z$.
\end{proof}

\section{Morphisms of algebraic groups}
\noindent
The following result, which proof is analogical to the proof of Theorem \ref{theorem:scheme_theoretic_images_of_equivariant_morphisms}, is fundamental.

\begin{theorem}\label{theorem:images_of_locally_algebraic_groups_homomorphisms}
Let $f:\bd{H}\ra \bd{G}$ be a morphism of locally algebraic groups over $k$. Suppose that $f$ is of finite type. Let $i:\bd{K}\ra \bd{G}$ be the scheme-theoretic image of $f$ and let $g:\bd{H}\ra \bd{K}$ be the unique morphism of schemes such that $f = i\cdot g$. Then the following assertions hold.
\begin{enumerate}[label=\emph{\textbf{(\arabic*)}}, leftmargin=3.0em]
\item $\bd{K}$ is a closed subgroup $k$-scheme of $\bd{G}$.
\item $g$ is a surjective morphism of group schemes over $k$.
\end{enumerate}
\end{theorem}
\begin{proof}
Since $f$ is quasi-compact, we deduce that $i:\bd{K} \hookrightarrow \bd{G}$ is a closed immersion determined by the kernel of $f^{\#}:\cO_{\bd{G}}\ra f_*\cO_{\bd{H}}$ ({\cite[Proposition 10.30]{gortz2010algebraic}}) and $g^{\#}:\cO_{\bd{K}}\ra g_*\cO_{\bd{H}}$ is an injective morphism of sheaves. Moreover, the fact that $f$ is quasi-compact implies that $g$ is quasi-compact. Fix two affine open subschemes $V,W$ of $\bd{K}$. We derive by Corollary \ref{corollary:regular_functions_on_products_of_semi_separated_and_qc_schemes} and Proposition \ref{proposition:group_schemes_over_a_field_are_separated} that the square
\begin{center}
\begin{tikzpicture}
[description/.style={fill=white,inner sep=2pt}]
\matrix (m) [matrix of math nodes, row sep=3em, column sep=4em,text height=1.5ex, text depth=0.25ex] 
{ \cO_{\bd{K}\times_k\bd{K}}(V\times_k W)  & \cO_{\bd{H}\times_k \bd{H}}\left(g^{-1}(V)\times_k g^{-1}(W)\right) \\
  \cO_{\bd{K}}(V)\otimes_k \cO_{\bd{K}}(W) & \cO_{\bd{H}}\left(g^{-1}(V)\right)\otimes_k \cO_{\bd{H}}\left(g^{-1}(W)\right)  \\} ;
\path[->,line width=1.0pt,font=\scriptsize]
(m-1-1) edge node[above] {$ \left(g\times_k g\right)^{\#}_{V\times_k W} $} (m-1-2)
(m-2-1) edge node[below] {$ g^{\#}_V\otimes_k g^{\#}_W $} (m-2-2)
(m-2-1) edge node[left]  {$ \simeq $} (m-1-1)
(m-2-2) edge node[right] {$ \simeq $} (m-1-2);
\end{tikzpicture}
\end{center}
is commutative, where vertical arrows are canonical isomorphisms. This implies that the morphism $\left(g\times_k g\right)^{\#}$ of sheaves is injective. Consider the commutative diagram
\begin{center}
\begin{tikzpicture}
[description/.style={fill=white,inner sep=2pt}]
\matrix (m) [matrix of math nodes, row sep=3em, column sep=4em,text height=1.5ex, text depth=0.25ex] 
{   \bd{H}\times_k \bd{H} & \bd{K}\times_k \bd{K} & \bd{G}\times_k\bd{G} \\
    \bd{H}                & \bd{K}                & \bd{G}\\} ;
\path[->,line width=1.0pt,font=\scriptsize]
(m-1-1) edge node[above] {$g\times_k g  $} (m-1-2)
(m-2-1) edge node[below] {$g  $} (m-2-2)
(m-1-1) edge node[left] {$ \nu_{\bd{H}} $} (m-2-1)
(m-1-3) edge node[right] {$ \nu_{\bd{G}} $} (m-2-3);
\path[right hook->,line width=1.0pt,font=\scriptsize]
(m-1-2) edge node[above] {$ i\times_k i $} (m-1-3)
(m-2-2) edge node[below] {$ i  $} (m-2-3);
\end{tikzpicture}
\end{center}
where $\nu_{\bd{G}}$ and $\nu_{\bd{H}}$ are morphisms determined by formula $(x_1,x_2)\mapsto x_1^{-1}\cdot x_2$ on $k$-functors of points. Commutativity of the diagram implies that we have equality
$$\big(\left(\nu_{\bd{G}}\right)_*\left(i\times_k i\right)_*\left(g\times_k g\right)^{\#}\big) \cdot \big(\left(\nu_{\bd{G}}\right)_*\left(i\times_k i\right)^{\#} \big) \cdot \nu_{\bd{G}}^{\#} = \big(i_*g_* \left(\nu_{\bd{H}}\right)^{\#} \big) \cdot \big(i_*g^{\#} \big) \cdot i^{\#}$$
of morphism of sheaves. This equality together with injectivity of $\left(g\times_k g\right)^{\#}$ implies that the kernel of
$$\big(\nu_{\bd{G}}\cdot \left(i\times_k i\right)\big)^{\#} = \big(\left(\nu_{\bd{G}}\right)_*\left(i\times_k i\right)^{\#} \big) \cdot \nu_{\bd{G}}^{\#}$$
contains $\Ker(i^{\#})$. Thus $\nu_{\bd{G}}\cdot \left(i\times_k i\right)$ factors through $i$. Hence there exists a unique morphism $\nu$ such that the square
\begin{center}
\begin{tikzpicture}
[description/.style={fill=white,inner sep=2pt}]
v\matrix (m) [matrix of math nodes, row sep=3em, column sep=4em,text height=1.5ex, text depth=0.25ex] 
{   \bd{K}\times_k \bd{K} & \bd{G}\times_k\bd{G} \\
    \bd{K}                & \bd{G}\\} ;
\path[->,line width=1.0pt,font=\scriptsize]
(m-1-1) edge node[left] {$ \nu $} (m-2-1)
(m-1-2) edge node[right] {$ \nu_{\bd{G}} $} (m-2-2);
\path[right hook->,line width=1.0pt,font=\scriptsize]
(m-1-1) edge node[above] {$ i \times_k i $} (m-1-2)
(m-2-1) edge node[below] {$ i  $} (m-2-2);
\end{tikzpicture}
\end{center}
is commutative. This implies that $i:\bd{K} \hookrightarrow \bd{G}$ is a closed subgroup $k$-scheme of $\bd{G}$. Indeed, if $k_1,k_2$ are $A$-points of $\bd{K}$ for some $A$-algebra, then the commutativity of the square above implies that the $A$-point $k_1^{-1}\cdot k_2$ of $\bd{G}$ is the $A$-point of $\bd{K}$ and this is well known criterion for subgroup. Since $i$ is a monomorphism and
$$i\cdot \nu \cdot \left(g\times_k g\right) = \nu_{\bd{G}}\cdot \left(i\times_k i\right) \cdot \left(g\times_k g\right) = i \cdot g \cdot \nu_{\bd{H}}$$
we derive that $\nu \cdot \left(g\times_k g\right) = g\cdot \nu_{\bd{H}}$. Hence $g$ is a morphism of group schemes over $k$. It remains to prove that $g:\bd{H}\ra \bd{K}$ is surjective. Recall that $g$ is of finite type and $g^{\#}$ is injective. Note that these properties are preserved under base change to an algebraic closure of $k$. Moreover, the surjectivity of morphisms descends along faithfully flat and quasi-compact base change. Thus we may assume that $k$ is algebraically closed. By {\cite[Theorem 10.20]{gortz2010algebraic}} and the fact that $g$ is of finite type, we deduce that $g\left(\bd{H}\right)$ is a constructible subset locally on $\bd{K}$. Since $g^{\#}$ is injective, we derive that set-theoretic image $g\left(\bd{H}\right)\subseteq \bd{K}$ is dense. Thus $g\left(\bd{H}\right)$ is dense and locally constructible. Hence there exists an open and dense subset $V$ of $\bd{K}$ such that $V\subseteq g\left(\bd{H}\right)$. Since $k$ is algebraically closed and $\bd{K}$ is locally algebraic, we may pick a $k$-point $v$ in $V$. Since $V\subseteq g\left(\bd{H}\right)$, we deduce that $v\in g\left(\bd{H}\right)$ and thus $v^{-1}\in g\left(\bd{H}\right)$. Hence
$$W = v^{-1}\cdot V \subseteq g\left(\bd{H}\right)\cdot g\left(\bd{H}\right) \subseteq g\left(\bd{H}\right)$$
Thus $W$ is an open neighborhood of the identity in $\bd{K}$, dense in $\bd{K}$ and contained in $g\left(\bd{H}\right)$. Next
$$g(\bd{H}) \subseteq g\left(\bd{H}\right)\cdot W \subseteq g\left(\bd{H}\right)\cdot g\left(\bd{H}\right)\subseteq g\left(\bd{H}\right)$$
Thus $g(\bd{H})$ is open in $\bd{K}$. Now if $u\in \bd{K}\setminus g\left(\bd{H}\right)$ is a $k$-point, then
$$u\cdot g\left(\bd{H}\right)\cap g\left(\bd{H}\right) = \emptyset$$
as two distinct left cosets of an open subgroup $g\left(\bd{H}\right)$ in $\bd{K}$ are disjoint. This is contradiction, because $u\cdot g\left(\bd{H}\right)$ is an open neighborhood of $u$ and $g\left(\bd{H}\right)$ is dense in $\bd{K}$. Therefore, $g\left(\bd{H}\right)$ is an open subset of $\bd{K}$ that contains all its $k$-points. Since $k$ is algebraically closed and $\bd{K}$ is locally algebraic, this implies that the closed subset $\bd{K}\setminus g\left(\bd{H}\right)$ is empty. Thus $g$ is surjective.
\end{proof}

\section{Representability of fixed points for group schemes over a field}

\begin{theorem}\label{theorem:fixed_points_existence}
Let $\bd{G}$ be a group scheme over $k$ and let $a:\bd{G}\times_kX\ra X$ be an action of $\bd{G}$ on a $k$-scheme $X$. Suppose that one of the following assertions hold.
\begin{enumerate}[label=\emph{\textbf{(\roman*)}}, leftmargin=3.0em]
\item $X$ is separated.
\item $\bd{G}$ is a geometrically connected, locally algebraic group.
\end{enumerate}
Then the fixed point functor $X^{\bd{G}}$ is a closed subscheme of $X$.
\end{theorem}
\noindent
The following result is based on {\cite[Theorem 8.2]{kfunctors}} and plays the fundamental role in the proof.

\begin{lemma}\label{lemma:representability_of_fixed_point_functor}
Let $X,Y$ be $k$-schemes and let $a:Y\times_kX\ra X$ be a morphism of $k$-schemes. Suppose that one of the following assertions hold.
\begin{enumerate}[label=\emph{\textbf{(\arabic*)}}, leftmargin=3.0em]
\item $X$ is separated.
\item For every open subscheme $U$ of $X$ we have $a\left(Y\times_kU\right)\subseteq U$
\end{enumerate}
Consider $k$-subfunctor $X^a$ of $X$ given by formula
$$A \mapsto \big\{f:\Spec A\ra X\,\big|\,a\cdot \left(1_Y \times_k f\right) = \mathrm{pr}_X\cdot \left(1_Y \times_kf\right)\big\}$$
where $A$ is a  $k$-algebra and $\mathrm{pr}_X:Y\times_kX \ra X$ is the projection. Then $X^a$ is representable by a closed subscheme of $X$.
\end{lemma}
\begin{proof}[Proof of the lemma]
In the proof we identify $k$-schemes with their $k$-functors of points ({\cite[Remark 3.8]{kfunctors}}). We use internal homs for $k$-functors representable by $k$-schemes. Note that by Fact {\cite[Fact 3.10]{kfunctors}} they exists.\\
Assume first that $X$ is separated. Consider a morphism
$$\langle a, \mathrm{pr}_X\rangle:Y\times_kX\ra X\times_k X$$
By {\cite[Theorem 2.6]{kfunctors}} we deduce that $\langle a, \mathrm{pr}_X\rangle$ corresponds to a morphism $\sigma:X \ra \iMor_k\left(Y, X\times X\right)$ of $k$-functors. Since $X$ is separated, the diagonal $\delta_X:X\ra X\times_k X$ is a closed immersion. This implies that $\delta_X$ is a closed immersion of $k$-functors. The fact that $Y$ is locally free over $k$ (every scheme over a field is locally free) and {\cite[Theorem 8.2]{kfunctors}} imply that
$$\iMor_k\left(1_Y, \delta_X \right):\iMor_k\left( Y,X \right) \hookrightarrow \iMor_k\left(Y, X \times X \right)$$
is a closed immersion of $k$-functors. Consider now a cartesian square
\begin{center}
\begin{tikzpicture}
[description/.style={fill=white,inner sep=2pt}]
\matrix (m) [matrix of math nodes, row sep=3em, column sep=4em,text height=1.5ex, text depth=0.25ex] 
{ X^a      & \iMor_k\left( Y, X \right)               \\
  X      & \iMor_k\left( Y, X \times X \right)  \\} ;
\path[->,line width=1.0pt,font=\scriptsize]
(m-1-1) edge node[above] {$  $} (m-1-2)
(m-2-1) edge node[below] {$ \sigma $} (m-2-2)
(m-1-1) edge node[left]  {$ j $} (m-2-1)
(m-1-2) edge node[right] {$ \iMor_k\left( 1_Y, \delta_X \right) $} (m-2-2);
\end{tikzpicture}
\end{center}
of $k$-functors. {\cite[Fact 5.8]{kfunctors}} implies that $j:X^a\ra X$ is a closed immersion of $k$-functors. Observe that $j:X^a \hookrightarrow X$ is precisely the inclusion of the $k$-subfunctor described in the statement. {\cite[Proposition 5.9]{kfunctors}} completes the proof of \textbf{(1)}.\\
Now suppose that $a\left(Y\times_kU\right) \subseteq U$ for every open subscheme $U$ of $X$. For every open subscheme denote by $a_U:Y\times_kU\ra U$ the restriction of $a$. Let $\cU$ be an open affine cover of $X$. Let $j: X^a \hookrightarrow X$ be a monomorphism of $k$-functors in the statement. For each $U$ in $\cU$ we have a cartesian square
\begin{center}
\begin{tikzpicture}
[description/.style={fill=white,inner sep=2pt}]
\matrix (m) [matrix of math nodes, row sep=3em, column sep=3em,text height=1.5ex, text depth=0.25ex]
{   U^{a_U}  & X^a      \\
    U & X           \\};
\path[right hook->,line width=1.0pt,font=\scriptsize]
(m-1-1) edge node[above] {$  $} (m-1-2)
(m-2-1) edge node[below] {$  $} (m-2-2)
(m-1-1) edge node[left] {$ j_U $} (m-2-1)
(m-1-2) edge node[right] {$j $} (m-2-2);
\end{tikzpicture}
\end{center}
where $U\hookrightarrow X$ is the inclusion and $U^{a_U} \hookrightarrow X^a$ interprets $U^{a_U}$ as an open $k$-subfunctor of $X^a$. Since each $U$ is separated, by virtue of \textbf{(1)} each $j_U:U^{a_U} \hookrightarrow U$ is a closed immersion of $k$-schemes. Since $\cU$ is an open cover of $X$, it follows by simple argument that $j:X^a \hookrightarrow X$ is a closed immersion of $k$-functors. By virtue of {\cite[Proposition 5.9]{kfunctors}} this proves \textbf{(2)}.
\end{proof}

\begin{lemma}\label{lemma:infinitesimal_isomorphisms}
Let $f:\bd{H}\ra \bd{G}$ be a morphism of locally algebraic groups over $k$. Suppose that the following assertions hold.
\begin{enumerate}[label=\emph{\textbf{(\arabic*)}}, leftmargin=3.0em]
\item The morphism
$$\widehat{\cO_{\bd{G},e_{\bd{G}}}} \ra  \widehat{\cO_{\bd{H},e_{\bd{H}}}}$$
induced by $f^{\#}$ is an isomorphism.
\item $f$ is a monomorphism of $k$-schemes.
\end{enumerate}
Then $f$ is an open immersion.
\end{lemma}
\begin{proof}[Proof of the lemma]
Note that $f$ is locally of finite type. The assertion \textbf{(1)} implies that $f$ is {\'e}tale in $e_{\bd{H}}$. Let $K$ be an algebraic closure of $k$ and let us use the following notation:
$$\bd{G}_K = \Spec K\times_k\bd{G},\,\bd{H}_K = \Spec K\times_k \bd{H},\,f_K = 1_{\Spec K}\times_kf$$
Consider the {\'e}tale locus $U$ of $f_k$. Then $U$ is an open subscheme of $\bd{H}_K$ containing the identity of $\bd{G}_K$. Moreover, for every $K$-point $h$ of $\bd{H}_K$ we have a commutative square
\begin{center}
\begin{tikzpicture}
[description/.style={fill=white,inner sep=2pt}]
\matrix (m) [matrix of math nodes, row sep=3em, column sep=4em,text height=1.5ex, text depth=0.25ex]
{ \bd{H}_K  & \bd{G}_K          \\
  \bd{H}_K  & \bd{G}_K  \\};
\path[->,line width=1.0pt,font=\scriptsize]
(m-1-1) edge node[above] {$ f_K $} (m-1-2)
(m-2-1) edge node[below] {$ f_K $} (m-2-2)
(m-1-1) edge node[left]  {$ h\cdot (-)  $} (m-2-1)
(m-1-2) edge node[right] {$ f_K(h)\cdot (-)  $} (m-2-2);
\end{tikzpicture}
\end{center}
where $h\cdot (-)$ and $f_K(h)\cdot (-)$ are isomorphisms of $K$-schemes. This proves that $h\cdot U\subseteq U$. Hence $U$ contains all $K$-rational points of $\bd{H}_K$. Therefore, the complement of $U$ in $\bd{H}_K$ is a closed subset and does not contain $K$-points. Since $\bd{H}_K$ is a scheme locally of finite type over an algebraically closed field $K$, this proves that the complement of $U$ is empty. Hence $U = \bd{H}_K$. This shows that $f_K$ is {\'e}tale and by faithfully flat descent also $f$ is {\'e}tale. Since {\'e}tale monomorphisms are open immersions, we derive that $f$ is an open immersion.
\end{proof}

\begin{proof}[Proof of the theorem]
If \textbf{(1)} holds, then the statement follows directly from Lemma \ref{lemma:representability_of_fixed_point_functor} if $Y = \bd{G}$ and $a$ is the action of $\bd{G}$ on $X$.\\
Suppose now that \textbf{(2)} holds. That is $\bd{G}$ is a geometrically connected, locally algebraic group over $k$. In the proof we use {\cite[Corollary 3.6]{kfunctors}} and view $X^{\bd{G}}$ as a Zariski local $k$-functor. For each $n\in \NN$ we define
$$\bd{G}_n = \Spec \cO_{\bd{G},e_{\bd{G}}}/\ideal{m}_{e_{\bd{G}}}^{n+1}$$
where $e$ is the unit of $\bd{G}$. Then $\bd{G}_n$ is the $n$-th infinitesimal neighborhood of $e$ in $\bd{G}$. Denote by $p_n:\bd{G}_n\times_kX\ra X$ the projection on the second factor. Let $a_n:\bd{G}_n\times_kX\ra X$ be the morphism induced by $a$. Note that for every open subscheme $U$ of $X$ we have $a_n\left(\bd{G}_n\times_kU\right)\subseteq U$. By Lemma \ref{lemma:representability_of_fixed_point_functor} it follows that the $k$-functor given by
$$\Alg_k \ni A \mapsto \big\{f:\Spec A\ra X\,\big|\,a_n\cdot \left(1_{\bd{G}_n}\times_k f\right) = \mathrm{pr}_n\cdot \left(1_{\bd{G}_n}\times_kf\right)\big\} \in \Set$$
is representable by a closed subscheme $Z_n$ of $X$. Consider now the quasi-coherent ideal $\cI_n$ of $Z_n$ inside $X$. Define
$$\cI = \sum_{n\in \NN}\cI_n$$
Let $i:Z\hookrightarrow X$ be a closed subscheme of $X$ determined by $\cI$. This means that $Z$ is the scheme-theoretic intersection inside $X$ of closed subschemes $Z_n$ for $n\in \NN$. We show that $Z$ represents the fixed point functor. For this assume that $A$ is a $k$-algebra and $f:\Spec A\ra X$ is a morphism of $k$-schemes such that $f$ is an $A$-point of the fixed point functor. This is equivalent with
$$a\cdot \left(1_{\bd{G}}\times_k f\right) = \mathrm{pr}_X\cdot \left(1_{\bd{G}}\times_kf\right)$$
From this equality we deduce that
$$a_n\cdot \left(1_{\bd{G}_n}\times_k f\right) = \mathrm{pr}_n\cdot \left(1_{\bd{G}_n}\times_kf\right)$$
for every $n\in \NN$ and hence $f$ factors through $Z_n$ for every $n\in \NN$. Hence $f^{-1}(\cI_n)A = 0$ for every $n\in \NN$. Thus $f^{-1}(\cI)A = 0$ and we derive that $f$ factors through $Z$. This proves that the fixed point functor is a $k$-subfunctor of the functor of points of $Z$. It suffices to prove that $Z$ is $\bd{G}$-fixed. For this consider the morphism $a_{\mid \bd{G}\times_kZ}:\bd{G}\times_kZ\ra X$. By {\cite[Theorem 2.6]{kfunctors}} it corresponds to a morphism $\sigma:\bd{G} \ra \iMor_k\left(Z,X\right)$ of $k$-functors. The fact that $Z$ is locally free over $k$ (every scheme over a field is locally free) and {\cite[Theorem 8.2]{kfunctors}} imply that $\iMor_k\left(1_Z,i\right)$ is a closed immersion of $k$-functors. Therefore, the composition of a closed immersion $\bd{1}\hookrightarrow \iMor_k\left(Z,Z\right)$ determined by $1_Z$ ($\bd{1}$ is the terminal $k$-functor) with $\iMor_k\left(1_Z,i\right)$ is a closed immersion of $k$-functors (by {\cite[Fact 5.8]{kfunctors}}). Consider a cartesian square
\begin{center}
\begin{tikzpicture}
[description/.style={fill=white,inner sep=2pt}]
\matrix (m) [matrix of math nodes, row sep=3em, column sep=4em,text height=1.5ex, text depth=0.25ex] 
{ \fH         & \bd{1}  \\
              & \iMor_k\left( Z,Z \right)               \\
  \bd{G}      & \iMor_k\left( Z,X \right)  \\} ;
\path[->,line width=1.0pt,font=\scriptsize]
(m-1-1) edge node[above] {$  $} (m-1-2)
(m-3-1) edge node[below] {$ \sigma $} (m-3-2)
(m-1-1) edge node[left]  {$ j $} (m-3-1)
(m-2-2) edge node[right] {$ \iMor_k\left(1_{Z}, i \right) $} (m-3-2)
(m-1-2) edge node[right] {$ \mathrm{determined\,by\,}1_Z $} (m-2-2);
\end{tikzpicture}
\end{center}
We derive that $j:\fH \hookrightarrow \bd{G}$ is a closed immersion of $k$-functors. Note that an $A$-point $g$ of $\bd{G}$ is contained in $\fH(A)$ if and only if the action of $g$ on $X_A$ restricts to identity on its $A$-subfunctor $Z_A$. From this description it follows that $\fH$ is a subgroup $k$-functor of $\bd{G}$, which fixes $Z$ inside $X$. We denote by $\bd{H}$ locally algebraic group over $k$ representing $\fH$. We deduce that $j:\bd{H}\hookrightarrow \bd{G}$ is a closed immersion of locally algebraic groups. By definition of $i:Z\hookrightarrow X$, we derive that the morphism of local $k$-algebras
$$\widehat{\cO_{\bd{G},e_{\bd{G}}}} \ra  \widehat{\cO_{\bd{H},e_{\bd{H}}}}$$
induced by $j^{\#}$ is an isomorphism. Hence by Lemma \ref{lemma:infinitesimal_isomorphisms} $j$ is an open immersion of locally algebraic groups. Thus $j$ is both open and closed immersion. Since $\bd{G}$ is geometrically connected, we deduce that $j$ is an isomorphism. Thus $j$ is an isomorphism and this means (by virtue of the description of $A$-points of $\fH$ above) that $Z$ is fixed by $\bd{G}$.
\end{proof}
































































































\small
\bibliographystyle{alpha}
\bibliography{../zzz}




\end{document}

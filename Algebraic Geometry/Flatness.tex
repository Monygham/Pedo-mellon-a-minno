\input pree.tex

\begin{document}

\title{Flatness}
\date{}
\maketitle
\section{Introduction}
\noindent
In this notes we do not assume that rings unital but possibly noncommutative. For homological algebra (exact sequences, the notion of projective module, properties of $\mathrm{Tor}$ etc.) the reader should consult \cite{weibel1995introduction}.

\section{Filtered colimits in the category of modules}

\begin{definition}
Let $I$ be a category. Suppose that the following conditions are satisfied.
\begin{enumerate}[label=\textbf{(\arabic*)}, leftmargin=1.5em]
\item For any objects $i$, $j\in I$ there exists an object $k\in I$ and a diagram
\begin{center}
\begin{tikzpicture}
[description/.style={fill=white,inner sep=2pt}]
\matrix (m) [matrix of math nodes, row sep=2em, column sep=2em,text height=1.5ex, text depth=0.25ex] 
{     &   k &                    \\
      i &  &  j                       \\} ;
\path[->,font=\scriptsize]  
(m-2-1) edge node[auto] {$ $} (m-1-2)
(m-2-3) edge node[auto] {$ $} (m-1-2);
\end{tikzpicture}
\end{center}
\item For any pair of parallel morphisms in $I$
\begin{center}
\begin{tikzpicture}
[description/.style={fill=white,inner sep=2pt}]
\matrix (m) [matrix of math nodes, row sep=3em, column sep=3em,text height=1.5ex, text depth=0.25ex] 
{  i &    j                       \\} ;
\path[->,font=\scriptsize]  
(m-1-1) edge[transform canvas={yshift=0.5ex}] node[auto] {$ $} (m-1-2)
(m-1-1) edge[transform canvas={yshift=-0.5ex}]  node[auto] {$ $} (m-1-2);
\end{tikzpicture}
\end{center}
there exist an object $k\in I$ and a morphism $j\ra k$ such that, the following diagram is commutative
\begin{center}
\begin{tikzpicture}
[description/.style={fill=white,inner sep=2pt}]
\matrix (m) [matrix of math nodes, row sep=3em, column sep=3em,text height=1.5ex, text depth=0.25ex] 
{  i &    j                   & k     \\} ;
\path[->,font=\scriptsize]  
(m-1-1) edge[transform canvas={yshift=0.5ex}] node[auto] {$ $} (m-1-2)
(m-1-1) edge[transform canvas={yshift=-0.5ex}]  node[auto] {$ $} (m-1-2)
(m-1-2) edge  node[auto] {$ $} (m-1-3);
\end{tikzpicture}
\end{center}
\end{enumerate}
Then we say that $I$ is \textit{a filtered category}.
\end{definition}
\noindent
Let $R$ be a ring.

\begin{proposition}\label{proposition:filteredexact}
Let $I$ be a small filtered category. Then the functor sending $I$-indexed diagram of left $R$-modules to its colimit is exact.
\end{proposition}
\begin{proof}
Suppose that 
\begin{center}
\begin{tikzpicture}
[description/.style={fill=white,inner sep=2pt}]
\matrix (m) [matrix of math nodes, row sep=3em, column sep=3em,text height=1.5ex, text depth=0.25ex] 
{\bigg\{0 &K_i &  M_i   &N_i  &          0\bigg\}_{i\in I}         \\} ;
\path[->,font=\scriptsize]  
(m-1-1) edge node[auto] {$ $} (m-1-2)
(m-1-2) edge node[auto] {$r_i $} (m-1-3)
(m-1-3) edge node[auto] {$p_i $} (m-1-4)
(m-1-4) edge node[auto] {$ $} (m-1-5);
\end{tikzpicture}
\end{center}
is an $I$-indexed family of short exact sequences. Consider a complex
\begin{center}
\begin{tikzpicture}
[description/.style={fill=white,inner sep=2pt}]
\matrix (m) [matrix of math nodes, row sep=3em, column sep=3em,text height=1.5ex, text depth=0.25ex] 
{0&K&  M  &N&          0           \\} ;
\path[->,font=\scriptsize]  
(m-1-1) edge node[auto] {$ $} (m-1-2)
(m-1-2) edge node[auto] {$r $} (m-1-3)
(m-1-3) edge node[auto] {$p $} (m-1-4)
(m-1-4) edge node[auto] {$ $} (m-1-5);
\end{tikzpicture}
\end{center}
where $K=\mathrm{colim}_{i\in I}K_i$, $M=\mathrm{colim}_{i\in I}M_i$, $N=\mathrm{colim}_{i\in I}N_i$, $r=\mathrm{colim}_{i\in I}r_i$ and $p=\mathrm{colim}_{i\in I}p_i$. Clearly the complex is right exact. It suffices to prove that $r$ is a monomorphism. For $i\in I$ denote by $v_i:K_i\ra K$, $u_i:M_i\ra M$ structural morphisms. Pick $k\in K$ such that $r(k)=0$. Since $I$ is filtered, we have
$$K=\sum_{i\in I}v_i(K_i),\,M=\sum_{i\in I}u_i(M_i)$$
Thus there exists $i_0\in I$ and $k_{i_0}\in K_{i_0}$ such that $v_{i_0}(k_{i_0})=k$. We have $u_{i_0}\left(r_{i_0}(k_{i_0})\right)=r(k)=0$. Again using the fact that $I$ is filtered, we deduce that there exist $i_1\in I$ and a morphism $\alpha:i_0\ra i_1$ such that $u_{\alpha}\left(r_{i_0}(k_{i_0})\right)=0$, where $u_{\alpha}:M_{i_0}\ra M_{i_1}$ is a morphism in the $I$-indexed diagram $\{M_i\}_{i\in I}$. Now let $k_{i_1}=v_{\alpha}(k_{i_0})$, where $v_{\alpha}:K_{i_0}\ra K_{i_1}$ is a morphism in the $I$-indexed diagram $\{K_i\}_{i\in I}$. Then $v_{i_1}(k_{i_1})=k$ and $r_{i_1}(k_{i_1})=0$. Since $r_{i_1}$ is a monomorphism, we derive that $k_{i_1}=0$ and hence $k=v_{i_1}(k_{i_1})=0$. Thus $r$ is a monomorphism.
\end{proof}

\begin{corollary}\label{corollary:torpreservesfiltered}
Let $M$ be a right $R$-module. Then for every $i\in \NN$ functor $\mathrm{Tor}^R_i(M,-)$ defined on the category of left $R$-modules and with values in the category of abelian groups preserves filtered colimits.
\end{corollary}
\begin{proof}
Let $I$ be a small filtered category and $\{N_i\}_{i\in I}$ be an $I$-indexed diagram of left $R$-modules. Fix a projective resolution $P_{\bullet}\ra M$ of $M$. Since tensor product commutes with colimits, we have 
$$\mathrm{colim}_{i\in I}\left(P_{\bullet}\otimes_RN_i\right)=P_{\bullet}\otimes_R\mathrm{colim}_{i\in I}N_i$$
in the category of complexes of abelian groups. Since exact functors preserve kernels, cokernels and images, we derive by Proposition \ref{proposition:filteredexact} that for every $n\in \NN$ there is an identification
$$\mathrm{Tor}^R_n\left(M,\mathrm{colim}_{i\in I}N_i\right)=H_n\left(P_{\bullet}\otimes_R\mathrm{colim}_{i\in I}N_i\right)=H_n\left(\mathrm{colim}_{i\in I}\left(P_{\bullet}\otimes_RN_i\right)\right)=$$
$$=\mathrm{colim}_{i\in I}H_n\left(P_{\bullet}\otimes_RN_i\right)=\mathrm{colim}_{i\in I}\mathrm{Tor}^R_n\left(M,N_i\right)$$
of cocones.
\end{proof}

\section{Homological characterizations of flatness}
\noindent
Let $R$ be a ring with unit.

\begin{definition}
Let $M$ be a right $R$-module. We say that $M$ is \textit{flat} if the functor $M\otimes_R(-)$ defined on the category of left $R$-modules and with values in the category of abelian groups is exact.
\end{definition}

\begin{proposition}\label{proposition:flatcolimits}
Let $I$ be a filtered category and $\{M_i\}_{i\in I}$ be an $I$-indexed diagram of flat right $R$-modules. Then $\mathrm{colim}_{i\in I}M_i$ is a flat right $R$-module.
\end{proposition}
\begin{proof}
Proposition \ref{proposition:filteredexact} implies that filtered colimits of short exact sequences of abelian groups are short exact seqeunces. Thus filtered colimits of flat right $R$-modules are flat.
\end{proof}

\begin{proposition}[Homological criterion for flatness]\label{proposition:homologicalflatness}
Let $M$ be a right $R$-module. Then the following are equivalent.
\begin{enumerate}[label=\emph{\textbf{(\roman*)}}, leftmargin=1.5em]
\item For every finitely generated left ideal $I\subseteq R$ morphism $M\otimes_RI\ra M$ induced by the inclusion of $I$ in $R$ is a monomorphism.
\item $\mathrm{Tor}^R_1(M,R/I)=0$ for every finitely generated left ideal $I\subseteq R$.
\item $M$ is flat.
\item $\mathrm{Tor}^R_i(M,N)=0$ for every left $R$-module $N$ and $i>0$.
\end{enumerate}
\end{proposition}
\begin{proof}
The implication $\textbf{(i)}\Rightarrow \textbf{(ii)}$ is straightforward.\\
Suppose that $\textbf{(ii)}$ holds. Then for every left ideal $I\subseteq R$ we can write $I=\mathrm{colim}_{\lambda\in \Lambda}I_{\lambda}$, where $\{I_{\lambda}\}_{\lambda\in \Lambda}$ is a filtered set of all finitely generated left ideals of $R$ contained in $I$. This induces a presentation of $R/I$ as a filtered colimit of the system $\{R/I_{\lambda}\}_{\lambda\in \Lambda}$ and thus by Corollary \ref{corollary:torpreservesfiltered} we have
$$\mathrm{Tor}^R_1(M,R/I)=\mathrm{colim}_{\lambda\in \Lambda}\mathrm{Tor}^R_1(M,R/I_{\lambda})=0$$
Now suppose that $N$ is a finitely generated left module over $R$. Then we can decompose $N$ such that it fits in an exact sequence
\begin{center}
\begin{tikzpicture}
[description/.style={fill=white,inner sep=2pt}]
\matrix (m) [matrix of math nodes, row sep=3em, column sep=2em,text height=1.5ex, text depth=0.25ex] 
{0&K&  N   &R/I&          0             \\} ;
\path[->,font=\scriptsize]  
(m-1-1) edge node[auto] {$ $} (m-1-2)
(m-1-2) edge node[auto] {$ $} (m-1-3)
(m-1-3) edge node[auto] {$q $} (m-1-4)
(m-1-4) edge node[auto] {$ $} (m-1-5);
\end{tikzpicture}
\end{center}
Now we have $\mathrm{Tor}^R_1(M,K)=0$ implies that $\mathrm{Tor}^R_1(M,N)=0$. Therefore, using induction on the minimal number of generators of finitely generated left $R$-module we may prove that $\mathrm{Tor}^R_1(M,N)=0$ for every finitely generated left $R$-module. Since every left $R$-module is a filtered colimit of its finitely generated left $R$-submodules, we derive by Corollary \ref{corollary:torpreservesfiltered} that $\mathrm{Tor}^R_1(M,N)=0$ for every left $R$-module $N$. Using first terms of the long exact sequence for $\mathrm{Tor}$ associated with $M\otimes_R(-)$ we deduce \textbf{(iii)}.\\
Now if $M$ is flat, then tensoring with $M$ is exact. This means that tensor product of a free resolution of a left $R$-module $N$ with $M$ has trivial higher homologies. Thus $\mathrm{Tor}^R_i(M,N)=0$ for $i>0$. This proves $\textbf{(iii)}\Rightarrow \textbf{(iv)}$.\\
Finally $\textbf{(iv)}\Rightarrow \textbf{(i)}$ is obvious.
\end{proof}

\section{Flatness in terms of equations}
\noindent
Let $R$ be a ring with unit.

\begin{proposition}\label{proposition:zerocriterion}
Let $M$ be a right $R$-module and $N$ be a left $R$-module. Suppose that $\{y_i\}_{i\in I}$ is a set of generators for $N$ and $\{x_i\}_{i\in I}$ is a set of  elements of $M$. Suppose that all $x_i$ for $i\in I$ except of finitely many are zero. Assume that
$$\sum_{i\in I}x_i\otimes y_i=0$$
in tensor product $M\otimes_RN$. Then there exist $n\in \NN$, $\{a_{ik}\}_{i\in I,1\leq k\leq n}$ in $R$ and $\{z_k\}_{1\leq k\leq n}$ in $M$ such that
$$x_i=\sum^n_{k=1}z_ka_{ki}$$
for every $i\in I$ and 
$$\sum_{i\in I}a_{ki}y_i= 0$$
for every $1\leq k\leq n$.
\end{proposition}
\begin{proof}
Consider a free left $R$-module $F$ on a set $I$ and a morphism $\phi:F\ra N$ given by $\phi(e_i)=y_i$, where $e_i$ is a free generator corresponding to $i\in I$. Let $K=\ker( \phi)$. Applying $M\otimes_R(-)$ we derive that $M\otimes_RK$ maps onto the kernel of $1_M\otimes_R\phi$.
Next by assumptions $(1_M\otimes_R\phi)(\sum_{i\in I}x_i\otimes e_i)=\sum_{i\in I}x_i\otimes y_i=0$. Thus $\sum_{i\in I}x_i\otimes e_i$ is equal to $\sum^n_{k=1}z_k\otimes f_k$ for $z_k\in M$, $f_k\in K$ and $n\in \NN$. We can write $f_k=\sum_{i\in I}a_{ki}e_i$. Then we have
$$\sum^n_{k=1}z_k\otimes f_k=\sum^n_{k=1}z_k\otimes\left(\sum_{i\in I}a_{ki}e_i\right)=\sum^n_{k=1}\sum_{i\in I}\left(z_k\otimes a_{ki}e_i\right)=\sum_{i\in I}\sum^n_{k=1}\left(z_ka_{ki}\otimes e_i\right)=\sum_{i\in I}\left(\sum^n_{k=1}z_k a_{ki}\right)\otimes e_i$$
We deduce that $x_i=\sum^n_{k=1}z_ka_{ki}$ and $0=\sum_{i\in I}a_{ki}y_i$  for every $i\in I$ and $1\leq k\leq n$.
\end{proof}

\begin{theorem}[Equational criteria for flatness]\label{theorem:equationalcriteria}
Let $M$ be a right $R$-module. Then the following are equivalent.
\begin{enumerate}[label=\emph{\textbf{(\roman*)}}, leftmargin=1.5em]
\item $M$ is flat.
\item For every set of elements $\{x_i\}_{i=1,...,n}$ in $M$ and a relation
$$\sum^n_{i=1}x_ia_{i}=0$$
where $a_{i}\in R$ there exist elements $z_k\in M$ and $r_{ki}\in R$ for $1\leq k\leq l$ such that
\begin{center}
$x_i=\sum^l_{k=1}z_kr_{ki}$, $\sum^n_{i=1}r_{ki}a_{i}=0$
\end{center}
for every $1\leq i \leq n$ and $1\leq k\leq l$.
\item For every finitely presented right $R$-module $N$, every morphism $\phi:N\ra M$ and every finitely generated $R$-submodule $K\subseteq \ker(\phi)$ there exists a factorization
\begin{center}
\begin{tikzpicture}
[description/.style={fill=white,inner sep=2pt}]
\matrix (m) [matrix of math nodes, row sep=3em, column sep=2em,text height=1.5ex, text depth=0.25ex] 
{     &   G &                    \\
      N &  &  M                       \\} ;
\path[->,font=\scriptsize]  
(m-2-1) edge node[auto] {$ \psi $} (m-1-2)
(m-1-2) edge node[auto] {$ \theta$} (m-2-3)
(m-2-1) edge node[below] {$\phi $} (m-2-3);
\end{tikzpicture}
\end{center}
where $G$ is a finitely generated free right $R$-module and $K\subseteq \ker(\psi)$.
\item For every set of elements $\{x_i\}_{i=1,...,n}$ in $M$ and a finite set of relations
$$\sum^n_{i=1}x_ia_{ij}=0$$
where $1\leq j\leq m$ and $a_{ij}\in R$ there exist elements $z_k\in M$ and $r_{ki}\in R$ for $1\leq k\leq l$ such that
\begin{center}
$x_i=\sum^l_{k=1}z_kr_{ki}$, $0=\sum^n_{i=1}r_{ki}a_{ij}$
\end{center}
for every $1\leq i \leq n$, $1\leq j\leq m$ and $1\leq k\leq l$.
\end{enumerate}
\end{theorem}
\begin{proof}
Suppose that $M$ is flat. We show then that $\textbf{(ii)}$ holds. We have relation
$$\sum^n_{i=1}x_ia_{i}=0$$
Let $I=\sum_{1\leq i\leq n}Ra_{i}\subseteq R$ be a left ideal. Since $M$ is flat, the canonical morphism $M\otimes_RI\ra M$ is a monomorphism. It sends $\sum_{i=1}^nx_i\otimes a_i$ to $\sum_{i=1}^nx_ia_i=0$. It follows that 
$$\sum^n_{i=1}x_i\otimes a_i=0$$
in $M\otimes_RI$. Thus by Proposition \ref{proposition:zerocriterion} there exist $\{r_{ki}\}_{1\leq i\leq n,1\leq k\leq l}$ in $R$ and $\{z_k\}_{1\leq k\leq l}$ in $M$ such that
$$x_i=\sum^l_{k=1}z_kr_{ki},\,0=\sum^n_{i=1}r_{ki}a_i$$
for every  $1\leq i \leq n$ and $1\leq k\leq l$.\\
Now we prove that $\textbf{(ii)}\Rightarrow \textbf{(iii)}$. Suppose first that $N$ is a finitely generated and free right $R$-module, $\phi:N\ra M$ is a morphism and $K\subseteq \ker(\phi)$ is finitely generated. Note that our result easily follows from \textbf{(ii)}, if $K\subseteq \Ker(\phi)$ is generated by a single element. Now easy induction on the number of generators for $K\subseteq \Ker(\phi)$ yields the assertion $\textbf{(iii)}$ in the case of finitely generated free right $R$-module $N$.\\
Suppose now that $N$ is a finitely presented right $R$-module, $\phi:N\ra M$ is a morphism and $K\subseteq \ker(\phi)$ is a finitely generated submodule. Take an epimorphism $f:F\ra N$ where $F$ is a finitely generated free left $R$-module. Let $\phi'=\phi f$ and pick a factorization
\begin{center}
\begin{tikzpicture}
[description/.style={fill=white,inner sep=2pt}]
\matrix (m) [matrix of math nodes, row sep=3em, column sep=2em,text height=1.5ex, text depth=0.25ex] 
{     &   G &                    \\
      F &  &  M                       \\} ;
\path[->,font=\scriptsize]  
(m-2-1) edge node[auto] {$ g$} (m-1-2)
(m-1-2) edge node[auto] {$ \theta$} (m-2-3)
(m-2-1) edge node[below] {$\phi' $} (m-2-3);
\end{tikzpicture}
\end{center}
where $G$ is a finitely generated free right $R$-module and $f^{-1}(K)\subseteq \ker(g)$. Such a factorization exists according to the fact that $f^{-1}(K)$ is a finitely generated submodule of $\ker(\phi')$. Since $\ker(f)\subseteq f^{-1}(K)$, we deduce that $g$ factorizes through $f$. This proves the implication. \\
Assume that \textbf{(iii)} holds. Suppose that $\{x_i\}_{i=1,...,n}$ are in $M$ and that we have a finite set of relations
$$\sum^n_{i=1}x_ia_{ij}=0$$
where $1\leq j\leq m$ and $a_{ij}\in R$. Let $F$ be a right free $R$-module of rank $n$ with basis $e_1$,...,$e_n$. Define a morphism $\phi:F\ra M$ by $\phi(e_i)=x_i$ for $1\leq i\leq n$. Then 
$$K=\sum_{j=1}^m\left(\sum_{i=1}^ne_ia_{ij}\right)R\subseteq \Ker(\phi)$$
is finitely generated. Hence by \textbf{(iii)} there exist a finitely generated free right $R$-module $G$ and morphisms $\psi:F\ra G$, $\theta:G\ra M$ such that $\phi=\theta \cdot \psi$ and $K\subseteq \Ker(\psi)$. Next if $f_1$,...,$f_l$ is a basis of $G$, then we pick $z_k=\theta(f_k)$ for $1\leq k\leq l$. There exist $r_{ki}\in R$ for $1\leq k\leq l$ and $1\leq i\leq n$ such that $\psi(e_i)=\sum_{k=1}^lf_kr_{ki}$ for $1\leq i\leq n$. Now straightforward verification shows that $z_k\in M$ and $r_{ki}\in R$ for $1\leq k\leq l$ and $1\leq i\leq n$ satisfy \textbf{(iv)}.\\
Now assume that \textbf{(iv)} holds. Let $I$ be a finitely generated left ideal in $R$. Suppose that $a_i$ for $1\leq i \leq n$ are generators of $I$. We are going to prove that the canonical morphism $M\otimes_RI\ra M$ is a monomorphism. This implies \textbf{(i)} due to Proposition \ref{proposition:homologicalflatness}. Assume that there exist $x_i$ for $1\leq i\leq n$ in $M$ such that $\sum_{i=1}^nx_i\otimes a_i\in M\otimes_RI$ is in the kernel of $M\otimes_RI\ra M$. This means that $\sum_{i=1}^nx_ia_i=0$ in $M$. According to \textbf{(iv)} there exist $z_k\in M$ and $r_{ki}\in R$ for $1\leq k\leq l$ and $1\leq i\leq n$ such that
$$x_i=\sum^l_{k=1}z_kr_{ki},\,0=\sum^n_{i=1}r_{ki}a_{i}$$
Thus
$$\sum_{i=1}^nx_i\otimes a_i=\sum_{i=1}^n\left(\sum_{k=1}^lz_kr_{ki}\right)\otimes a_i=\sum_{i=1}^n\sum_{k=1}^l\left(z_kr_{ki}\otimes a_i\right)=\sum_{k=1}^l\sum_{i=1}^n\left(z_k\otimes r_{ki}a_i\right)=\sum_{k=1}^lz_k\otimes \left(\sum_{i=1}^nr_{ki}a_i\right)=0$$
Hence the kernel of the morphism $M\otimes_RI\ra M$ is trivial.
\end{proof}

\section{Categorical characterizations of flatness}
\noindent
Let $R$ be a ring with unit.

\begin{theorem}[Lazard's theorem]\label{theorem:Lazardstheorem}
A right $R$-module $M$ is flat if and only if it is a colimit of a filtered diagram of finitely generated free right $R$-modules.
\end{theorem}
\begin{proof}
If $M$ is a filtered colimit of finitely generated flat right $R$-modules, then Proposition \ref{proposition:flatcolimits} implies that $M$ is flat.\\
Assume now that $M$ is flat. Consider a set of symbols $E=\{e_m\mid m\in M\}$. For every finite subset $\alpha\subseteq E$ let $F_{\alpha}$ be a right free $R$-module generated by symbols in $\alpha$. Next for every such $\alpha$ let $q_{\alpha}:F_{\alpha}\ra M$ be a morphism defined by formula $q_{\alpha}(e_m)=m$ for $e_m\in \alpha$.\\
Next we define a  small diagram category $I$. Objects of $I$ are finite subsets $\alpha\subseteq E$. Morphisms $f:\alpha\ra \beta$ for any two finite subsets $\alpha$, $\beta\subseteq E$ are morphisms of right $R$-modules $f:F_{\alpha}\ra F_{\beta}$ such that $q_{\beta}\cdot f=q_{\alpha}$. The composition of morphisms in $I$ is given by the usual composition of morphisms of right $R$-modules.\\
We will now show that $I$ is a filtered category. Pick $\alpha_1$, $\alpha_2\in I$. Let $\alpha=\alpha_1\cup \alpha_2$. Then $\alpha$ is well defined object of $I$. Moreover, canonical inclusions $\alpha_1\subseteq \alpha$, $\alpha_2\subseteq \alpha$ give rise to morphisms $f_1:F_{\alpha_1}\ra F_{\alpha}$ and $f_2:F_{\alpha_2}\ra F_{\alpha}$ in the category of right $R$-modules and hence give rise to morphisms $f_1:\alpha_1\ra \alpha$ and $f_2:\alpha_2\ra \alpha$ in $I$. This verifies the first axiom of filtered category for $I$. Now if $f,g:\alpha\ra \beta$ are two morphisms in $I$, then $$q_{\beta}\cdot (f-g)=q_{\alpha}-q_{\alpha}=0$$
in the category of right $R$-modules. Hence $(f-g)(F_{\alpha})$ is a finitely generated right $R$-submodule of $F_{\beta}$ contained in the kernel of $q_{\beta}$. Using Theorem \ref{theorem:equationalcriteria} we derive that there exists some finite subset $\gamma\subseteq E$ and a morphism $h:F_{\beta}\ra F_{\gamma}$ such that $h\cdot (f-g)=0$ and $q_{\gamma}\cdot h=q_{\beta}$. This implies that $h:\beta\ra \gamma$ is a morphism in $I$ and $h\cdot f=h\cdot g$. Hence $I$ verifies the second axiom for filtered category.\\
Now we define a diagram of finitely generated free right $R$-modules indexed by $I$. We send each object $\alpha$ of $I$ to right $R$-module $F_{\alpha}$ and we send $f:\alpha\ra \beta$ in $I$ to $f:F_{\alpha}\ra F_{\beta}$ in the category of right $R$-modules. It is clear that it is well defined $I$-indexed diagram.\\
Finally it suffices to verify that $q_{\alpha}:F_{\alpha}\ra M$ for $\alpha\in I$ admit the universal property of colimit for the $I$-indexed diagram defined above. For this let $N$ be some right $R$-module and $r_{\alpha}:F_{\alpha}\ra N$ for $\alpha\in I$ be morphisms such that $r_{\beta}\cdot f=r_{\alpha}$ for every $f:\alpha\ra \beta$ in $I$. Now we define a function $s:M\ra N$ by formula
$$s(m)=r_{\alpha}(e_m)$$
for any $m\in M$ and any $\alpha\in I$ such that $e_m\in \alpha$. It is easy to verify that the function $s$ is well defined. Moreover, it is a unique function that satisfies $s\cdot q_{\alpha}=r_\alpha$.\\
We will show now that $s$ is a morphism of right $R$-modules. Pick $x\in R$ and $m\in M$. Consider $\alpha\in I$ such that $e_m$, $e_{mx}\in \alpha$. Since $q_{\alpha}(e_mx-e_{mx})=mx-mx=0$ and $M$ is flat, by Theorem \ref{theorem:equationalcriteria} there exist $\beta\in I$ and a morphism $f:\alpha \ra \beta$ in $I$ such that $f(e_mx-e_{mx})=0$. Hence we deduce that
$$s(m)x-s(mx)=r_{\alpha}(e_m)x-r_{\alpha}(e_{mx})=r_{\alpha}(e_mx-e_{mx})=r_{\beta}\left(f\left(e_mx-e_{mx}\right)\right)=0$$
Similar argument shows that for $m_1$, $m_2\in M$ the relation $s(m_1+m_2)-\left(s(m_1)+s(m_2)\right)=0$ is satisfied.\\
Now according to the fact that $s:M\ra N$ is a unique morphism of cocones in the category of right $R$-modules, we deduce that 
$$M=\mathrm{colim}_{\alpha\in I}F_{\alpha}$$
\end{proof}

\begin{corollary}
Let $M$ be a right $R$-module of finite presentation. Then $M$ is flat if and only if it is projective.
\end{corollary}
\begin{proof}
Using Theorem \ref{theorem:Lazardstheorem} we derive that $M=\mathrm{colim}_{\alpha \in I}F_{\alpha}$, where $I$ is a filtered category and $\{F_{\alpha}\}_{\alpha\in I}$ is $I$-indexed diagram of finitely generated right free $R$-modules. Next we have that
$$\Hom_R(M,M)=\mathrm{colim}_{\alpha\in I}\Hom_R(M,F_{\alpha})$$
by finite presentation of $M$. Thus there exists an $\alpha\in I$ and a morphism $f:M\ra F_{\alpha}$ such that $q_{\alpha}\cdot f=1_M$ for the structural morphism $q_{\alpha}:F_{\alpha}\ra M$. This means that $q_{\alpha}$ is a retraction. Hence $M$ is a direct summand of a right free $R$-module $P_{\beta}$. Thus it is projective.
\end{proof} 












































\small
\bibliographystyle{apalike}
\bibliography{refs}

\end{document}
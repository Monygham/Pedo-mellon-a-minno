\input ../pree

\begin{document}

\title{Quotients of algebraic groups}
\date{}
\maketitle

\section{Introduction}
\noindent
Throughout this notes $k$ denote a field and $\bd{G}$ denote a group scheme over $k$. We denote by $e$ the identity of $\bd{G}$. We also fix a $k$-scheme $X$ equipped with an action of $\bd{G}$ determined by morphism $a:\bd{G}\times_kX\ra X$.

\section{Basic properties of scheme group quotients}
\noindent
The following result gives scheme-theoretic criterion for topological quotient in the case of group scheme actions.

\begin{proposition}\label{proposition:topological_group_quotient_is_implied_by_submersive_and_kernel_pair}
Let $Y$ be a $k$-scheme with the trivial action of $\bd{G}$ and let $q:X\ra Y$ be a $\bd{G}$-equivariant morphism. Assume that $q$ is submersive and and the morphism $\bd{G}\times_kX\ra X\times_YX$ induced by $a$ and $\mathrm{pr}_X$ is surjective. Then the diagram
\begin{center}
\begin{tikzpicture}
[description/.style={fill=white,inner sep=2pt}]
\matrix (m) [matrix of math nodes, row sep=3em, column sep=3em,text height=1.5ex, text depth=0.25ex] 
{ \bd{G}\times_kX &  X &  Y \\} ;
\path[->,line width=1.0pt,font=\scriptsize]
(m-1-1) edge[transform canvas={yshift=0.5ex}] node[above] {$ a  $} (m-1-2)
(m-1-1) edge[transform canvas={yshift=-0.5ex}] node[below] {$ \mathrm{pr}_X $} (m-1-2)
(m-1-2) edge node[above] {$ q $} (m-1-3);
\end{tikzpicture}
\end{center}
is a cokernel in the category topological spaces.
\end{proposition}
\begin{proof}
Let $\pi_1$ and $\pi_2$ be distinct projections $X\times_YX\ra X$. Pick points $x_1$ and $x_2$ in $X$ such that $q(x_1) = q(x_2)$. Then there exists a field extension $K$ over $k$ such that $k(x_1)\subseteq K$ and $k(x_2)\subseteq K$. These give rise to $K$-points $\ol{x_1}$ and $\ol{x_2}$ of $X$ such that their images under $q$ is the same $K$-point of $Y$. Since we have an identification
$$\big(X\times_YX\big)(K) = X(K)\times_{Y(K)}X(K)$$ 
induced by $\pi_1$ and $\pi_2$, we derive that there exists a $K$-point $\ol{z}$ of $X\times_YX$ such that $\pi_1(\ol{z}) = \ol{x_1}$ and $\pi_2(\ol{z}) = \ol{x_2}$. Let $z$ be the point of $X\times_YX$ corresponding to $\ol{z}$. Then $\pi_1(z) = x_1$ and $\pi_2(z) = x_2$. By assumption $a$ and $\mathrm{pr}_X$ induce surjection $\bd{G}\times_kX\twoheadrightarrow X\times_YX$. Thus there exists a point $u$ of $\bd{G}\times_kX$ such that $a(u) = x_1$ and $\mathrm{pr}_X(u) = x_2$. Thus $x_1$ and $x_2$ are identified by an equivalence relation on the underlying set of $X$ which is determined by the pair $(a, \mathrm{pr}_X)$. Therefore, fibers of $q$ are equivalence classes with respect to this relation. Since $q$ is submersive, this implies that the diagram
\begin{center}
\begin{tikzpicture}
[description/.style={fill=white,inner sep=2pt}]
\matrix (m) [matrix of math nodes, row sep=3em, column sep=3em,text height=1.5ex, text depth=0.25ex] 
{ \bd{G}\times_kX &  X &  Y \\} ;
\path[->,line width=1.0pt,font=\scriptsize]
(m-1-1) edge[transform canvas={yshift=0.5ex}] node[above] {$ a  $} (m-1-2)
(m-1-1) edge[transform canvas={yshift=-0.5ex}] node[below] {$ \mathrm{pr}_X $} (m-1-2)
(m-1-2) edge node[above] {$ q $} (m-1-3);
\end{tikzpicture}
\end{center}
is a cokernel in the category topological spaces.
\end{proof}
\noindent
Now we prove a series results concerning fpqc descent. For this we fix a $k$-scheme $Y$ with the trivial action of $\bd{G}$ and a $\bd{G}$-equivariant morphism $q:X\ra Y$. Let $g:Y'\ra Y$ be a morphism of $k$-schemes and consider the cartesian square
\begin{center}
\begin{tikzpicture}
[description/.style={fill=white,inner sep=2pt}]
\matrix (m) [matrix of math nodes, row sep=3em, column sep=3em,text height=1.5ex, text depth=0.25ex] 
{ X' &   X                           \\
    Y' &   Y                 \\} ;
\path[->,line width=1.0pt,font=\scriptsize]  
(m-1-1) edge node[auto] {$ g' $} (m-1-2)
(m-2-1) edge node[below] {$ g $} (m-2-2)
(m-1-1) edge node[left] {$ q' $} (m-2-1)
(m-1-2) edge node[auto] {$ q $} (m-2-2);
\end{tikzpicture}
\end{center}
of $k$-schemes. Note that $X'$ admits a unique action $a'$ of $\bd{G}$ such that the square above consists of $\bd{G}$-equivariant morphism (we consider $g$ as a $\bd{G}$-equivariant morphism between trivial $\bd{G}$-schemes).

\begin{fact}\label{fact:submersive_and_universally_submersive_descent_along_fpgc}
Suppose that $g$ is faithfully flat and quasi-compact. Assume that $q'$ is (universally) submersive. Then $q$ is (universally) submersive.
\end{fact}
\begin{proof}
It suffices to prove that submersive morphisms have descent property. This follows from the fact that $g$ (as faithfully flat and quasi-compact morphism) and $q'$ are submersive. Details are left for the reader.
\end{proof}

\begin{fact}\label{fact:surjection_on_kernel_pairs_descent}
Suppose that $g$ is faithfully flat and quasi-compact. Then the canonical morphism $X'\times_{Y'}X'\ra X\times_YX$ is faithfully flat and quasi-compact and there is the cartesian square
\begin{center}
\begin{tikzpicture}
[description/.style={fill=white,inner sep=2pt}]
\matrix (m) [matrix of math nodes, row sep=3em, column sep=3em,text height=1.5ex, text depth=0.25ex] 
{   \bd{G}\times_kX' &   \bd{G}\times_kX                           \\
    X'\times_{Y'}X' &   X\times_YX                 \\} ;
\path[->,line width=1.0pt,font=\scriptsize]  
(m-1-1) edge node[auto] {$  $} (m-1-2)
(m-2-1) edge node[below] {$  $} (m-2-2)
(m-1-1) edge node[left] {$  $} (m-2-1)
(m-1-2) edge node[auto] {$  $} (m-2-2);
\end{tikzpicture}
\end{center}
in which the left vertical arrow is induced by $\langle a', \mathrm{pr}_{X'}\rangle:\bd{G}\times_kX'\ra X'\times_kX'$, the right vertical arrow is induced by $\langle a, \mathrm{pr}_X\rangle:\bd{G}\times_kX\ra X\times_kX$ and the bottom horizontal morphism is the canonical morphism.  
\end{fact}
\begin{proof}
Note that squares
\begin{center}
\begin{tikzpicture}
[description/.style={fill=white,inner sep=2pt}]
\matrix (m) [matrix of math nodes, row sep=3em, column sep=3em,text height=1.5ex, text depth=0.25ex] 
{ X'\times_{Y'}X' &   X'\times_YX' & &  X'\times_YX' &   X\times_YX                           \\
    Y'           &   Y          & &  X'\times_k X' &   X\times_k X                 \\} ;
\path[->,line width=1.0pt,font=\scriptsize]  
(m-1-1) edge node[auto] {$  $} (m-1-2)
(m-2-1) edge node[below] {$ g $} (m-2-2)
(m-1-1) edge node[left] {$  $} (m-2-1)
(m-1-2) edge node[auto] {$  $} (m-2-2)
(m-1-4) edge node[auto] {$  $} (m-1-5)
(m-2-4) edge node[below] {$ g'\times_kg'  $} (m-2-5)
(m-1-4) edge node[left] {$  $} (m-2-4)
(m-1-5) edge node[auto] {$  $} (m-2-5);
\end{tikzpicture}
\end{center}
are cartesian. Since both $g$ and $g'\times_k g'$ are faithfully flat and quasi-compact, we derive that both morphisms $X'\times_{Y'}X'\ra X'\times_YX'$ and $X'\times_YX'\ra X\times_YX$ are faithfully flat and quasi-compact. Then their composition i.e. the canonical morphism $X'\times_{Y'}X'\ra X\times_YX$ is faithfully flat and quasi-compact.
\end{proof}
\noindent
Finally we need the following notion

\begin{definition}
Let $Y$ be a $k$-scheme with the trivial action of $\bd{G}$ and let $q:X\ra Y$ be a $\bd{G}$-equivariant morphism. Consider a pair
\begin{center}
\begin{tikzpicture}
[description/.style={fill=white,inner sep=2pt}]
\matrix (m) [matrix of math nodes, row sep=3em, column sep=3em,text height=1.5ex, text depth=0.25ex] 
{ q_*\cO_{X} & q_*\left(\mathrm{pr}_{X}\right)_*\cO_{\bd{G}\times_kX} = q_*a_*\cO_{\bd{G}\times_k X} \\} ;
\path[->,line width=1.0pt,font=\scriptsize]
(m-1-1) edge[transform canvas={yshift=0.5ex}] node[above] {$ q_*a^{\#}  $} (m-1-2)
(m-1-1) edge[transform canvas={yshift=-0.5ex}] node[below] {$ q_*\mathrm{pr}_X^{\#} $} (m-1-2);
\end{tikzpicture}
\end{center}
of morphisms of sheaves of rings on $Y$. Suppose that $q^{\#}:\cO_Y\ra q_*\cO_X$ is a kernel of this pair. Then \textit{$\cO_Y$ is the sheaf of $\bd{G}$-invariants for $q$}.
\end{definition}

\begin{proposition}\label{proposition:faithfully_flat_descent_for_invariants}
Suppose that $g$ is faitfully flat and quasi-compact. Assume that $q'$ is quasi-compact, semiseparated and $\cO_{Y'}$ is the sheaf of $\bd{G}$-invariants for $q'$. Then $\cO_Y$ is the sheaf of $\bd{G}$-invariants for $q$.
\end{proposition}
\begin{proof}
We denote by $a'$ the action of $\bd{G}$ on $X'$. First note that $q$ is semiseparated and quasi-compact morphism as these classes of morphisms admit descent along quasi-compact and faithfully flat morphisms. Since $q$ is quasi-compact, semiseparated and $g$ is flat, we derive that for every quasi-coherent sheaf $\cF$ on $X$ the canonical morphism $q'_*g'^*\cF \ra  g^*q_*\cF$ is an isomorphism. Thus the diagram
\begin{center}
\begin{tikzpicture}
[description/.style={fill=white,inner sep=2pt}]
\matrix (m) [matrix of math nodes, row sep=3em, column sep=3em,text height=1.5ex, text depth=0.25ex] 
{ \cO_{Y'} & q'_*\cO_{X'} & q'_*\left(\mathrm{pr}_{X'}\right)_*\cO_{\bd{G}\times_kX'} = q'_*a'_*\cO_{\bd{G}\times_k X'} \\} ;
\path[->,line width=1.0pt,font=\scriptsize]
(m-1-2) edge[transform canvas={yshift=0.5ex}] node[above] {$ q'_*{a'}^{\#}  $} (m-1-3)
(m-1-2) edge[transform canvas={yshift=-0.5ex}] node[below] {$ q'_*\mathrm{pr}_{X'}^{\#} $} (m-1-3)
(m-1-1) edge node[above] {$ q^{\#} $} (m-1-2);
\end{tikzpicture}
\end{center}
is isomorphic to the diagram
\begin{center}
\begin{tikzpicture}
[description/.style={fill=white,inner sep=2pt}]
\matrix (m) [matrix of math nodes, row sep=3em, column sep=3em,text height=1.5ex, text depth=0.25ex] 
{ g^*\cO_Y & g^*\left(q_*\cO_X\right) & g^*\left(q_*\left(\mathrm{pr}_X\right)_*\cO_{\bd{G}\times_kX}\right) = g^*\left(q_*a_*\cO_{\bd{G}\times_k X}\right) \\} ;
\path[->,line width=1.0pt,font=\scriptsize]
(m-1-2) edge[transform canvas={yshift=0.5ex}] node[above] {$ g^*q_*a^{\#}  $} (m-1-3)
(m-1-2) edge[transform canvas={yshift=-0.5ex}] node[below] {$ g^*q_*\mathrm{pr}_X^{\#} $} (m-1-3)
(m-1-1) edge node[above] {$ g^*q^{\#} $} (m-1-2);
\end{tikzpicture}
\end{center}
Since $\cO_{Y'}$ is the sheaf of $\bd{G}$-invariants for $q'$, the first diagram is a kernel diagram. Hence the second is a kernel diagram. According to the fact that $g$ is faithfully flat we deduce that the diagram
\begin{center}
\begin{tikzpicture}
[description/.style={fill=white,inner sep=2pt}]
\matrix (m) [matrix of math nodes, row sep=3em, column sep=3em,text height=1.5ex, text depth=0.25ex] 
{ \cO_{Y} & q_*\cO_{X} & q_*\left(\mathrm{pr}_{X}\right)_*\cO_{\bd{G}\times_kX} = q_*a_*\cO_{\bd{G}\times_k X} \\} ;
\path[->,line width=1.0pt,font=\scriptsize]
(m-1-2) edge[transform canvas={yshift=0.5ex}] node[above] {$ q_*{a}^{\#}  $} (m-1-3)
(m-1-2) edge[transform canvas={yshift=-0.5ex}] node[below] {$ q_*\mathrm{pr}_{X}^{\#} $} (m-1-3)
(m-1-1) edge node[above] {$ q^{\#} $} (m-1-2);
\end{tikzpicture}
\end{center}
is also a kernel diagram. Thus $\cO_Y$ is the sheaf of $\bd{G}$-invariants for $q$.
\end{proof}

\section{Categorical and geometric quotients}

\begin{definition}
Let $Y$ be a $k$-scheme with the trivial action of $\bd{G}$ and let $q:X\ra Y$ be a $\bd{G}$-equivariant morphism. Suppose that the following conditions hold.
\begin{enumerate}[label=\textbf{(\arabic*)}, leftmargin=3.0em]
\item $q$ is submersive.
\item The morphism $\bd{G}\times_kX\ra X\times_YX$ induced by $\langle a, \mathrm{pr}_x\rangle:\bd{G}\times_kX \ra X\times_kX$ is surjective.
\item $\cO_Y$ is the sheaf of $\bd{G}$-invariant for $q$.
\end{enumerate}
Then $q$ is \textit{a geometric quotient of $X$}.
\end{definition}

\begin{corollary}\label{corollary:geometric_quotient_is_ringed_space_quotient}
Let $q$ be a geometric quotient of $X$. Then the diagram
\begin{center}
\begin{tikzpicture}
[description/.style={fill=white,inner sep=2pt}]
\matrix (m) [matrix of math nodes, row sep=3em, column sep=3em,text height=1.5ex, text depth=0.25ex] 
{\bd{G}\times_kX &  X & Y\\} ;
\path[->,line width=1.0pt,font=\scriptsize]
(m-1-1) edge[transform canvas={yshift=0.5ex}] node[above] {$ a  $} (m-1-2)
(m-1-1) edge[transform canvas={yshift=-0.5ex}] node[below] {$ \mathrm{pr}_X $} (m-1-2)
(m-1-2) edge node[above] {$ q $} (m-1-3);
\end{tikzpicture}
\end{center}
is a cokernel in the category of ringed spaces.
\end{corollary}
\begin{proof}
Due to the fact that $\cO_Y$ is the sheaf of $\bd{G}$-invariants for $q$ it suffices to prove that
\begin{center}
\begin{tikzpicture}
[description/.style={fill=white,inner sep=2pt}]
\matrix (m) [matrix of math nodes, row sep=3em, column sep=3em,text height=1.5ex, text depth=0.25ex] 
{\bd{G}\times_kX &  X & Y\\} ;
\path[->,line width=1.0pt,font=\scriptsize]
(m-1-1) edge[transform canvas={yshift=0.5ex}] node[above] {$ a  $} (m-1-2)
(m-1-1) edge[transform canvas={yshift=-0.5ex}] node[below] {$ \mathrm{pr}_X $} (m-1-2)
(m-1-2) edge node[above] {$ q $} (m-1-3);
\end{tikzpicture}
\end{center}
is the cokernel in the category of topological spaces. This follows from Proposition \ref{proposition:topological_group_quotient_is_implied_by_submersive_and_kernel_pair}.
\end{proof}

\begin{definition}
Let $q:X\ra Y$ be a morphism of $k$-schemes such that the diagram
\begin{center}
\begin{tikzpicture}
[description/.style={fill=white,inner sep=2pt}]
\matrix (m) [matrix of math nodes, row sep=3em, column sep=3em,text height=1.5ex, text depth=0.25ex] 
{\bd{G}\times_kX &  X & Y\\} ;
\path[->,line width=1.0pt,font=\scriptsize]
(m-1-1) edge[transform canvas={yshift=0.5ex}] node[above] {$ a  $} (m-1-2)
(m-1-1) edge[transform canvas={yshift=-0.5ex}] node[below] {$ \mathrm{pr}_X $} (m-1-2)
(m-1-2) edge node[above] {$ q $} (m-1-3);
\end{tikzpicture}
\end{center}
is a cokernel in the category of $k$-schemes. Then $q:X\ra Y$ is \textit{a categorical quotient of $X$}.
\end{definition}

\begin{fact}\label{fact:geometric_quotients_are_categorical}
Every geometric quotient is categorical.
\end{fact}
\begin{proof}
Categorical quotient is a cokernel in the category of $k$-schemes. On the other hand geometric quotient is a cokernel in the category of locally ringed spaces and hence it also satisfies cokernel property in its full subcategory of $k$-schemes. Thus every geometric quotient is categorical.
\end{proof}
\noindent
Let $q:X\ra Y$ be a morphism of $k$-schemes such that $q\cdot \mathrm{pr}_X = q\cdot a$. For a morphism $g:Y'\ra Y$ of $k$-schemes consider the cartesian square
\begin{center}
\begin{tikzpicture}
[description/.style={fill=white,inner sep=2pt}]
\matrix (m) [matrix of math nodes, row sep=2em, column sep=2em,text height=1.5ex, text depth=0.25ex] 
{ X' &    X                           \\
    Y' &   Y                 \\} ;
\path[->,line width=1.0pt,font=\scriptsize]  
(m-1-1) edge node[auto] {$ g'$} (m-1-2)
(m-2-1) edge node[below] {$ g$} (m-2-2)
(m-1-1) edge node[left] {$q' $} (m-2-1)
(m-1-2) edge node[auto] {$ q$} (m-2-2);
\end{tikzpicture}
\end{center} 
Then there exists a unique action $a':\bd{G} \times_kX' \ra X'$ of $\bd{G}$ on $X'$ such that the square above consists of $\bd{G}$-equivariant morphism (we consider $Y,Y'$ as $\bd{G}$-schemes equipped with trivial $\bd{G}$-actions). Keeping this in mind we have the following.

\begin{definition}
A morphism $q:X\ra Y$ is \textit{a uniform categorical (geometric) quotient of $X$} if for every flat morphism $g:Y'\ra Y$ its base change $q':X'\ra Y'$ is a categorical (geometric) quotient of $X'$. 
\end{definition}

\begin{definition}
A morphism $q:X\ra Y$ is \textit{a universal categorical (geometric) quotient of $X$} if for every morphism $g:Y'\ra Y$ its base change $q':X'\ra Y'$ is a categorical (geometric) quotient of $X'$. 
\end{definition}

\begin{corollary}\label{corollary:geometric_quotients_descent_along_fpqc}
Let $g:Y'\ra Y$ be a faithfully flat and quasi-compact morphism. Suppose that $q'$ is a geometric quotient, then $q$ is a geometric quotient.
\end{corollary}
\begin{proof}
This follows from Facts \ref{fact:submersive_and_universally_submersive_descent_along_fpgc}, \ref{fact:surjection_on_kernel_pairs_descent} and Proposition \ref{proposition:faithfully_flat_descent_for_invariants}.
\end{proof}
\noindent
In the next result we give a simple example of a universal geometric quotient.

\begin{proposition}\label{proposition:trivial_bundle_is_universal_geometric_quotient}
Suppose that $\bd{G}$ is a quasi-compact group scheme over $k$. Let $Y$ be a $k$-scheme and consider $\bd{G}\times_kY$ with the action of $\bd{G}$ induced by the regular action on the left factor. Then $\mathrm{pr}_Y:\bd{G}\times_kY\ra Y$ is a universal geometric quotient. 
\end{proposition}
\begin{proof}
Clearly $\mathrm{pr}_Y$ is univerally submersive (it is even universally open). Let $\mu:\bd{G}\times_k\bd{G}\ra \bd{G}$ be the multiplication morphism and let $\pi_{23}:\bd{G}\times_k\bd{G}\times Y\ra \bd{G}\times_kY$ be the projection on the last two factors. Then the morphism 
$$\bd{G}\times_k\bd{G}\times_kY\ra \left(\bd{G}\times_kY\right)\times_Y\left(\bd{G}\times_kY\right) = \bd{G}\times_k\bd{G}\times_kY$$
induced by $\langle \mu\times_k1_Y, \pi_{23}\rangle:\bd{G}\times_k\bd{G}\times_kY\ra \left(\bd{G}\times_kY\right)\times_k\left(\bd{G}\times_kY\right)$ is an isomorphism. We show that $\cO_Y$ is the sheaf of $\bd{G}$-invariants for $\mathrm{pr}_Y$. For this pick an affine open subset $V$ of $Y$. It suffices to check that the diagram
\begin{center}
\begin{tikzpicture}
[description/.style={fill=white,inner sep=2pt}]
\matrix (m) [matrix of math nodes, row sep=3em, column sep=4em,text height=1.5ex, text depth=0.25ex] 
{ \Gamma(V,\cO_{Y}) & \Gamma\left(\bd{G}\times_kV, \cO_{\bd{G}\times_kY}\right) & \Gamma\left(\bd{G}\times_k\bd{G}\times_kV, \cO_{\bd{G}\times_k \bd{G}\times_kY}\right) \\} ;
\path[->,line width=1.0pt,font=\scriptsize]
(m-1-2) edge[transform canvas={yshift=0.5ex}] node[above] {$ \left(\mu\times_k1_Y\right)^{\#} $} (m-1-3)
(m-1-2) edge[transform canvas={yshift=-0.5ex}] node[below] {$ \pi_{23}^{\#} $} (m-1-3)
(m-1-1) edge node[above] {$ \mathrm{pr}_Y^{\#} $} (m-1-2);
\end{tikzpicture}
\end{center}
is a kernel. Since $\bd{G}$ is quasi-compact and separated (every group $k$-scheme is separated), we derive that the diagram above is isomorphic with
\begin{center}
\begin{tikzpicture}
[description/.style={fill=white,inner sep=2pt}]
\matrix (m) [matrix of math nodes, row sep=3em, column sep=6em,text height=1.5ex, text depth=0.25ex] 
{ \Gamma(V,\cO_{Y}) & \Gamma\left(\bd{G},\cO_{\bd{G}}\right)\otimes_k\Gamma\left(V,\cO_Y\right) & \Gamma\left(\bd{G},\cO_{\bd{G}}\right)\otimes_k\Gamma\left(\bd{G},\cO_{\bd{G}}\right)\otimes_k\Gamma\left(V,\cO_Y\right) \\} ;
\path[->,line width=1.0pt,font=\scriptsize]
(m-1-2) edge[transform canvas={yshift=0.5ex}] node[above] {$ \chi\otimes f \mapsto \mu^{\#}(\chi)\otimes f $} (m-1-3)
(m-1-2) edge[transform canvas={yshift=-0.5ex}] node[below] {$ \chi\otimes f \mapsto 1\otimes \chi\otimes f $} (m-1-3)
(m-1-1) edge node[above] {$ f\mapsto 1\otimes f $} (m-1-2);
\end{tikzpicture}
\end{center}
Thus the first diagram is the kernel diagram if $f\mapsto 1\otimes f$ induces an isomorphism of $\Gamma(V,\cO_Y)$ with subspace of $\Gamma\left(\bd{G},\cO_{\bd{G}}\right)\otimes_k\Gamma\left(V,\cO_Y\right)$ given by formula
$$\big\{ \chi \in \Gamma\left(\bd{G},\cO_{\bd{G}}\right)\big|\mu^{\#}(\chi) = 1 \otimes \chi\big\}\otimes_k\Gamma\left(V,\cO_Y\right)$$
Hence it suffices to prove that 
$$\big\{ \chi \in \Gamma\left(\bd{G},\cO_{\bd{G}}\right)\big|\mu^{\#}(\chi) = 1 \otimes \chi\big\} = \mbox{constant functions on $\bd{G}$}$$
For this pick a $k$-algebra $A$ and let $g:\Spec A\ra \bd{G}$ be an $A$-point. Next let $e:\Spec A \ra \bd{G}$ be an $A$-point of $\bd{G}$ which corresponds to the identity element of $\bd{G}$. Suppose that a regular function $\chi$ in $\bd{G}$ satisfies $\mu^{\#}(\chi) = 1\otimes \chi$. Then
$$g^{\#}(\chi) = \langle g, e\rangle^{\#}\mu^{\#}(\chi) =  \langle g, e\rangle^{\#}(1\otimes \chi) = e^{\#}(\chi)$$
Recall that $e$ is given by the composition of the structural morphism $\Spec A \ra \Spec k$ and the $k$-point $\Spec k\ra \bd{G}$ determined by the identity of $\bd{G}$. Thus $g^{\#}(\chi)$ is an element of $k$. Since this follows for every $g:\Spec A\ra \bd{G}$, we derive that $\chi$ is a constant function. This completes the proof of our claim that 
\begin{center}
\begin{tikzpicture}
[description/.style={fill=white,inner sep=2pt}]
\matrix (m) [matrix of math nodes, row sep=3em, column sep=4em,text height=1.5ex, text depth=0.25ex] 
{ \Gamma(V,\cO_{Y}) & \Gamma\left(\bd{G}\times_kV, \cO_{\bd{G}\times_kY}\right) & \Gamma\left(\bd{G}\times_k\bd{G}\times_kV, \cO_{\bd{G}\times_k \bd{G}\times_kY}\right) \\} ;
\path[->,line width=1.0pt,font=\scriptsize]
(m-1-2) edge[transform canvas={yshift=0.5ex}] node[above] {$ \left(\mu\times_k1_Y\right)^{\#} $} (m-1-3)
(m-1-2) edge[transform canvas={yshift=-0.5ex}] node[below] {$ \pi_{23}^{\#} $} (m-1-3)
(m-1-1) edge node[above] {$ \mathrm{pr}_Y^{\#} $} (m-1-2);
\end{tikzpicture}
\end{center}
is the kernel diagram and hence $\cO_Y$ is the sheaf of $\bd{G}$-invariants for $\mathrm{pr}_Y$. Therefore, we proved that $\mathrm{pr}_Y$ is a geometric quotient of $\bd{G}\times_kY$. Consider any morphism $Y' \ra Y$. Then base change of $\mathrm{pr}_Y$ along this morphism is $\mathrm{pr}_{Y'}$. We conclude that $\mathrm{pr}_Y$ is a universal geometric quotient for $\bd{G}\times_kY$. 
\end{proof}
    
\section{Geometric quotients of separated actions}

\begin{definition}
The action of $\bd{G}$ on $X$ is \textit{separated} if the morphism $\langle a, \mathrm{pr_X} \rangle:\bd{G}\times_kX\ra X\times_kX$ has closed set-theoretic image.
\end{definition}

\begin{theorem}\label{theorem:separatedness_of_universally_submersive_geometric_quotients_of_separated_actions}
Let $q:X\ra Y$ be a geometric quotient of $X$. Assume that $q$ is universally submersive. Then the following assertions are equivalent.
\begin{enumerate}[label=\emph{\textbf{(\roman*)}}, leftmargin=3.0em]
\item The action of $\bd{G}$ on $X$ is separated.
\item $Y$ is separated.
\end{enumerate}
\end{theorem}
\begin{proof}
We have a cartesian square
\begin{center}
\begin{tikzpicture}
[description/.style={fill=white,inner sep=2pt}]
\matrix (m) [matrix of math nodes, row sep=3em, column sep=3em,text height=1.5ex, text depth=0.25ex] 
{ X\times_Y X &    X \times_k X                           \\
    Y &   Y \times_k Y                 \\} ;
\path[right hook->,line width=1.0pt,font=\scriptsize]  
(m-1-1) edge node[auto] {$ $} (m-1-2)
(m-2-1) edge node[below] {$\Delta_Y $} (m-2-2);
\path[->,line width=1.0pt,font=\scriptsize]  
(m-1-1) edge node[left] {$ $} (m-2-1)
(m-1-2) edge node[auto] {$ q\times_k q$} (m-2-2);
\end{tikzpicture}
\end{center}
It follows that $X\times_YX\hookrightarrow X\times_kX$ is a locally closed immersion. Since $q$ is a geometric quotient, we derive  that $\langle a, \mathrm{pr}_X \rangle$ factors as a surjective morphism $\bd{G} \times_k X\twoheadrightarrow X\times_YX$ followed by the immersion $X\times_YX\hookrightarrow X\times_kX$. Thus the action of $\bd{G}$ on $X$ is separated if and only if $X\times_YX$ is a closed subscheme of $X\times_kX$. Since $q$ is universally submersive, we derive that $q\times_kq$ is submersive. As the square above is cartesian we derive that $\Delta_Y(Y) \subseteq Y\times_kY$ is closed if and only if $X\times_YX\subseteq X\times_kX$ is closed. Therefore, $Y$ is separated if and only if the action of $\bd{G}$ on $X$ is separated.
\end{proof}

\section{Geometric quotients of free actions and principal bundles}

\begin{definition}
The action of $\bd{G}$ on $X$ is \textit{free} if the morphism $\langle a, \mathrm{pr_X} \rangle:\bd{G}\times_kX\ra X\times_kX$ is a closed immersion.
\end{definition}

\begin{definition}
Let $x$ be a $k$-point of $X$. Suppose that \textit{the orbit morphism $\bd{G}\ra X$ of $x$} given by the composition
\begin{center}
\begin{tikzpicture}
[description/.style={fill=white,inner sep=2pt}]
\matrix (m) [matrix of math nodes, row sep=3em, column sep=2.5em,text height=1.5ex, text depth=0.25ex] 
{ \bd{G} = \bd{G}\times_k\Spec k & & \bd{G}\times_kX & X                        \\} ;
\path[right hook->,line width=1.0pt,font=\scriptsize]  
(m-1-1) edge node[auto] {$\mathrm{induced\,by\,}x  $} (m-1-3);
\path[->,line width=1.0pt,font=\scriptsize]  
(m-1-3) edge node[auto] {$  $} (m-1-4);
\end{tikzpicture}
\end{center}
is a closed immersion. Then the action of $\bd{G}$ on $X$ has \textit{a closed free orbit at $x$}.
\end{definition}

\begin{fact}\label{fact:all_k_points_have_free_closed_orbit_for_free_actions}
If the action of $\bd{G}$ on $X$ is free, then every $k$-point of $X$ has a closed free orbit.
\end{fact}
\noindent
The following result states that over special type of local complete noetherian $k$-algebras geometric quotients of free actions correspond to trivial $\bd{G}$-bundles. 

\begin{theorem}\label{theorem:free_actions_over_complete_local_rings_are_trivial_bundles}
Suppose that $k$ is an algebraically closed field and $\bd{G}$ is a smooth algebraic group over $k$. Let $q:X\ra Y$ be a geometric quotient locally of finite type and let $Y$ be the spectrum of a complete local noetherian $k$-algebra such that the residue field of the closed point of $Y$ is $k$. Then the following assertions hold.
\begin{enumerate}[label=\emph{\textbf{(\arabic*)}}, leftmargin=3.0em]
\item If $x$ is a $k$-point of $X$ which has a closed free orbit, then there exists a $\bd{G}$-equivariant, {\'e}tale and surjective morphism $f:\bd{G}\times_k Y \ra X$ such that the triangle
\begin{center}
\begin{tikzpicture}
[description/.style={fill=white,inner sep=2pt}]
\matrix (m) [matrix of math nodes, row sep=2.5em, column sep=1em,text height=1.5ex, text depth=0.25ex] 
{ \bd{G}\times_k Y &   & X \\
                   & Y &    \\} ;
\path[->,line width=1.0pt,font=\scriptsize]  
(m-1-1) edge node[auto] {$ f  $} (m-1-3)
(m-1-1) edge node[below = 4pt, left = 1pt] {$ \mathrm{pr}_{Y} $} (m-2-2)
(m-1-3) edge node[below = 4pt, right = 1pt] {$ q $} (m-2-2);
\end{tikzpicture}
\end{center}
is commutative and the morphism
\begin{center}
\begin{tikzpicture}
[description/.style={fill=white,inner sep=2pt}]
\matrix (m) [matrix of math nodes, row sep=3em, column sep=3em,text height=1.5ex, text depth=0.25ex] 
{ Y = \Spec k \times_k Y & \bd{G}\times_kY  & X                        \\} ;
\path[right hook->,line width=1.0pt,font=\scriptsize]  
(m-1-1) edge node[auto] {$e\times_k1_Y  $} (m-1-2);
\path[->,line width=1.0pt,font=\scriptsize]  
(m-1-2) edge node[auto] {$ f  $} (m-1-3);
\end{tikzpicture}
\end{center}
is a section of $q$.
\item If the action of $\bd{G}$ on $X$ is free, then $f$ is an isomorphism.
\end{enumerate}
\end{theorem}
\noindent
The proof relies on two algebraic lemmas. The first describe free actions in context of complete rings (it is {\cite[lemma on page 18]{mumford1994geometric}}) and the second is a version of Hensel's lemma.

\begin{lemma}\label{lemma:free_actions_in_formal_geometry}
Let $(R,\ideal{m},k)$ be a complete local noetherian $k$-algebra and let $\sigma:R\ra R[[x_1,...,x_n]]$ be a local morphism into a ring of formal power series over $R$. Assume that the composition
\begin{center}
\begin{tikzpicture}
[description/.style={fill=white,inner sep=2pt}]
\matrix (m) [matrix of math nodes, row sep=3em, column sep=3em,text height=1.5ex, text depth=0.25ex] 
{ R & R[[x_1,...,x_n]] & & & R                       \\} ;
\path[->,line width=1.0pt,font=\scriptsize]  
(m-1-1) edge node[auto] {$ \sigma  $} (m-1-2)
(m-1-2) edge node[auto] {$ f\mapsto f\,\mathrm{mod}\,(x_1,...,x_n)  $} (m-1-5);
\end{tikzpicture}
\end{center}
is the identity and the composition
\begin{center}
\begin{tikzpicture}
[description/.style={fill=white,inner sep=2pt}]
\matrix (m) [matrix of math nodes, row sep=3em, column sep=3em,text height=1.5ex, text depth=0.25ex] 
{ R & R[[x_1,...,x_n]] & & \left(R/\ideal{m}\right)[[x_1,...,x_n]] = k[[x_1,...,x_n]]                      \\} ;
\path[->,line width=1.0pt,font=\scriptsize]  
(m-1-1) edge node[auto] {$ \sigma  $} (m-1-2)
(m-1-2) edge node[auto] {$ f\mapsto f\,\mathrm{mod}\,\ideal{m}  $} (m-1-4);
\end{tikzpicture}
\end{center}
is surjective. Consider elements $y_1,...,y_n$ of $R$ such that $\sigma(y_i)\,\mathrm{mod}\,\ideal{m} = x_i$ for $i=1,...,n$. Then the composition
\begin{center}
\begin{tikzpicture}
[description/.style={fill=white,inner sep=2pt}]
\matrix (m) [matrix of math nodes, row sep=3.5em, column sep=3em,text height=1.5ex, text depth=0.25ex] 
{ R & R[[x_1,...,x_n]] & & & \left(R/(y_1,...,y_n)\right)[[x_1,...,x_n]]                       \\} ;
\path[->,line width=1.0pt,font=\scriptsize]  
(m-1-1) edge node[auto] {$ \sigma  $} (m-1-2)
(m-1-2) edge node[auto] {$ f\mapsto f\,\mathrm{mod}\,(y_1,...,y_n)  $} (m-1-5);
\end{tikzpicture}
\end{center}
is an isomorphism.
\end{lemma}
\begin{proof}[Proof of the lemma]
For convienience let $\phi$ denote the morphism given by the rule $r\mapsto \sigma(r)\,\mathrm{mod}\,(y_1,...,y_n)$. Also denote $R/(y_1,...,y_n)$ by $S$. According to assumptions we have
$$\sigma(y_i) = x_i + y_i + \sum_{j=1}^nx_j\cdot \ideal{m}[[x_1,...,x_n]]$$
for each $i$. Thus $\phi(y_i) = \sum_{j=1}^nf_{ij}\cdot x_j$
where $f_{ij}\in S$ are elements such that the matrix $\big[f_{ij}\big]_{1\leq i,j\leq n}$ is invertible in $S$. Hence
$$S[[x_1,...,x_n]] = S[[\phi(y_1),...,\phi(y_n)]]$$
and $\phi$ composed with $S[[\phi(y_1),...,\phi(y_n)]] \twoheadrightarrow S$ is the quotient morphism $R \twoheadrightarrow S$. From this observations we derive that $\phi$ is surjective. It remains to prove that it is injective. Consider $z$ in $R$ such that $\phi(z) = 0$. Suppose that $z \in (y_1,...,y_n)^m$ for some $m\in \NN$. Write
$$z = \sum_{\alpha \in \Lambda}c_{\alpha}\cdot y_1^{\alpha_1}...y_n^{\alpha_n}$$
for some $c_{\alpha}\in R$ where $\Lambda = \{\alpha \in \NN^n\,|\,\alpha_1+...+\alpha_n = m\}$. Hence
$$0 = \phi(z) = \sum_{\alpha \in \Lambda}\phi(c_{\alpha})\cdot \phi(y_1)^{\alpha_1}...\phi(y_n)^{\alpha_n}$$
Thus $\phi(c_{\alpha}) \in \left(\phi(y_1),...,\phi(y_n)\right)$ for every $\alpha \in \Lambda$. Since $\phi$ composed with $S[[\phi(y_1),...,\phi(y_n)]] \twoheadrightarrow S$ is the quotient morphism $R \twoheadrightarrow S$, we derive that 
$$c_{\alpha}\,\mathrm{mod}\,(y_1,...,y_n) = \phi(c_{\alpha})\,\mathrm{mod}\,\left(\phi(y_1),...,\phi(y_n)\right) = 0$$
for every $\alpha \in \Lambda$. Thus $c_{\alpha}\in (y_1,...,y_n)$ for every $\alpha \in \Lambda$, which implies that $z \in (y_1,...,y_n)^{m+1}$. Thus we proved that 
$$\mbox{$\phi(z) = 0$ and $z \in (y_1,...,y_n)^m$}\,\Rightarrow\,z \in (y_1,...,y_n)^{m+1}$$
By $\ideal{m}$-adic completeness of $R$ this implies that $\phi(z) = 0$ if and only if $z = 0$. Hence $\phi$ is also injective.
\end{proof}

\begin{lemma}\label{lemma:Hensels_lemma}
Let $(R,\ideal{m})$ be a complete local noetherian ring and let $R\ra S$ be a local morphism into a local noetherian ring. Suppose that there exists a finitely generated $R$-submodule $N$ of $S$ such that
$$S = N + \ideal{m}S$$
Then $S = N$.
\end{lemma}
\begin{proof}[Proof of the lemma]
Pick $s$ in $S$. Since $S = N + \ideal{m}S$, there exists a sequence $\{x_n\}_{n\in \NN}$ such that $x_n\in \ideal{m}^{n}N$ and 
$$s - \sum_{i\leq n}x_i \in \ideal{m}^{n+1}S$$
According to the assumption that $(R,\ideal{m})$ is complete with respect to $\ideal{m}$-adic topology and $N$ is finitely generated over $R$, we deduce that $N$ is complete with respect to $\ideal{m}$-adic topology. Hence there exists a unique element $x$ in $N$ such that
$$x = \sum_{n\in \NN}x_n$$
where above series is convergent with respect to $\ideal{m}$-adic topology. Note also that
$$x - \sum_{i\leq n}x_i\in \ideal{m}^{n+1}N$$
for every $n\in \NN$. Thus we have
$$s - x = \left(s - \sum_{i\leq n}x_i\right) - \left(x - \sum_{i\leq n}x_i\right) \in \ideal{m}^{n+1}S + \ideal{m}^{n+1}N = \ideal{m}^{n+1}S$$
for every $n\in \NN$. Hence
$$x - s \in \bigcap_{n\in \NN}\ideal{m}^nS$$
Since $R\ra S$ is local morphism and $S$ is a local ring, we deduce that $\ideal{m}S$ is contained in the maximal ideal of $S$. By assumptions $S$ is noetherian. Therefore, $S$ is separated with respect to $\ideal{m}$-adic topology. This implies that
$$0 = \bigcap_{n\in \NN}\ideal{m}^nS$$
Thus $s - x = 0$ and we infer that $s$ is an element of $N$. This completes the proof that $S = N$.
\end{proof}
\noindent
In what follows we shall denote by $\bd{G}x$ the closed subscheme determined by the orbit morphism $\bd{G}\ra X$ of a $k$-point $x$ of $X$ which has a closed free orbit. For readers convienience we include the following lemmas, which have topological content.

\begin{lemma}\label{lemma:fiber_over_closed_point_is_orbit}
Let $q:X\ra Y$ be a geometric quotient and assume that $Y$ is the spectrum of a local $k$-algebra such that the residue field of the closed point $o$ of $Y$ is $k$. Let $x$ be a $k$-point of $X$ with free closed orbit, then $q^{-1}(o) = \bd{G}x$ as closed subschemes of $X$. 
\end{lemma}
\begin{proof}[Proof of the lemma]
Morphism $q$ induces the morphism of residue fields $k(q(x)) \hookrightarrow k(x) = k$ over $k$. This implies that $k(q(x)) = k$ and hence $q(x)$ is a $k$-point of $Y$. Note that $o$ is the unique $k$-point of $Y$. Thus $q(x) = o$. Clearly $q^{-1}(o)$ is a closed $\bd{G}$-stable subscheme of $X$ (it is the preimage of $o$ under $\bd{G}$-equivariant $q$), that contains $x$. Since $\bd{G}x$ is the smallest closed $\bd{G}$-stable subscheme of $X$ containing $x$, we deduce that $\bd{G}x\subseteq q^{-1}(o)$ scheme-theoretically. Consider the pair of arrows
\begin{center}
\begin{tikzpicture}
[description/.style={fill=white,inner sep=2pt}]
\matrix (m) [matrix of math nodes, row sep=3em, column sep=3em,text height=1.5ex, text depth=0.25ex] 
{ \bd{G}\times_kX &  X \\} ;
\path[->,line width=1.0pt,font=\scriptsize]
(m-1-1) edge[transform canvas={yshift=0.5ex}] node[above] {$ a  $} (m-1-2)
(m-1-1) edge[transform canvas={yshift=-0.5ex}] node[below] {$ \mathrm{pr}_X $} (m-1-2);
\end{tikzpicture}
\end{center}
Passing to functors of points we obtain that $a^{-1}\left(\bd{G}x\right) = \mathrm{pr}_X\left(\bd{G}.x\right)$. Since $q$ is the cokernel of the pair $(a,\mathrm{pr}_X)$ in the category of topological spaces, we deduce that there exists a closed subset $Z$ of $Y$ such that $q^{-1}(Z) = \bd{G}x$. Clearly $o\in Z$ and hence $q^{-1}(o) \subseteq \bd{G}x$ set-theoretically. On the other hand above we proved that $\bd{G}x\subseteq q^{-1}(o)$ scheme-theoretically. This can only happen if $q^{-1}(o) = \bd{G}x$ as closed subschemes of $X$.
\end{proof}

\begin{lemma}\label{lemma:open_and_stable_with_k_point_are_entire}
Let $q:X\ra Y$ be a geometric quotient and assume that $Y$ is the spectrum of a local $k$-algebra such that the residue field of the closed point $o$ of $Y$ is $k$. Let $U$ be an open $\bd{G}$-stable subset of $X$ which contain a $k$-point. Then $U = X$. 
\end{lemma}
\begin{proof}[Proof of the lemma]
Consider the pair of arrows
\begin{center}
\begin{tikzpicture}
[description/.style={fill=white,inner sep=2pt}]
\matrix (m) [matrix of math nodes, row sep=3em, column sep=3em,text height=1.5ex, text depth=0.25ex] 
{ \bd{G}\times_kX &  X \\} ;
\path[->,line width=1.0pt,font=\scriptsize]
(m-1-1) edge[transform canvas={yshift=0.5ex}] node[above] {$ a  $} (m-1-2)
(m-1-1) edge[transform canvas={yshift=-0.5ex}] node[below] {$ \mathrm{pr}_X $} (m-1-2);
\end{tikzpicture}
\end{center}
Since $U$ is $\bd{G}$-stable open subset of $X$, we derive that $\mathrm{pr}_X^{-1}(U) = a^{-1}(U)$. Next by definition $q$ is the cokernel of the above pair in the category of topological spaces. Hence there exists an open subset $V$ of $Y$ such that $U = q^{-1}(V)$. Since $U$ contains a $k$-point of $X$, we deduce as in Lemma \ref{lemma:fiber_over_closed_point_is_orbit} that $o\in V$. Thus $V = Y$ and finally $U = q^{-1}(V) = X$.  
\end{proof}

\begin{proof}[Proof of the theorem]
We first prove \textbf{(1)}. Denote by $o$ the closed point of $Y$. Assume that $x$ is a $k$-point of $X$ which has a closed free orbit. Consider the surjective morphism $\cO_{X,x}\twoheadrightarrow \cO_{\bd{G},e}$ induced by the orbit morphism $\bd{G}\hookrightarrow X$ of $x$. Since $\bd{G}$ is smooth over $k$, the ring $\cO_{\bd{G},e}$ is regular. Pick a system of parameters $x_1,...,x_n$ of $\cO_{\bd{G},e}$ and let $y_1,...,y_n$ be elements of $\cO_{X,x}$ such that $y_i$ is send to $x_i$ by the morphism $\cO_{X,x}\twoheadrightarrow \cO_{\bd{G},e}$ for $1\leq i\leq n$. Define $S$ to be the quotient ring $\cO_{X,x}/(y_1,...,y_n)$. The morphism $q$ induces the morphism $q^{\#}:\cO_{Y,o} \ra \cO_{X,x}$ and hence the morphism $\cO_{Y,o}\ra S$. By Lemma \ref{lemma:fiber_over_closed_point_is_orbit} we have
$$S/\ideal{m}_oS = k$$
where $\ideal{m}_o$ is the maximal ideal of $\cO_{Y,o}$. According to Lemma \ref{lemma:Hensels_lemma} we derive that $\cO_{Y,o}\ra S$ is surjective. Let $f:\bd{G}\times_k\Spec S\ra X$ be the unique $\bd{G}$-equivariant morphism induced by the surjection $\cO_{X,x}\twoheadrightarrow S$. We have a commutative square
\begin{center}
\begin{tikzpicture}
[description/.style={fill=white,inner sep=2pt}]
\matrix (m) [matrix of math nodes, row sep=3em, column sep=3em,text height=1.5ex, text depth=0.25ex] 
{ \bd{G}\times_k\Spec S &    X                           \\
    \Spec S &   Y                 \\} ;
\path[->,line width=1.0pt,font=\scriptsize]  
(m-1-1) edge node[above] {$ f $} (m-1-2)
(m-1-1) edge node[left] {$ \mathrm{pr}_{\Spec S}$} (m-2-1)
(m-1-2) edge node[auto] {$ q$} (m-2-2);
\path[right hook->,line width=1.0pt,font=\scriptsize]
(m-2-1) edge node[below] {$j $} (m-2-2);
\end{tikzpicture}
\end{center}
where $j$ is a closed immersion induced by $\cO_{Y,o}\twoheadrightarrow S$. According to assumptions $q$ is locally of finite type. Moreover, $\bd{G}$ is an algebraic group over $k$ and hence $\mathrm{pr}_{\Spec S}$ is locally of finite type. These two assertions together with the fact that $\Spec S\hookrightarrow Y$ is a closed immersion of noetherian schemes (and thus is of finite type) imply that $f$ is locally of finite type. Then by Lemma \ref{lemma:free_actions_in_formal_geometry} we deduce that $f$ induces an isomorphism 
\begin{center}
\begin{tikzpicture}
[description/.style={fill=white,inner sep=2pt}]
\matrix (m) [matrix of math nodes, row sep=3.5em, column sep=3em,text height=1.5ex, text depth=0.25ex] 
{   \widehat{\cO_{X,x}}  &  \hat{S}[[x_1,...,x_n]] = \hat{S}\hat{\otimes}_k\widehat{\cO_{\bd{G},e}}      \\} ;
\path[->,line width=1.0pt,font=\scriptsize]  
(m-1-1) edge node[auto] {$   $} (m-1-2);
\end{tikzpicture}
\end{center}
of complete local rings. Since $f$ is locally of finite type, it follows that $f$ is {\'e}tale at a $k$-point of $\bd{G}\times_k\Spec S$ determined by the unique $k$-point of $\Spec S$ and $e\in \bd{G}$. Let $U$ be an {\'e}tale locus of $f$. It contains a $k$-point and hence it is nonempty. Moreover, $U$ is open (it is {\'e}tale locus) subset of $X$. Since $f$ is $\bd{G}$-equivariant, we derive that $U$ is $\bd{G}$-stable. Similarly $f(U)$ is open $\bd{G}$-stable subset of $X$ and $x \in f(U)$. Thus by Lemma \ref{lemma:open_and_stable_with_k_point_are_entire} we deduce that 
$$U = \bd{G}\times_k\Spec S,\,f(U) = X$$
Therefore, $f$ is {\'e}tale and surjective. Now we pullback $q:X\ra Y$ along the closed immersion $\Spec S\hookrightarrow Y$. We obtain a cartesian square
\begin{center}
\begin{tikzpicture}
[description/.style={fill=white,inner sep=2pt}]
\matrix (m) [matrix of math nodes, row sep=3em, column sep=3em,text height=1.5ex, text depth=0.25ex] 
{     \tilde{X}      &    X                           \\
    \Spec S &   Y                 \\} ;
\path[->,line width=1.0pt,font=\scriptsize]  
(m-1-1) edge node[left] {$ \tilde{q}$} (m-2-1)
(m-1-2) edge node[auto] {$ q$} (m-2-2);
\path[right hook->,line width=1.0pt,font=\scriptsize]
(m-1-1) edge node[above] {$ \tilde{j} $} (m-1-2)
(m-2-1) edge node[below] {$j $} (m-2-2);
\end{tikzpicture}
\end{center}
Then $f$ factors as a morphism $\bd{G}\times_k\Spec S\ra \tilde{X}$ followed by a closed immersion $\tilde{j}$. Since $f$ is {\'e}tale and surjective, we deduce that $\tilde{j}$ is {\'e}tale and surjective. This implies that $\tilde{j}$ is an isomorphism of schemes. By definition of geometric quotient we derive that the diagram
\begin{center}
\begin{tikzpicture}
[description/.style={fill=white,inner sep=2pt}]
\matrix (m) [matrix of math nodes, row sep=3em, column sep=3em,text height=1.5ex, text depth=0.25ex] 
{ \cO_Y & q_*\cO_X & q_*\left(\mathrm{pr}_X\right)_*\cO_{\bd{G}\times_kX} = q_*a_*\cO_{\bd{G}\times_k X} \\} ;
\path[->,line width=1.0pt,font=\scriptsize]
(m-1-2) edge[transform canvas={yshift=0.5ex}] node[above] {$ q_*a^{\#}  $} (m-1-3)
(m-1-2) edge[transform canvas={yshift=-0.5ex}] node[below] {$ q_*\mathrm{pr}_X^{\#} $} (m-1-3)
(m-1-1) edge node[above] {$ q^{\#} $} (m-1-2);
\end{tikzpicture}
\end{center}
is the kernel in the category of sheaves on $Y$. Hence $q^{\#}:\cO_Y\ra q_*\cO_X$ is a monomorphism of sheaves. On the other hand we have
$$q^{\#} = j_*q_*\left(\tilde{j}^{-1}\right)^{\#} \cdot j_*\tilde{q}^{\#} \cdot j^{\#}$$
and thus $j^{\#}$ is a monomorphism. Since $j$ is a closed immersion, we infer that $j$ is an isomorphism. Therefore, we can identify $\Spec S$ with $Y$. Then $f$ is a morphism which makes the triangle
\begin{center}
\begin{tikzpicture}
[description/.style={fill=white,inner sep=2pt}]
\matrix (m) [matrix of math nodes, row sep=2.5em, column sep=1em,text height=1.5ex, text depth=0.25ex] 
{ \bd{G}\times_k Y &  & X \\
                        & Y &    \\} ;
\path[->,line width=1.0pt,font=\scriptsize]  
(m-1-1) edge node[auto] {$ f  $} (m-1-3)
(m-1-1) edge node[below = 4pt, left = 1pt] {$ \mathrm{pr}_{Y} $} (m-2-2)
(m-1-3) edge node[below = 4pt, right = 1pt] {$ q $} (m-2-2);
\end{tikzpicture}
\end{center}
commutative. This completes the proof of \textbf{(1)}.\\
For the proof of \textbf{(2)} consider the section $s:Y\hookrightarrow X$ described in \textbf{(1)}. Then $f$ fits into a cartesian square
\begin{center}
\begin{tikzpicture}
[description/.style={fill=white,inner sep=2pt}]
\matrix (m) [matrix of math nodes, row sep=3em, column sep=3em,text height=1.5ex, text depth=0.25ex] 
{   \bd{G}\times_kY  &   X\times_YY = X                           \\
    \bd{G}\times_kX  &   X\times_YX                 \\} ;
\path[->,line width=1.0pt,font=\scriptsize]  
(m-1-1) edge node[left] {$ 1_{\bd{G}}\times_Y s $} (m-2-1)
(m-1-2) edge node[auto] {$ 1_{X}\times_Y s$} (m-2-2)
(m-1-1) edge node[above] {$ f $} (m-1-2);
\path[right hook->,line width=1.0pt,font=\scriptsize]
(m-2-1) edge node[below] {$\phi $} (m-2-2);
\end{tikzpicture}
\end{center}
where $\phi$ is a closed immersion induced by the closed immersion $\langle a, \mathrm{pr}_X\rangle:\bd{G}\times_kX  \hookrightarrow   X\times_kX$ (the action of $\bd{G}$ on $X$ is free). Thus $f$ is a closed immersion. By \textbf{(1)} it is {\'e}tale and surjective. Therefore, $f$ is an isomorphism.  
\end{proof}

\begin{remark}\label{remark:principal_bundles_of_strictly_henselian_rings}
We expect that Theorem \ref{theorem:free_actions_over_complete_local_rings_are_trivial_bundles} holds for prime spectra of strictly henselian rings.
\end{remark}
\noindent
Now we introduce sufficient condition for smoothness of geometric quotient in case of locally algebraic $k$-schemes.

\begin{corollary}\label{corollary:sufficient_condition_for_smoothness_of_geometric_quotient}
Suppose that $\bd{G}$ is a smooth algebraic group over $k$. Let $q:X\ra Y$ be a morphism of finite type between $k$-schemes locally of finite type. Assume that $q$ is a uniform geometric quotient of $X$ and $x$ is a $k$-point of $X$ with closed free orbit. Then $q$ is smooth at $x$.
\end{corollary}
\begin{proof}
Since smoothness descent along faithfully flat morphisms, we may assume that $k$ is algebraically closed. Let $y = q(x)$. Then $y$ is a $k$-point of $Y$. Now $1_{\Spec \widehat{\cO_{Y,y}}}\times_kq$ is a geometric quotient and $\widehat{\cO_{Y,y}}$ is a complete local noetherian $k$-algebra with $k$ as a residue field. Moreover, $x$ is a $k$-point of $\Spec \widehat{\cO_{Y,y}}\times_kX$ with a closed free orbit. By Theorem \ref{theorem:free_actions_over_complete_local_rings_are_trivial_bundles} we deduce that $1_{\Spec \widehat{\cO_{Y,y}}}\times_k q$ is smooth. From descent for smoothness we infer that $q$ is smooth at $x$.
\end{proof}

\begin{definition}
Let $q:X\ra Y$ be a $\bd{G}$-equivariant morphism into a $k$-scheme $Y$ equipped with the trivial $\bd{G}$-action. Suppose that $q$ is faithfully flat, quasi-compact morphism and the square
\begin{center}
\begin{tikzpicture}
[description/.style={fill=white,inner sep=2pt}]
\matrix (m) [matrix of math nodes, row sep=3em, column sep=3em,text height=1.5ex, text depth=0.25ex] 
{ \bd{G}\times_kX &    X                 \\
   X              &    Y                 \\} ;
\path[->,line width=1.0pt,font=\scriptsize]  
(m-1-1) edge node[above] {$ a $} (m-1-2)
(m-1-1) edge node[left] {$ \mathrm{pr}_X $} (m-2-1)
(m-2-1) edge node[below] {$ q $} (m-2-2)
(m-1-2) edge node[right] {$ q $} (m-2-2);
\end{tikzpicture}
\end{center}
is cartesian. Then $q$ is \textit{a principal $\bd{G}$-bundle}.
\end{definition}
\noindent
Now we use Theorem \ref{theorem:free_actions_over_complete_local_rings_are_trivial_bundles} to describe principal $\bd{G}$-bundles in the category of locally algebraic $k$-schemes.

\begin{theorem}\label{theorem:principal_bundles_and_free_actions}
Suppose that $\bd{G}$ is a smooth algebraic group over $k$. Let $q:X\ra Y$ be a morphism of finite type between $k$-schemes locally of finite type. Then the following assertions are equivalent.
\begin{enumerate}[label=\emph{\textbf{(\roman*)}}, leftmargin=3.0em]
\item $q$ is a universal geometric quotient and the action of $\bd{G}$ on $X$ is free.
\item $q$ is a uniform geometric quotient and the action of $\bd{G}$ on $X$ is free.
\item $q$ is a principal $\bd{G}$-bundle.
\end{enumerate}
\end{theorem}
\begin{proof}
Clearly $\textbf{(i)}\Rightarrow \textbf{(ii)}$. Suppose that \textbf{(ii)} holds. Let $\ol{k}$ be an algebraic closure of $k$. Then $1_{\Spec \ol{k}}\times_kq$ is a uniform quotient and the action of $\Spec \ol{k}\times_k\bd{G}$ on $\Spec \ol{k}\times_kX$ induced by the action of $\bd{G}$ on $X$ is free. Moreover, if $1_{\Spec \ol{k}}\times_kq$ is a principal $\Spec \ol{k}\times_k\bd{G}$-bundle, then $q$ is a $\bd{G}$-bundle. This follows from the observation that property of being a principal bundle descents along faithfuly flat and quasi-compact base extensions. Thus we may assume that $k$ is algebraically closed. Next we pick a $k$-point $y$ of $Y$ and consider base change $1_{\Spec \widehat{\cO_{Y,y}}}\times_Yq$. This is a geometric quotient (because morphism $\Spec \widehat{\cO_{Y,y}}\ra Y$ is flat) and a morphism of finite type. Moreover, the action of $\bd{G}$ on $\Spec \widehat{\cO_{Y,y}}\times_YX$ is free. Since $\widehat{\cO_{Y,y}}$ is a complete noetherian $k$-algebra with residue field $k$, we derive by Theorem \ref{theorem:free_actions_over_complete_local_rings_are_trivial_bundles} that $\Spec \widehat{\cO_{Y,y}}\times_Yq$ is isomorphic as a $\bd{G}$-equivariant morphism with $\mathrm{pr}_{\Spec \widehat{\cO_{Y,y}}}$. By faithfuly flat descent for flat morphism we deduce that $q$ is flat at every point in the fiber $q^{-1}\left(\Spec \cO_{Y,y}\right)$. Since $y$ is an arbitrary $k$-point, it follows that $q$ is flat at every point of $X$ which specializes to a $k$-point. Every point of $X$ is a generization of a $k$-point ($X$ is locally of finite type and $k$ is algebraically closed). Thus $q$ is flat. It is also surjective (as it is a geometric quotient) and quasi-compact (it is of finite type). Therefore, it is faithfully flat and quasi-compact morphism. In order to obtain \textbf{(iii)} it remains to prove that the morphism $\Phi:\bd{G}\times_kX\ra X\times_YX$ induced by $a$ and $\mathrm{pr}_X$ is an isomorphism. Note that it is a closed immersion (the action of $\bd{G}$ on $X$ is closed). Moreover, $1_{\Spec \widehat{\cO_{Y,y}}}\times_Y \Phi$ is an isomorphism due to the fact that $1_{\Spec \widehat{\cO_{Y,y}}}\times_Yq$ is isomorphic as a $\bd{G}$-equivariant morphism with $\mathrm{pr}_{\Spec \widehat{\cO_{Y,y}}}$. By faithfully flat descent we infer that $1_{\Spec \cO_{Y,y}}\times_Y \Phi$ is an isomorphism. This holds for every $k$-point $y$ in $Y$. Thus $\Phi$ induces an isomorphism $\cO_{X\times_YX,\Phi(z)}\ra \cO_{\bd{G}\times_kX,z}$ for every $k$-point $z$ of $X\times_YX$. Hence a closed immersion $\Phi$ is an isomorphism. This completes the proof of $\textbf{(ii)}\Rightarrow \textbf{(iii)}$.\\
Assume now that \textbf{(iii)} holds. Then the square
\begin{center}
\begin{tikzpicture}
[description/.style={fill=white,inner sep=2pt}]
\matrix (m) [matrix of math nodes, row sep=3em, column sep=3em,text height=1.5ex, text depth=0.25ex] 
{ \bd{G}\times_kX &    X                 \\
    X              &    Y                 \\} ;
\path[->,line width=1.0pt,font=\scriptsize]  
(m-1-1) edge node[above] {$ a $} (m-1-2)
(m-1-1) edge node[left] {$ \mathrm{pr}_X $} (m-2-1)
(m-2-1) edge node[below] {$ q $} (m-2-2)
(m-1-2) edge node[right] {$ q $} (m-2-2);
\end{tikzpicture}
\end{center}
is cartesian and $q$ is faithfully flat and quasi-compact. By Proposition \ref{proposition:trivial_bundle_is_universal_geometric_quotient} morphism $\mathrm{pr}_X$ is a universal geometric quotient. According to Corollary \ref{corollary:geometric_quotients_descent_along_fpqc} we derive that $q$ is universal geometric quotient. Moreover, the cartesian square above shows that the morphism $\bd{G}\times_kX\ra X\times_YX$ induced by $a$ and $\mathrm{pr}_X$ is an isomorphism. Thus the action of $\bd{G}$ on $X$ is free. This is \textbf{(i)}. Hence $\textbf{(iii)}\Rightarrow \textbf{(i)}$ holds.
\end{proof}

\section{Nagata's theorem}
\noindent
We start by proving the following result which give yet another characterization of linearly reductive groups.

\begin{theorem}\label{theorem:characterization_of_linearly_reductive_groups_in_terms_of_existence_of_invariant_linear_forms}
Let $\bd{G}$ be a smooth affine algebraic group over $k$. Then the following assertions are equivalent.
\begin{enumerate}[label=\emph{\textbf{(\roman*)}}, leftmargin=3.0em]
\item $\bd{G}$ is linearly reductive.
\item For every finitely dimensional linear representation $V$ of $\bd{G}$ and for every nonzero $\bd{G}$-invariant element $v$ in $V$ there exists a $\bd{G}$-invariant linear function $f:V\ra k$ such that $f(v)\neq 0$. 
\end{enumerate}
\end{theorem}
\noindent
We need the following easy result.

\begin{lemma}\label{lemma:every_functional_comes_from_an_invariant_form}
Let $\bd{G}$ be an algebraic group over $k$ which satisfies \textbf{(ii)}. Suppose that $V$ is a finitely dimensional representation of $\bd{G}$. Then the map
$$\Hom_{k}\left(V,k\right)^{\bd{G}}\ni f \mapsto f_{\mid V^{\bd{G}}}\in \Hom_k\left(V^{\bd{G}}, k\right)$$
is an isomorphism of vector spaces over $k$.
\end{lemma}
\begin{proof}[Proof of the lemma]
The image of the map in the statement is a $k$-vector subspace $W\subseteq \Hom_k\left(V^{\bd{G}}, k\right)$ such that for every nonzero element $v$ in $V^{\bd{G}}$ there exists $f$ in $W$ such that $f(v)\neq 0$ (this is a consequence of \textbf{(ii)}). It follows that $W$ cannot be proper subspace of $\Hom_k\left(V^{\bd{G}}, k\right)$. Hence the map in the statement is an epimorphism. Now fix a nonzero $\bd{G}$-invariant linear function $f:V\ra k$. By \textbf{(ii)} there exists a $\bd{G}$-invariant linear function $w:\Hom_k\left(V,k\right)\ra k$ such that $w(f) = 0$. Note that the canonical isomorphism
$$V \cong\Hom_k\left(\Hom_k\left(V,k\right),k\right)$$
of $k$-vector spaces is a morphism of representations of $\bd{G}$. Thus $w$ is defined in terms of evaluation in some $\bd{G}$-invariant vector $v$ in $V$. Therefore, $f(v)\neq 0$ and hence $f_{\mid V^{\bd{G}}} \neq 0$. Thus the map described in the statement is also a monomorphism.
\end{proof}

\begin{proof}[Proof of the theorem]
Suppose that \textbf{(i)} holds. Consider a $\bd{G}$-invariant nonzero vector $v$ in a finitely dimensional representation $V$ of $\bd{G}$. Then $k\cdot v\subseteq V$ is a $\bd{G}$-subrepresentation. Since $\bd{G}$ is linearly reductive, there exists a morphism of $\bd{G}$-representations which is a left inverse of $k\cdot v \hookrightarrow V$. This morphism can be identified with a $\bd{G}$-invariant linear function $f:V\ra k$ such that $f(v) \neq 0$. Hence $\textbf{(i)}\Rightarrow \textbf{(ii)}$.\\
Now suppose that \textbf{(ii)} holds. Pick an epimorphism $\theta:V\twoheadrightarrow W$ of finitely dimensional representations $V$ of $\bd{G}$. Assume that there exists a nonzero $\bd{G}$-invariant vector $w$ in $W$ such that $w\not \in \theta\left(V^{\bd{G}}\right)$. By Lemma \ref{lemma:every_functional_comes_from_an_invariant_form} there exists $f$ in $\Hom_k\left(W,k\right)^{\bd{G}}$ such that $f_{\mid \theta\left(V^{\bd{G}}\right)} = 0$ and $f(w) \neq 0$. Then $f\cdot \theta$ is a nonzero element of $\Hom\left(V,k\right)^{\bd{G}}$ such that $\left(f\cdot \theta\right)_{\mid V^{\bd{G}}} = 0$. This is impossible according to Lemma \ref{lemma:every_functional_comes_from_an_invariant_form}. Hence $\theta^{\bd{G}}:V^{\bd{G}}\ra W^{\bd{G}}$ is an epimorphism. Now assume that $\theta:V\twoheadrightarrow W$ is an epimorphism of arbitrary linear representations of $\bd{G}$. Since $\bd{G}$ is affine, every linear representation of $\bd{G}$ is rational (i.e. it is a sum of its finitely dimensional subrepresentations). This together with the finitely dimensional case considered above imply that $\theta^{\bd{G}}:V^{\bd{G}}\ra W^{\bd{G}}$ is an epimorphism. Thus the functor $(-)^{\bd{G}}:\bd{Rep}(\bd{G})\ra \Vect_k$ is exact.
\end{proof}
\noindent
The result above motivates the following notion.

\begin{definition}
Let $\bd{G}$ be a smooth affine algebraic group. Suppose that for every finitely dimensional representation $V$ of $\bd{G}$ and for every nonzero $\bd{G}$-invariant vector $v$ of $V$ there exists a homogenous $\bd{G}$-invariant polynomial $f:V\ra k$ such that $f(v)\neq 0$. Then $\bd{G}$ is \textit{geometrically reductive}.     
\end{definition}
\noindent
We state here the following celebrated result.

\begin{theorem}\label{theorem:haboush_theorem}
If $\bd{G}$ is reductive, then it is geometrically reductive.
\end{theorem}
\noindent
The result above is due to Haboush and its proof can be found in \cite{Haboush_reductive_is_geom_reductive}.\\
The following theorem shows that geometric reductivity admits up to an integral extension the same property as linear reductivity (see also Remark \ref{remark:comment_on_surogate_linear_reductivity} below).

\begin{theorem}\label{theorem:surogate_linear_reductivity}
Suppose that $\bd{G}$ is geometrically reductive. Let $A$ be a $k$-algebra such that $\Spec A$ admits an action of $\bd{G}$ and let $\ideal{a}$ be a $\bd{G}$-stable ideal of $A$. We consider $A^{\bd{G}}/A^{\bd{G}}\cap \ideal{a}$ as a $k$-subalgebra of $\left(A/\ideal{a}\right)^{\bd{G}}$ by means of the canonical inclusion $A^{\bd{G}}/A^{\bd{G}}\cap \ideal{a} \hookrightarrow A/\ideal{a}$. For every element $x \in \left(A/\ideal{a}\right)^{\bd{G}}$ there exists positive integer $r$ such that $x^r \in A^{\bd{G}}/A^{\bd{G}}\cap \ideal{a}$.
\end{theorem}
\begin{proof}
Let $d:A\ra k[\bd{G}]\otimes_kA$ be the coaction of $\bd{G}$ on $A$. Pick an element $x_0\in A$ which maps to $x$ modulo $\ideal{a}$. Consider finitely dimensional vector subspace $V\subseteq A$ over $k$ such that $V$ is a $\bd{G}$-subrepresentation of $A$ and $x_0\in V$. Since $x$ is $x_0$ modulo $\ideal{a}$, we derive that $c(x_0) - 1\otimes x_0$ is in ideal of $k[\bd{G}]\otimes_kA$ generated by $k[\bd{G}]\otimes_k\ideal{a}$. Thus $W = k\cdot x_0+V\cap \ideal{a}\subseteq A$ is finitely dimensional $\bd{G}$-subrepresentation of $A$. Let $\lambda:W\ra k$ be a $k$-linear form such that $\lambda(x_0) = 1$ and $\lambda_{\mid V\cap \ideal{a}} = 0$. Since $\bd{G}$ is geometrically reductive there exists $f\in \Sym_r\left(W\right)^{\bd{G}}$ such that $f(\lambda) = 1$. Since the canonical morphism $\Sym_r(W)\ra A$ is a morphism of representations of $\bd{G}$, we deduce that $f$ is mapped under this morphism to some $\bd{G}$-invariant element $y$ in $A$. Note that $f$ is sum of an $r$-th symmetric power of $x_0$ and some element of $\Sym_r\left(V\cap \ideal{a}\right)$. Thus $y\,\mathrm{mod}\,\ideal{a} = x^r$. Hence $x^r \in A^{\bd{G}}/A^{\bd{G}}\cap \ideal{a}$.
\end{proof}

\begin{remark}\label{remark:comment_on_surogate_linear_reductivity}
Let $\bd{G}$ be an algebraic group $\bd{G}$ which acts on $\Spec A$ for some $k$-algebra $A$ and let $\ideal{a}$ be a $\bd{G}$-stable ideal of $A$. Then the sequence
\begin{center}
\begin{tikzpicture}
[description/.style={fill=white,inner sep=2pt}]
\matrix (m) [matrix of math nodes, row sep=3em, column sep=2em,text height=1.5ex, text depth=0.25ex] 
{ 0 & \ideal{a}^{\bd{G}} & A^{\bd{G}} & \left(A/\ideal{a}\right)^{\bd{G}} \\} ;
\path[->,line width=1.0pt,font=\scriptsize]
(m-1-1) edge node[above] {$  $} (m-1-2)
(m-1-2) edge node[above] {$  $} (m-1-3)
(m-1-3) edge node[above] {$  $} (m-1-4);
\end{tikzpicture}
\end{center}
is left exact and it induces a monomorphism $A^{\bd{G}}/\ideal{a}\cap A^{\bd{G}} = A^{\bd{G}}/\ideal{a}^{\bd{G}}\hookrightarrow \left(A/\ideal{a}\right)^{\bd{G}}$. If $\bd{G}$ is linearly reductive, then the sequence is exact and this monomorphism is an isomorphism. Theorem \ref{theorem:surogate_linear_reductivity} states that if $\bd{G}$ is geometrically reductive, then the monomorphism $A^{\bd{G}}/\ideal{a}\cap A^{\bd{G}} \hookrightarrow \left(A/\ideal{a}\right)^{\bd{G}}$ is integral.
\end{remark}
\noindent
Now we are going to formulate the main result of this section.

\begin{theorem}\label{theorem:Nagata_theorem_on_finite_generation_of_invariants}
Suppose that $\bd{G}$ is geometrically reductive. Let $A$ be a finitely generated $k$-algebra such that $\Spec A$ admits an action of $\bd{G}$. Then $A^{\bd{G}}$ is finitely generated $k$-algebra.
\end{theorem}
\noindent
The theorem above was first proved by Nagata and here we follow Nagata's original proof. In the argument we denote the coaction of $k[\bd{G}]$ on $A$ by $d:A\ra k[\bd{G}]\otimes_kA$. The proof relies on a series of partial results.

\begin{lemma}\label{lemma:integral_and_of_finite_type_over_base_implies_that_base_is_of_finite_type}
Let $A\hookrightarrow B$ be an integral morphism of $k$-algebras and suppose that $B$ is finitely generated over $k$. Then $A$ is finitely generated.
\end{lemma}
\begin{proof}[Proof of the lemma]
Suppose that $b_1,...,b_r$ are generators of $B$ as a $k$-algebra. For every $1\leq i \leq r$ we have a polynomial relation
$$b_i^{n_i} + a_{i,n_i-1}b_i^{n_i-1}+...+a_{i,1}b_i+ a_{i,0} = 0$$
where $n_i > 0$ and $a_{i,j}\in A$ for $0\leq j\leq n_i-1$. Suppose that $\tilde{A}$ is a $k$-subalgebra of $A$ generated by $a_{i,j}$ for $1\leq i\leq r$ and $0\leq j\leq n_i-1$. Then $B$ is finite over $\tilde{A}$. Since $\tilde{A}\subseteq A\subseteq B$ and $\tilde{A}$ is noetherian, we derive that $A$ is finite over $\tilde{A}$. Hence $A$ is finitely generated over $k$.
\end{proof}

\begin{lemma}\label{lemma:nagata_theorem_case_of_invariant_zero_divisors}
Suppose that $\bd{G}$ is geometrically reductive. Let $A$ be a $k$-algebra such that $\Spec A$ admits an action of $\bd{G}$. Assume that $A$ contains $\bd{G}$-invariant zero divisor and that for every proper $\bd{G}$-stable ideal $\ideal{a}$ of $A$ the $k$-algebra $\left(A/\ideal{a}\right)^{\bd{G}}$ is finitely generated over $k$. Then $A^{\bd{G}}$ is finitely generated over $k$.
\end{lemma}
\begin{proof}[Proof of the lemma]
Let $f$ be a $\bd{G}$-invariant zero divisor of $A$. By assumption both $k$-algebras $\left(A/fA\right)^{\bd{G}}$ and $\left(A/\mathrm{ann}(f)\right)^{\bd{G}}$ are finitely generated over $k$. Now by combination of Lemma \ref{lemma:integral_and_of_finite_type_over_base_implies_that_base_is_of_finite_type} and Theorem \ref{theorem:surogate_linear_reductivity} we obtain that $A^{\bd{G}}/A^{\bd{G}}\cap fA$ and $A^{\bd{G}}/A^{\bd{G}}\cap \mathrm{ann}(f)$ are finitely generated over $k$. Let $B$ be a finitely generated $k$-subalgebra of $A^{\bd{G}}$ which maps surjectively onto $A^{\bd{G}}/A^{\bd{G}}\cap fA$ and $A^{\bd{G}}/A^{\bd{G}}\cap \mathrm{ann}(f)$. Let $u_1,...,u_n$ be elements in $A$ such that the image of $B\cdot u_1+...+B\cdot u_n\subseteq A$ modulo $\mathrm{ann}(f)$ contains a finite $B$-module $\left(A/\mathrm{ann}(f)\right)^{\bd{G}}$. Fix $a\in A^{\bd{G}}$. Since $B$ maps surjectively onto $A^{\bd{G}}/A^{\bd{G}}\cap fA$, there exist $b \in B$ and $c\in A$ such that $a - b = fc$. Note that $fc\in A^{\bd{G}}$ and thus
$$(1\otimes f)\left(d(c) - 1\otimes c\right) = 0$$
This implies that $c$ is send to $\left(A/\mathrm{ann}(f)\right)^{\bd{G}}$ modulo $\mathrm{ann}(f)$. Then $c \in B\cdot u_1 + ... + B\cdot u_n$. Hence $a - b \in B\cdot fu_1 + ... + B\cdot fu_n$. Therefore, $a\in B[fu_1,...,fu_n]$. This completes the proof that $A^{\bd{G}}$ is finitely generated over $k$.
\end{proof}

\begin{lemma}\label{lemma:nagata_theorem_case_of_invariant_zero_divisors_with_gradation}
Suppose that $\bd{G}$ is geometrically reductive. Let $A = \oplus_{n\in \NN}A_n$ be a $\NN$-graded $k$-algebra such that $A$ admits an action of $\bd{G}$. Assume that $A_n$ is a $\bd{G}$-subrepresentation of $A$ for every $n\in \NN$ and that for every proper $\bd{G}$-stable homogenous ideal $\ideal{a}$ of $A$ the $k$-algebra $\left(A/\ideal{a}\right)^{\bd{G}}$ is finitely generated over $k$. If $A$ contains $\bd{G}$-invariant zero divisor, then $A^{\bd{G}}$ is finitely generated over $k$.
\end{lemma}
\begin{proof}[Proof of the lemma]
Let $f$ be a $\bd{G}$-invariant zero divisor of $A$. We may pick $f$ such that it is homogenous. Then both ideals $fA$ and $\mathrm{ann}(f)$ are homogenous, $\bd{G}$-stable and proper in $A$. Now we proceed as in the proof of Lemma \ref{lemma:nagata_theorem_case_of_invariant_zero_divisors}. 
\end{proof}

\begin{proof}[Proof of the theorem]
We first prove the theorem in case of $\NN$-graded $k$-algebras and then reduce the general case to this graded case.\\
Assume that $A = \bigoplus_{n\in \NN}A_n$ is $\NN$-graded in such a way that $A_0 = k$ and $A_n$ is a $\bd{G}$-subrepresentation of $A$ for every $n\in \NN$. Since $A$ is finitely generated over $k$ and by virtue of noetherian induction, we assume that $\left(A/\ideal{a}\right)^{\bd{G}}$ is finitely generated over $k$ for every homogenous $\bd{G}$-stable proper ideal $\ideal{a}$ of $A$. If there are $\bd{G}$-invariant zero divisors of $A$, then by Lemma \ref{lemma:nagata_theorem_case_of_invariant_zero_divisors_with_gradation} we deduce that $A^{\bd{G}}$ is finitely generated over $k$. So we may assume that $A^{\bd{G}}$ contains no zero divisors of $A$. Pick a nonzero homogenous element $f\in A^{\bd{G}}$ of positive degree. If there are no such elements, then $A^{\bd{G}} = A_0 = k$ and the result holds. So we may assume that such an element exists. Note that it is noninvertible. Consider $x\in A$ such that $fx\in A^{\bd{G}}$. Then 
$$0 = d(fx) - 1\otimes fx = d(f)\cdot d(x) - (1\otimes f)\cdot (1\otimes x) = (1\otimes f)\left(d(x) - 1\otimes x\right)$$
Since $f$ is not a zero divisor in $A$, we derive that $1\otimes f$ is not a zero divisor in $k[\bd{G}]\otimes_kA$. Thus $d(x) = 1\otimes x$ and $x\in A^{\bd{G}}$. This shows that $fA\cap A^{\bd{G}} = fA^{\bd{G}}$. By Theorem \ref{theorem:surogate_linear_reductivity} $\left(A/fA\right)^{\bd{G}}$ is integral over $A^{\bd{G}}/fA\cap A^{\bd{G}} = A^{\bd{G}}/fA^{\bd{G}}$. Note that $\left(A/fA\right)^{\bd{G}}$ is finitely generated over $k$ by inductive assumption. According to Lemma \ref{lemma:integral_and_of_finite_type_over_base_implies_that_base_is_of_finite_type} we obtain that $A^{\bd{G}}/fA^{\bd{G}}$ is finitely generated over $k$. Clearly
$$A^{\bd{G}} = \bigoplus_{n\in \NN}A_n^{\bd{G}}$$
and hence $A^{\bd{G}}/fA^{\bd{G}}$ inherits $\NN$-grading from $A$. The ideal generated by elements of positive degree $\left(A^{\bd{G}}/fA^{\bd{G}}\right)_+$ is finitely generated (as is every ideal in noetherian ring). Hence also
$$\left(A^{\bd{G}}\right)_+ = \bigoplus_{n\in \NN_+}A_n^{\bd{G}}$$
is finitely generated (generating set consists of lifts of generators of $\left(A^{\bd{G}}/fA^{\bd{G}}\right)_+$ and $f$). This implies that $A^{\bd{G}}$ is finitely generated over $A_0^{\bd{G}} = k$.\\
Now assume that $A$ is an arbitrary finitely generated $k$-algebra. By noetherian induction we may assume that $\left(A/\ideal{a}\right)^{\bd{G}}$ is finitely generated over $k$ for every proper $\bd{G}$-stable ideal $\ideal{a}$ of $A$. Pick a finitely dimensional $\bd{G}$-subrepresentation $V$ of $A$ which contains some finite set of generators of $A$ as a $k$-algebra. Define $S = \Sym(V)$ and $S_n = \Sym_n(V)$ for every $n\in \NN$. Then $S$ is $\NN$-graded, $S_0 = k$ and $\bd{G}$ acts on $\Spec S$ in such a way that $S_n$ is a $\bd{G}$-subrepresentation of $S$ for every $S$. By the case considered above $S^{\bd{G}}$ is finitely generated over $k$. The canonical (induced by $V\hookrightarrow A$) surjective morphism $S\twoheadrightarrow A$ of $k$-algebras is also a morphism of representations of $\bd{G}$. Let $I$ be its kernel. Then $I$ is a $\bd{G}$-stable ideal of $S$. By Theorem \ref{theorem:surogate_linear_reductivity} we derive that $A^{\bd{G}}= \left(S/I\right)^{\bd{G}}$ is integral over its finitely generated $k$-subalgebra $S^{\bd{G}}/I\cap S^{\bd{G}}$. Moreover, by Lemma \ref{lemma:nagata_theorem_case_of_invariant_zero_divisors} we may assume that $A^{\bd{G}}$ does not contain zero divisors of $A$. In particular, it is an integral domain. Hence $S^{\bd{G}}/I\cap S^{\bd{G}}$ is a domain. Let $B$ be the integral closure of $S^{\bd{G}}/I\cap S^{\bd{G}}$ in the field $L$ of fractions of $A^{\bd{G}}$. Since $B$ is integral over $A^{\bd{G}}$, Lemma \ref{lemma:integral_and_of_finite_type_over_base_implies_that_base_is_of_finite_type} shows that it suffices to prove that $B$ is finitely generated over $k$. This will follow, if we can show that $B$ is a finite $S^{\bd{G}}/I\cap S^{\bd{G}}$-module. Since fields are Nagata rings, we may reduce this question to proving that $L$ is a finite extension of the field $K$ of fractions of $S^{\bd{G}}/I\cap S^{\bd{G}}$. Since $K\subseteq L$ is algebraic (due to the fact that $S^{\bd{G}}/I\cap S^{\bd{G}}\hookrightarrow A^{\bd{G}}$ is integral), it suffices to show that $L$ is finitely generated field over $K$. For this pick a set $S$ of nonzero divisors of $A$. Note that $S$ is a multiplicative subset of $A$. Fix a maximal ideal $\ideal{m}\subseteq S^{-1}A$. Since nonzero elements of $\ideal{m}\cap A^{\bd{G}}$ are zero divisors of $A$, we derive that $\ideal{m}\cap A^{\bd{G}} = 0$. Thus $L$ is a subfield of $S^{-1}A/\ideal{m}$. The inclusion $A\hookrightarrow S^{-1}A$ induces an isomorphism between the fraction field of $A/\ideal{m}\cap A$ and the field $S^{-1}A/\ideal{m}$. By our assumption $A$ is finitely generated over $k$. Thus the fraction field of $A/\ideal{m}\cap A$ is finitely generated over $k$ as field. It follows that $L$ is a field finitely generated over $k$. This implies that $L$ is a field finitely generated over $K$. Therefore, $A^{\bd{G}}$ is finitely generated $k$-algebra.
\end{proof}

\section{Good categorical quotients}




\small
\bibliographystyle{apalike}
\bibliography{../zzz}

    
\end{document}
\input ../pree.tex

\begin{document}

\title{Radon-Nikodym theorem, Hahn-Jordan decomposition and Lebesgue decomposition}
\date{}
\maketitle

\section{Introduction}
\noindent
This notes are devoted to some more advanced notions in measure theory. Tools presented here are indispensable in probability theory and statistics. We refer to \cite{Introductiontomeasuretheory} for extensive introduction to measure theory. 

\section{Signed and Complex Measures}
\noindent
In this section we define extension of the usual notion of measure. Denote by $\ol{\RR}=\RR\cup \{-\infty,+\infty\}$ the topological space obtained as a two-point compactification of the line $\RR$. Addition is partially defined operation on $\ol{\RR}$ given by the following rules
$$(+\infty)+r=+\infty=r+(+\infty),\,(-\infty)+r=-\infty=r+(-\infty)$$
for every $r\in \RR$

\begin{definition}
Let $\left(X,\Sigma\right)$ be a measurable space. \textit{A signed measure on $(X,\Sigma)$} is a function $\nu:\Sigma\ra \ol{\RR}$ such that $\nu(\emptyset)=0$ and 
$$\nu\left(\bigcup_{n\in \NN}A_n\right)=\sum_{n\in \NN}\nu(A_n)$$
for every family $\{A_n\}_{n\in \NN}$ of pairwise disjoint subsets of $\Sigma$. We also say that $\nu$ is \textit{a real measure on $(X,\Sigma)$} if it is signed measure and takes values in $\RR$.
\end{definition}

\begin{definition}
Let $\left(X,\Sigma\right)$ be a measurable space. \textit{A complex measure} is a function $\nu:\Sigma\ra \CC$ such that $\nu(\emptyset)=0$ and 
$$\nu\left(\bigcup_{n\in \NN}A_n\right)=\sum_{n\in \NN}\nu(A_n)$$
for every family $\{A_n\}_{n\in \NN}$ of pairwise disjoint subsets of $\Sigma$. 
\end{definition}

\begin{definition}
Let $(X,\Sigma)$ be a measurable space and let $\mu,\nu$ be two measures (either complex or signed) on $(X,\Sigma)$. Suppose that for every set $A$ in $\Sigma$ we have
$$\mu(A) = 0\,\Rightarrow \nu(A)=0$$
Then we write $\nu \ll \mu$ and say that $\nu$ is \textit{absolutely continuous with respect to $\mu$}.
\end{definition}

\begin{definition}
Let $(X,\Sigma)$ be a measurable space and let $\mu$, $\nu$ be two measures (either complex or signed) on $(X,\Sigma)$. Suppose that there exists a set $S\in \Sigma$ such that
$$\mu(A\cap S) = 0,\,\nu(A\setminus S) = 0$$
for every $A \in \Sigma$. Then we write $\nu \perp \mu$ and say that $\nu$ is \textit{singular with respect to $\mu$}.
\end{definition}

\section{Hahn-Jordan Decomposition}

\begin{theorem}[Hahn-Jordan decomposition]\label{theorem:jordansdecomposition}
Let $\left(X,\Sigma\right)$ be a measurable space and $\nu:\Sigma\ra \ol{\RR}$ be a signed measure. Then there exists the unique pair of measures $\nu_+,\nu_-:\Sigma \ra [0,+\infty]$ such that  
$$\nu = \nu_+ - \nu_-$$
and $\nu_+ \perp \nu_-$.
\end{theorem}
\noindent
For the proof we need the following notion.

\begin{definition}
Let $(X,\Sigma,\nu)$ be a space with signed measure. A set $A\in \Sigma$ is \textit{positive} if for every subset $B$ of $A$ such that $B\in \Sigma$ we have inequality $\nu(B)\geq 0$. 
\end{definition}

\begin{lemma}\label{lemma:positiveexist}
Let $B\in \Sigma$ be a set such that $\nu(B)\in \RR$ and $\nu(B)>0$. Then there exists a positive set $C\subseteq B$ such that $\nu(B)\leq \nu(C)$.
\end{lemma}
\begin{proof}[Proof of the lemma]
First note that all sets $A\in \Sigma$ contained in $B$ have finite measure (we left the proof as an exercise for the reader). For every subset $A\in \Sigma$ contained in $B$ we define
$$\delta(A) = \max\bigg\{\frac{1}{2}\inf\big\{\nu(D)\,\big|\,D\mbox{ is a subset of }A\mbox{ in }\Sigma\big\},-1\bigg\}$$
Note that $\delta(A)\leq 0$. Now we define a sequence $\{D_n\}_{n\in \NN}$ of disjoint subsets of $B$ and members of $\Sigma$. This is done recursively as follows. If $D_0,...,D_n$ are defined, then we pick $D_{n+1}$ as a subset of $B\setminus \left(D_0\cup...\cup D_n\right)$ in $\Sigma$ such that
$$\nu(D_{n+1})\leq \delta\big(B\setminus \left(D_0\cup...\cup D_n\right)\big)$$
Let
$$C = B\setminus \bigcup_{n\in \NN}D_n$$
be a subset of $B$. Clearly $C\in \Sigma$ and for every $n\in \NN$ we have
$$\delta(C) \geq \delta\big(B\setminus \left(D_0\cup...\cup D_n\right)\big)$$
Thus
$$\nu(C) = \nu(B)-\sum_{n\in \NN}\nu(D_n) \geq \nu(B) -\sum_{n\in \NN}\delta\big(B\setminus \left(D_0\cup...\cup D_n\right)\big) = \nu(B) -\sum_{n\in \NN}\delta(C)$$
Since $\nu(C)\in \RR$, we derive that $\delta(C)=0$. This implies that $C$ is a positive set and $\nu(C)\geq \nu(B)$.
\end{proof}

\begin{proof}[Proof of the theorem]
Assume that for every $A\in \Sigma$ we have $\nu(A) \in \RR\cup \{-\infty\}$. Now consider 
$$\alpha=\sup \big\{\nu(C)\,\big|\,C\mbox{ is positive}\big\}$$
We can find a nondecreasing sequence $\{\alpha_n\}_{n\in \NN}$ of nonnegative real numbers that converges to $\alpha$ and such that for every $n\in \NN$ there exists a positive set $C_n$ with $\nu(C_n)=\alpha_n$. Now pick $P=\bigcup_{n\in \NN}C_n$. Obviously $P$ is positive and $\nu(P)=\alpha$. In particular, $\alpha \in \RR$. Assume that there exists $B\in \Sigma$ such that $B\subseteq X\setminus P$ and $\nu(B)>0$. According to Lemma \ref{lemma:positiveexist} we deduce that there exists a positive set $C$ inside $B$ such that $\nu(B)\leq \nu(C)$. Then we get
$$\alpha=\nu(P)<\nu(P)+\nu(C)=\nu(P\cup C)$$
and $P\cup C$ is positive. This contradicts the definition of $\alpha$. Hence for every $B\subseteq X\setminus P$ such that $B\in \Sigma$ we have $\nu(B)\leq 0$. Thus measures
$$\nu_+(A) = \nu(A\cap P),\,\nu_-(A) = -\nu(A\setminus P)$$
defined for $A\in \Sigma$ satisfy the assertion of the theorem. This finishes the proof of the Hahn-Jordan decomposition under the assumption that $\nu(A)\in \RR\cup \{-\infty\}$ for all $A\in \Sigma$.\\
If $\nu(A)\in \RR\cup \{+\infty\}$ for every $A\in \Sigma$, then we apply the result above for $-\nu$. Finally the case $\nu(A_1)=-\infty$ and $\nu(A_2)=+\infty$ for some $A_1$, $A_2\in \Sigma$ yields to the contradiction. Hence Hahn-Jordan decomposition is proved.
\end{proof}

\begin{corollary}\label{corollary:oneisfinite}
Let $\left(X,\Sigma\right)$ be a measurable space and $\nu:\Sigma\ra \ol{\RR}$ be a signed measure. Then either $\nu_+$ or $\nu_-$ is finite.
\end{corollary}
\begin{proof}
According to Theorem \ref{theorem:jordansdecomposition} we have $\nu = \nu_+-\nu_-$ and both $\nu_+$, $\nu_-$ are nonnegative measures such that $\nu_+\perp \nu_-$. We cannot have $\nu_+(X)=\nu_-(X)=+\infty$, because then $\nu(X)$ would be undefined in $\ol{\RR}$. This implies that either $\nu_+(X)\in \RR$ or $\nu_-(X)\in \RR$.
\end{proof}

\section{Lebesgue decomposition}

\begin{definition}
Let $(X,\Sigma)$ be a measurable space and $\mu:\Sigma \ra \ol{\RR}$ be a signed measure. We say that $\mu$ is $\sigma$-finite if there exists a decomposition
$$X = \bigcup_{n\in \NN}X_n$$
onto pairwise disjoint elements of $\Sigma$ such that $\mu(X_n)\in \RR$ for every $n\in \NN$.
\end{definition}

\begin{theorem}[Lebesgue decomposition]\label{theorem:lebesguedecomposition}
Let $(X,\Sigma)$ be a measurable space and let $\mu$ be a $\sigma$-finite, measure on $(X,\Sigma)$. Suppose that $\nu$ is either a signed and $\sigma$-finite measure or a complex measure on $(X,\Sigma)$. Then there exists a unique decomposition 
$$\nu = \nu_s + \nu_a$$
of measure $\nu$ such that $\nu_s \perp \mu$ and $\nu_a \ll \mu$.
\end{theorem}
\begin{proof}
Suppose first that $\nu$ is finite measure. Consider
$$\alpha = \sup_{A\in \Sigma,\,\mu(A)=0}\nu(A)$$
Since $\nu$ is finite, we derive that $\alpha \in \RR$. Consider a sequence $\{A_n\}_{n\in \NN}$ such that $A_n\in \Sigma$, $\mu(A_n)=0$ for every $n\in \NN$ and $\lim_{n\ra +\infty}\nu(A_n)=\alpha$. Define $S = \bigcup_{n\in \NN}A_n$. Then $\mu(S) = 0$ and $\nu(S) = \alpha$. Moreover, if $A\in \Sigma$ and $A\cap S = \emptyset$, then $\mu(A) = 0$ implies $\nu(A) = 0$. Now we define $\nu_s(A) = \nu(A\cap S)$ and $\nu_a(A) = \nu(A\setminus S)$ for every $A\in \Sigma$. Then $\nu = \nu_s+\nu_a$ and $\nu_s \perp \mu$, $\nu_a \ll \mu$.\\
Now assume that $\nu$ is $\sigma$-finite measure. There exists a decomposition
$$X = \bigcup_{n\in \NN}X_n$$
onto pairwise disjoint elements of $\Sigma$ such that $\mu(X_n)\in \RR$ for every $n\in \NN$. We define $\nu_n(A) = \nu(A\cap X_n)$ for each $n\in \NN$ and $A\in \Sigma$. Then $\nu_n$ is a finite measure. By the case above we find $\nu_n = \nu_{ns}+ \nu_{na}$ and $\nu_{ns}\perp \mu$, $\nu_{na} \ll \mu$ for some measures on $\Sigma$. Now we define
$$\nu_s = \sum_{n\in \NN}\nu_{ns},\,\nu_a=\sum_{n\in \NN}\nu_{an}$$
Then $\nu = \nu_s+\nu_a$ and $\nu_s \perp \mu$, $\nu_a \ll \mu$.\\
Now consider the case when $\nu$ is $\sigma$-finite and signed measure. According to Theorem \ref{theorem:jordansdecomposition} we write $\nu = \nu_+-\nu_-$ for measures $\nu_+,\nu_-$ such that $\nu_+\perp \nu_-$. Then $\nu_+,\nu_-$ are $\sigma$-finite measures. According to previous case we can write $\nu_+ = \nu_{+s}+\nu_{+a}$, $\nu_- = \nu_{-s} + \nu_{-a}$ for measures such that $\nu_{+s} \perp \mu,\nu_{-s} \perp \mu,\nu_{+a}\ll \mu,\nu_{-a}\ll\mu$. Then $\nu_s = \nu_{+s} - \nu_{-s}, \nu_a=\nu_{+a}-\nu_{-a}$ are signed measures and $\nu_s \perp \mu, \nu_a\ll\mu$.\\
Finally assume that $\nu$ is complex. Then $\nu = \nu^r + i\cdot \nu^i$, where $\nu^r$ and $\nu^i$ are finite, signed measures. Form the case above we have decompositions
$$\nu^r = \nu^r_s+\nu^r_a,\,\nu^i=\nu^i_s+\nu^i_s$$
and $\nu^r_s \perp \mu$, $\nu^i_s \perp \mu$, $\nu^r_a \ll\mu$, $\nu^i_a \ll \mu$. Then complex measures 
$$\nu_s = \nu^r_s+i\cdot \nu^i_s,\,\nu_a = \nu^r_a+i\cdot \nu^i_a$$
satisfy $\nu_s \perp \mu$, $\nu_a \ll \mu$.
\end{proof}

\section{Radon-Nikodym theorem and derivatives}
\noindent
In this section we prove famous result of Radon and Nikodym.

\begin{theorem}[Radon-Nikodym]\label{theorem:radonnikodymmain}
Let $(X,\Sigma)$ be a measurable space and let $\mu$ be a $\sigma$-finite, signed measure on $(X,\Sigma)$. Suppose that $\nu \ll \mu$ for $\nu$ that is either complex measure or $\sigma$-finite, signed measure. Then there exists a measurable function $f:X\ra \CC$ such that
$$\nu(A) = \int_A f d\mu$$
for every $A\in \Sigma$.
\end{theorem}
\begin{proof}[Proof for finite measures $\mu,\nu$]
Fix $n\in \NN$ and $k\in \NN$. According to Theorem \ref{theorem:jordansdecomposition} there exists a set $P_{n,k}\in \Sigma$ such that
$$\left(\nu - \frac{k}{2^n}\cdot \mu\right)\left(A\cap P_{n,k}\right)\geq 0,\,\left(\nu - \frac{k}{2^n}\cdot \mu\right)\left(A\setminus P_{n,k}\right)\leq 0$$
for every $A\in \Sigma$. We may assume that $P_{n,0}=X$, $P_{n,k+1}\subseteq P_{n,k}$ and $P_{n,k} =P_{n+1,2k}$ for every $n, k\in \NN$. Since $\nu \ll \mu$ and $\nu$ is finite, we derive that
$$\mu\left(\bigcap_{k\in \NN}P_{n,k}\right) = \nu\left(\bigcap_{k\in \NN}P_{n,k}\right)=0$$
and may assume that this set is empty for every $n\in \NN$. Pick $n\in \NN$. We define a function $f_n:X\ra \CC$ by formula
$$f_n(x) =\sum_{k\in \NN} \frac{k}{2^n}\cdot \chi_{P_{n,k}\setminus P_{n,k+1}}(x)$$
Clearly $f_n$ is a measurable function with real nonnegative values. If $m,n\in \NN$ and $n\leq m$, then we have
$$f_n(x)\leq f_m(x)\leq f_n(x)+\frac{1}{2^n}$$
Thus $\{f_n\}_{n\in \NN}$ is a nondecreasing sequence of measurable functions convergent uniformly to a measurable function $f:X\ra \CC$. Moreover, for every $A\in \Sigma$ and $n\in \NN$ we have
$$\nu(A)-\frac{1}{2^n}\mu(A) = \sum_{k\in \NN}\nu\left(A\cap \left(P_{n,k}\setminus P_{n,k+1}\right)\right)-\frac{1}{2^n}\mu(A)  \leq$$
$$\leq \sum_{k\in \NN}\frac{k+1}{2^n}\mu\left(A\cap \left(P_{n,k}\setminus P_{n,k+1}\right)\right) - \frac{1}{2^n}\sum_{k\in \NN}\mu\left(A\cap \left(P_{n,k}\setminus P_{n,k+1}\right)\right) \leq  $$
$$\leq  \sum_{k\in \NN}\frac{k}{2^n}\mu\left(A\cap \left(P_{n,k}\setminus P_{n,k+1}\right)\right)\leq \sum_{k\in \NN}\nu\left(A\cap \left(P_{n,k}\setminus P_{n,k+1}\right)\right) = \nu(A)$$
and since
$$\int_Af_n\,d\mu =  \sum_{k\in \NN}\frac{k}{2^n}\mu\left(A\cap \left(P_{n,k}\setminus P_{n,k+1}\right)\right)$$
we derive that
$$\nu(A)-\frac{1}{2^n}\mu(A) \leq \int_Af_n\,d\mu \leq \nu(A)$$
This inequality together with monotone convergence theorem imply that
$$\nu(A) =  \lim_{n\ra +\infty}\int_Af_n\,d\mu = \int_Af\,d\mu$$
This finishes the proof for finite measures $\nu,\mu$.
\end{proof}

\begin{proof}[Reduction to finite case]
Assume now that $\nu$ and $\mu$ are $\sigma$-finite measures on $(X,\Sigma)$. Then there exists a decomposition
$$X= \bigcup_{n\in \NN}X_n$$
onto disjoint subsets in $\Sigma$ such that $\nu(X_n)\in \RR$ and $\mu(X_n)\in \RR$ for every $n\in \NN$. For every $n\in \NN$ we define $\nu_n(A) = \nu(A\cap X_n)$ and $\mu_n(A) = \mu(A\cap X_n)$ for $A\in \Sigma$. Since $\nu \ll \mu$, we derive that $\nu_n\ll \mu_n$ for every $n\in \NN$. Measures $\{\nu_n\}_{n\in \NN}$ and $\{\mu_n\}_{n\in \NN}$ are finite. By finite case of the theorem we deduce that for each $n\in \NN$ there exists a measurable function $f_n:X\ra \CC$ such that
$$\nu_n(A) = \int_A f_n\,d\mu_n$$
for every $A\in \Sigma$. Note that $f_n$ is real nonnegative and can be set equal to zero outside $X_n$. Thus
$$\nu_n(A) = \int_A f_n\,d\mu_n = \int_A f_n\,d\mu$$
for every $A\in \Sigma$. Therefore, we deduce that
$$\nu(A) = \sum_{n\in \NN}\nu(A\cap X_n) = \sum_{n\in \NN}\nu_n(A) =\sum_{n\in \NN}\int_Af_n\,d\mu = \int_A \left(\sum_{n\in \NN}f_n\right)\,d\mu$$
by monotone convergence theorem.\\
Next suppose that $\mu$ is a $\sigma$-finite, signed measure and $\nu$ is a $\sigma$-finite measure. According to Theorem \ref{theorem:jordansdecomposition} we may write $\mu = \mu_+ - \mu_-$ for measures $\mu_+,\mu_-$ such that $\mu_+\perp \mu_-$. There exists a set $P\in \Sigma$ such that $\mu_-(P)=\mu_+(X\setminus P)=0$. We define $\nu_1(A) = \nu(A\cap P)$ and $\nu_2(A) = \nu(A\setminus P)$ for every $A\in \Sigma$. Then $\nu_1, \nu_2$ are $\sigma$-finite measures and $\nu_1 \ll \mu_+$, $\nu_2\ll \mu_-$. By the case considered above there exist measurable functions $f_+:X\ra \CC$, $f_-:X\ra \CC$ such that
$$\nu_1(A) = \int_Af_+\,d\mu_+,\,\nu_2(A) = \int_Af_-\,d\mu_-$$
for every $A\in \Sigma$. Moreover, we may assume that  $f_+$ is equal to zero outside $P$ and $f_-$ is equal to zero outside $X\setminus P$. From this we have
$$\nu(A) = \nu(A\cap P) + \nu(A\setminus P) = \nu_1(A) + \nu_2(A) = \int_Af_+\,d\mu_+ + \int_Af_-\,d\mu_- =$$
$$=\int_Af_+\,d\mu - \int_Af_-\,d\mu = \int_A\left(f_+-f_-\right)\,d\mu $$
for every $A\in \Sigma$.\\
Assume now that both $\mu, \nu$ are $\sigma$-finite, signed measures. In this situation we may write $\nu = \nu_+-\nu_-$ for measures $\nu_+, \nu_-$ such that $\nu_+\perp \nu_-$. There exists a set $Q\in \Sigma$ such that $\nu_-(Q)=\nu_+(X\setminus Q)=0$. We define $\mu_1(A) = \mu(A\cap Q)$ and $\mu_2(A) = \mu(A\setminus P)$ for every $A\in \Sigma$. Then $\mu_1, \mu_2$ are $\sigma$-finite measures and $\nu_+ \ll \mu_1$, $\nu_-\ll \mu_2$. By the case considered previously there exist measurable functions $f_+:X\ra \CC$, $f_-:X\ra \CC$ such that
$$\nu_+(A) = \int_Af_+\,d\mu_1,\,\nu_-(A) = \int_Af_-\,d\mu_2$$
for every $A\in \Sigma$. Moreover, we may assume that $f_+$ is equal to zero outside $Q$ and $f_-$ is equal to zero outside $X\setminus Q$. From this we have
$$\nu(A) = \nu_+(A) + \nu_-(A) = \int_Af_+\,d\mu_1 + \int_Af_-\,d\mu_2 =\int_Af_+\,d\mu - \int_Af_-\,d\mu = \int_A\left(f_+-f_-\right)\,d\mu $$
for every $A\in \Sigma$.\\
Suppose that $\nu$ is complex measure. Write $\nu = \nu_r - i\cdot \nu_i$. Then both $\nu_r, \nu_-$ are finite, signed measures. Moreover, we have $\nu_r\ll\mu,\nu_i\ll \mu$. There exist measurable functions $f_r:X\ra \CC$ and $f_i:X\ra \CC$ that are real valued and satisfy
$$\nu_r(A) = \int_Af_r\,d\mu,\,\nu_i(A) = \int_Af_i\,d\mu$$
for every $A\in \Sigma$. Thus
$$\nu(A) = \nu_r(A) + i\cdot \nu_i(A) = \int_Af_r\,d\mu + i\cdot \int_Af_i\,d\mu = \int_A\left(f_r+i\cdot f_i\right)\,d\mu$$
for every $A\in \Sigma$.
\end{proof}

\begin{definition}
Let $(X,\Sigma)$ be a measurable space and let $\mu$, $\nu$ be either signed or complex measures on $(X,\Sigma)$. Suppose that $\nu \ll \mu$. Then a measurable function $f:X\ra \CC$ that for every $A\in \Sigma$ satisfies
$$\nu(A) = \int_A f d\mu$$
is called \textit{a Radon-Nikodym derivative of $\nu$ with respect to $\mu$}. It is sometimes denoted by 
$$\frac{d\nu}{d\mu}$$
\end{definition}

\section{Applications of Radon-Nikodyn, Banach spaces of measures}

\begin{theorem}
Let $\mu$ be a complex measure on $(X,\Sigma)$. Then there exists a measurable function $f:X\ra \CC$ such that
$$\mu(A) = \int_Af\,d|\mu|$$
for every $A\in \Sigma$ and $|f(x)|=1$ for every $x$ in $X$.
\end{theorem}
\noindent
For the proof we need the following result.

\begin{lemma}\label{lemma:convexvaluesofintegral}
Let $\mu$ be a measure on $(X,\Sigma)$. Suppose that $f:X\ra \CC$ is a measurable function and $S$ is a convex subset of $\CC$. Assume that for every $A\in \Sigma$ such that $\mu(A)>0$, we have
$$\frac{1}{\mu(A)}\int_A f\,d\mu \in S$$
Then $f(x)\in S$ 
\end{lemma}
\begin{proof}

\end{proof}

\small
\bibliographystyle{apalike}
\bibliography{../zzz}

\end{document}